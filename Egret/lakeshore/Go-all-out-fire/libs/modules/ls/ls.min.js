var ls;!function(e){var t=function(e){function t(){e.call(this),this._sid=0,t.UID++,this._sid=t.UID}__extends(t,e);var n=__define,i=t,a=i.prototype;return n(a,"sid",function(){return this._sid}),n(a,"className",function(){return egret.getQualifiedClassName(this)}),a.getClass=function(){return this.constructor},a.clone=function(){var e=this.getClass();return new e},t.UID=0,t}(egret.EventDispatcher);e.BaseClass=t,egret.registerClass(t,"ls.BaseClass")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.loopSelections=t,egret.registerClass(t,"ls.loopSelections");var n=function(e){function t(){e.call(this),this.index=0,this.instances={}}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseClass);e.Action=n,egret.registerClass(n,"ls.Action")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this.enabled=1,this.isCreated=!1,this.renderEnabled=!0,e.Trigger.register(this)}__extends(n,t);var i=(__define,n),a=i.prototype;return a.onCreate=function(){},a.tick=function(){},a.saveToJSON=function(){return{enabled:this.enabled,name:this.name,paramInstances:this.paramInstances}},a.loadFromJSON=function(e){e&&(this.enabled=e.enabled,this.name=e.name,this.paramInstances=e.paramInstances)},a.getClass=function(){return this.constructor},a.destory=function(){},a.clone=function(){var e=this.getClass(),t=new e;return t.name=this.name,t.enabled=this.enabled,t.paramInstances=this.paramInstances,t},n}(egret.EventDispatcher);e.BaseBehavior=t,egret.registerClass(t,"ls.BaseBehavior")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){this.radius=0}var t=(__define,e);t.prototype;return e}();e.Circle=t,egret.registerClass(t,"ls.Circle");var n=function(){function n(){}var i=(__define,n);i.prototype;return n.checkCollision=function(t,n){if(!t||!n||t==n)return!1;if(!t.intersects(n))return!1;new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y);return 0==t.collisionType&&0==n.collisionType?this.checkPolygonCollisionPolygon(t,n):1==t.collisionType&&1==n.collisionType?this.checkCircleCollisionCircle(t,n):2==t.collisionType&&2==n.collisionType?this.checkDotCollisionDot(t,n):0==t.collisionType&&1==n.collisionType?this.checkCircleCollisionPolygon(n,t):1==t.collisionType&&0==n.collisionType?this.checkCircleCollisionPolygon(t,n):0==t.collisionType&&2==n.collisionType?this.checkDotCollisionPolygon(n,t):2==t.collisionType&&0==n.collisionType?this.checkDotCollisionPolygon(t,n):1==t.collisionType&&2==n.collisionType?this.checkDotCollisionCircle(n,t):2==t.collisionType&&1==n.collisionType?this.checkDotCollisionCircle(t,n):!1},n.checkPolygonCollisionPolygon=function(t,n){var i=!1,a=t.getCacheCollisionPolygonData();if(null==a)return!1;var r=n.getCacheCollisionPolygonData();if(null==r)return!1;for(var s=0;s<a.length;s++){for(var o=a[s],l=0;l<r.length;l++){var c=r[l];if(i=e.SAT.sat(new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y),o,c))break}if(i)break}return i},n.isCollsionWithRect=function(e,t,n,i,a,r,s,o){return e>=a&&e>=a+s?!1:a>=e&&a>=e+n?!1:t>=r&&t>=r+o?!1:r>=t&&r>=t+i?!1:!0},n.checkDotCollisionDot=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,r=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(r);var l=new egret.Matrix;l.translate(a.x-n.anchorOffsetX,a.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty);return c.equals(h)},n.checkDotCollisionCircle=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,r=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(r);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),v=a.radius*n.scale;return v*v>=u},n.checkDotCollisionPolygon=function(t,n){var i=t.collisionVectorData,a=t.angle*Math.PI/180,r=n.angle*Math.PI/180,s=new egret.Matrix;s.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),s.scale(t.scaleX,t.scaleY),s.rotate(a);var o=new e.Vector2D(t.x+s.tx,t.y+s.ty),l=n.collisionVectorData,c=!1,h=0;if(l){for(var u=0;u<l.length;u++){for(var v=l[u],f=0;f<v.length;f++){var d=v[f],g=(f+1)%v.length,p=new egret.Matrix;p.translate(d.x-n.anchorOffsetX,d.y-n.anchorOffsetY),p.scale(n.scaleX,n.scaleY),p.rotate(r);var y=new egret.Matrix;y.translate(v[g].x-n.anchorOffsetX,v[g].y-n.anchorOffsetY),y.scale(n.scaleX,n.scaleY),y.rotate(r);var _=new e.Vector2D(n.x+p.tx,n.y+p.ty),m=new e.Vector2D(n.x+y.tx,n.y+y.ty);if(_.y!=m.y&&!(o.y<(_.y<m.y?_.y:m.y)||o.y>=(_.y>m.y?_.y:m.y))){var b=(o.y-_.y)*(m.x-_.x)/(m.y-_.y)+_.x;b>o.x&&h++}}c=h%2==1}return c}return!1},n.checkCircleCollisionCircle=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,r=t.angle*Math.PI/180,s=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.center.x-t.anchorOffsetX,i.center.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(r);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(s);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),v=i.radius*t.scale,f=a.radius*n.scale;return(v+f)*(v+f)>=u},n.checkCircleCollisionPolygon=function(n,i){var a=n.collisionVectorData,r=n.angle*Math.PI/180,s=i.angle*Math.PI/180,o=a.radius*n.scale,l=!1,c=i.collisionVectorData,h=new egret.Matrix;h.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),h.scale(n.scaleX,n.scaleY),h.rotate(r);var u=new e.Vector2D(n.x+h.tx,n.y+h.ty);if(c){for(var v=0;v<c.length;v++){for(var f=c[v],d=0;d<f.length;d++){var g=f[d],p=new egret.Matrix;p.translate(g.x-i.anchorOffsetX,g.y-i.anchorOffsetY),p.scale(i.scaleX,i.scaleY),p.rotate(s);var g=new e.Vector2D(p.tx+i.x,p.ty+i.y);if(u.distanceSQ(g)<=o*o){l=!0;break}var y=(d+1)%f.length,_=new egret.Matrix;_.translate(f[y].x-i.anchorOffsetX,f[y].y-i.anchorOffsetY),_.scale(i.scaleX,i.scaleY),_.rotate(s);var m=new e.Vector2D(i.x+p.tx,i.y+p.ty),b=new e.Vector2D(i.x+_.tx,i.y+_.ty),x=new t;if(x.center=new e.Vector2D(n.x+h.tx,n.y+h.ty),x.radius=a.radius*n.scale,this.circleCollisionLine(x,m,b)){l=!0;break}}if(l)break}return l}return!1},n.circleCollisionLine=function(e,t,n){var i=e.center.x-t.x,a=e.center.y-t.y,r=n.x-t.x,s=n.y-t.y,o=Math.sqrt(r*r+s*s);r/=o,s/=o;var l=i*r+a*s,c=0,h=0;return 0>=l?(c=t.x,h=t.y):l>=o?(c=n.x,h=n.y):(c=t.x+r*l,h=t.y+s*l),(e.center.x-c)*(e.center.x-c)+(e.center.y-h)*(e.center.y-h)<=e.radius*e.radius},n.pointToSegDist=function(e,t,n,i,a,r){var s=(a-n)*(e-n)+(r-i)*(t-i);if(0>=s)return Math.sqrt((e-n)*(e-n)+(t-i)*(t-i));var o=(a-n)*(a-n)+(r-i)*(r-i);if(s>=o)return Math.sqrt((e-a)*(e-a)+(t-r)*(t-r));var l=s/o,c=n+(a-n)*l,h=i+(r-i)*l;return Math.sqrt((e-c)*(e-c)+(h-i)*(h-i))},n.distFromPointToLine=function(e,t,n){var i=n.x-t.x,a=n.y-n.x,r=n.x*t.y-t.x*n.y;return Math.abs(i*e.x+a*e.y+r)/Math.sqrt(i*i+a*a)},n}();e.Collision=n,egret.registerClass(n,"ls.Collision")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,this.minresult=0,this.maxresult=0,this._circle_radius=10}var t=__define,n=e,i=n.prototype;return t(i,"circle_radius",function(){return this._circle_radius}),i.offset=function(e,t){return this.tlx+=e,this.tly+=t,this.trx+=e,this.try_+=t,this.brx+=e,this.bry+=t,this.blx+=e,this.bly+=t,this},i.set_from_rect=function(e){this.tlx=e.left,this.tly=e.top,this.trx=e.right,this.try_=e.top,this.brx=e.right,this.bry=e.bottom,this.blx=e.left,this.bly=e.bottom;var t=this.trx-this.tlx,n=this.bry-this.try_;this._circle_radius=Math.sqrt(t*t+n*n)},i.set_from_rotated_rect=function(e,t){if(0===t)this.set_from_rect(e);else{var n=Math.sin(t),i=Math.cos(t),a=e.left*n,r=e.top*n,s=e.right*n,o=e.bottom*n,l=e.left*i,c=e.top*i,h=e.right*i,u=e.bottom*i;this.tlx=l-r,this.tly=c+a,this.trx=h-r,this.try_=c+s,this.brx=h-o,this.bry=u+s,this.blx=l-o,this.bly=u+a}},i.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},i.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},i.at=function(e,t){if(t)switch(e){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(e){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}},i.minmax4=function(e,t,n,i){t>e?i>n?(n>e?this.minresult=e:this.minresult=n,t>i?this.maxresult=t:this.maxresult=i):(i>e?this.minresult=e:this.minresult=i,t>n?this.maxresult=t:this.maxresult=n):i>n?(n>t?this.minresult=t:this.minresult=n,e>i?this.maxresult=e:this.maxresult=i):(i>t?this.minresult=t:this.minresult=i,e>n?this.maxresult=e:this.maxresult=n)},i.bounding_box=function(e){this.minmax4(this.tlx,this.trx,this.brx,this.blx),e.left=this.minresult,e.right=this.maxresult,this.minmax4(this.tly,this.try_,this.bry,this.bly),e.top=this.minresult,e.bottom=this.maxresult},i.contains_pt=function(e,t){var n=this.tlx,i=this.tly,a=this.trx-n,r=this.try_-i,s=this.brx-n,o=this.bry-i,l=e-n,c=t-i,h=a*a+r*r,u=a*s+r*o,v=a*l+r*c,f=s*s+o*o,d=s*l+o*c,g=1/(h*f-u*u),p=(f*v-u*d)*g,y=(h*d-u*v)*g;if(p>=0&&y>0&&1>p+y)return!0;a=this.blx-n,r=this.bly-i;var h=a*a+r*r,u=a*s+r*o,v=a*l+r*c;return g=1/(h*f-u*u),p=(f*v-u*d)*g,y=(h*d-u*v)*g,p>=0&&y>0&&1>p+y},i.segments_intersect=function(e,t,n,i,a,r,s,o){var l,c,h,u,v,f,d,g;if(n>e?(c=e,l=n):(c=n,l=e),s>a?(f=a,v=s):(f=s,v=a),f>l||c>v)return!1;if(i>t?(u=t,h=i):(u=i,h=t),o>r?(g=r,d=o):(g=o,d=r),g>h||u>d)return!1;var p=a-e+s-n,y=r-t+o-i,_=n-e,m=i-t,b=s-a,x=o-r,C=Math.abs(m*b-x*_),E=b*y-x*p;if(Math.abs(E)>C)return!1;var I=_*y-m*p;return Math.abs(I)<=C},i.intersects_segment=function(e,t,n,i){if(this.contains_pt(e,t)||this.contains_pt(n,i))return!0;var a,r,s,o,l;for(l=0;4>l;l++)if(a=this.at(l,!0),r=this.at(l,!1),s=this.at(l+1,!0),o=this.at(l+1,!1),this.segments_intersect(e,t,n,i,a,r,s,o))return!0;return!1},i.intersects_quad=function(e){var t=e.midX(),n=e.midY();if(this.contains_pt(t,n))return!0;var i=this.midX(),a=this.midY();if(e.contains_pt(i,a))return!0;var r=t-i,s=n-a,o=r*r+s*s,l=this.circle_radius+e.circle_radius;if(l*l>o)return!0;var c,h,u,v,f,d,g,p,y,_;for(y=0;4>y;y++)for(_=0;4>_;_++)if(c=this.at(y,!0),h=this.at(y,!1),u=this.at(y+1,!0),v=this.at(y+1,!1),f=e.at(_,!0),d=e.at(_,!1),g=e.at(_+1,!0),p=e.at(_+1,!1),this.segments_intersect(c,h,u,v,f,d,g,p))return!0;return!1},e}();e.Quad=t,egret.registerClass(t,"ls.Quad")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(e,t,n,i){}var t=(__define,e),n=t.prototype;return n.getTreeBoundInfo=function(e){},e}();e.QuadTree=t,egret.registerClass(t,"ls.QuadTree")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){this.intersectionIndex=-1,this.intersectionPoint=new e.Vector2D}var n=(__define,t),i=n.prototype;return i.getPrevIndex=function(e,t){return(e-1+t)%t},i.getNextIndex=function(e,t){return(e+1)%t},i.isConcavePoly=function(e){return e.length<=3?!1:this.getNextConcaveIndex(e,0)>=0},i.onSeparateConcavePoly=function(e){var t=[];return this.isAntiClockDir(e)||e.reverse(),this.separateConcavePoly(e,t,0),t},i.getNextConcaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return-1;for(var n=e.length,i=n+t,a=t;i>a;a++){var r=this.getPrevIndex(a,n),s=this.getNextIndex(a,n),o=(a+n)%n,l=this.getMultiPtClockDir(e[o],e[r],e[s]);if(1==l)return a%n}return-1},i.getAllConvaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return[];for(var n=[],i=e.length,a=i+t,r=t;a>r;r++){var s=this.getPrevIndex(r,i),o=this.getNextIndex(r,i),l=(r+i)%i,c=this.getMultiPtClockDir(e[l],e[s],e[o]);1==c&&n.push(r%i)}return n},i.separateConcavePoly=function(e,t,n){if(e.length<=3)return void t.push(e);var i=this.getNextConcaveIndex(e,n);if(n=i+1,0>i)return void t.push(e);if(this.getSplitPointByRgnBCinter(e,i)){var a=[],r=[];return this.splitPolyByIntersection(e,i,a,r),this.separateConcavePoly(a,t,n),void this.separateConcavePoly(r,t,n)}t.push(e)},i.splitPolyByIntersection=function(e,t,n,i){var a=e.length;if(0>t||t>=a)return!1;if(this.intersectionIndex<0||this.intersectionIndex>=a)return!1;if(t<=this.intersectionIndex+1)for(var r=this.intersectionIndex,a=t+a;a>=r;r++)n.push(e[r%a]);else for(var r=this.intersectionIndex;t>=r;r++)n.push(e[r]);if(t<=this.intersectionIndex)for(var r=t;r<this.intersectionIndex;r++)i.push(e[r]);else for(var r=t;r<this.intersectionIndex+a;r++)i.push(e[r%a]);return e[this.intersectionIndex].equals(this.intersectionPoint)||(n.push(this.intersectionPoint),i.push(this.intersectionPoint)),!0},i.getSplitPointByRgnBCinter=function(t,n){if(t.length<=3)return!1;for(var i=t.length,a=(n-1+i)%i,r=(n+1)%i,s=[],o=[],l=[],c=[],h=[],u=[],v=[],f=[],d=a>r?a:a+i,g=r;d>g;g++){var p=g%i,y=this.getMultiPtClockDir(t[n],t[a],t[p]),_=this.getMultiPtClockDir(t[n],t[r],t[p]);0>y&&_>0?s.push(p):y>=0&&_>=0?o.push(p):0>=y&&0>_?l.push(p):c.push(p)}if(h=this.getVisiblePtsOnRegion(t,n,s),u=o.concat(),f=c.concat(),v=this.getVisiblePtsOnRegion(t,n,l),h.length>0){var m=[],b=[];if(this.setSplitByRegion(t,h,m,b),b.length>0?this.intersectionIndex=this.getBestIntersectionPt(t,n,b):this.intersectionIndex=this.getBestIntersectionPt(t,n,m),this.intersectionIndex<0||this.intersectionIndex>=i)return!1}if(u.length<1||v.length<1)return console.error("BC分区为空错误！！"),!1;var x=u[u.length-1],C=v[0],E=new e.Vector2D(t[C].x-t[x].x,t[C].y-t[x].y),I=new e.Vector2D(t[n].x-t[a].x,t[n].y-t[a].y),S=new e.Vector2D(t[n].x-t[r].x,t[n].y-t[r].y),T=new e.Vector2D(I.x+S.x>>1,I.y+S.y>>1),O=new e.Vector2D;return 1!=this.getCrossByRadialAndSegment(t[n],T,t[x],E,O)?!1:(this.intersectionIndex=x,this.intersectionPoint=O,!0)},i.getMultiPtClockDir=function(e,t,n){var i=(e.x-t.x)*(n.y-e.y)-(n.x-e.x)*(e.y-t.y);return i>0?1:0>i?-1:0},i.getMultiPtClockDirByIndex=function(e,t){if(e.length<=2)return 0;var n=e[t%e.length],i=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length];return this.getMultiPtClockDir(n,i,a)},i.isAntiClockDir=function(e){if(e.length<=2)return!0;for(var t=0,n=1,i=e.length;i>n;n++){var a=(n+1)%i,r=(n+2)%i,s=(e[a].x-e[n].x)*(e[r].y-e[a].y);s-=(e[a].y-e[n].y)*(e[r].x-e[a].x),0>s?t--:s>0&&t++}return 0>=t},i.isInsection=function(t,n,i,a){var r=new e.Vector2D(i.x-t.x,i.y-t.y),s=n.x*a.y-n.y*a.x,o=s*s,l=n.x*n.x+n.y*n.y,c=a.x*a.x+a.y*a.y;if(o>.01*l*c){var h=(r.x*a.y-r.y*a.x)/s;if(0>h||h>1)return 0;var u=(r.x*n.y-t.y*n.x)/s;return 0>u||u>1?0:1}return 0},i.isVisiblePtOnConcave=function(e,t,n){for(var i=0,a=e.length;a>i;i++){var r=(i+1)%a;if(i!=t&&i!=n&&r!=t&&r!=n&&this.isInsection(e[t],e[n],e[i],e[r]))return!1}return!0},i.getVisiblePtsOnRegion=function(e,t,n){for(var i=[],a=0,r=n.length;r>a;a++)this.isVisiblePtOnConcave(e,t,n[a])&&i.push(n[a]);return i},i.setSplitByRegion=function(e,t,n,i){for(var a=0,r=e.length;r>a;a++)this.getMultiPtClockDirByIndex(e,t[a])?n.push(t[a]):i.push(t[a])},i.dotProd=function(e,t){return e.dotProd(t)},i.getBestIntersectionPt=function(e,t,n){if(n.length<1)return-1;for(var i=e.length,a=(t-1+i)%i,r=(t+1)%i,s=e[t].clone().substruct(e[a].x,e[a].y).normalize(),o=(e[t].clone().substruct(e[r].x,e[r].y).normalize(),-1),l=-1,c=0,h=n.length;h>c;c++){var u=n[c],v=e[u],f=v.clone().substruct(e[t].x,e[t].y).normalize(),d=s.clone().dotProd(f);d>l&&(o=u)}return o},i.getCrossByRadialAndSegment=function(e,t,n,i,a){var r=n.clone().substruct(e.x,e.y),s=t.getCross(i);if(s*s>.01*t.lengthSQ*i.lengthSQ){var o=r.getCross(i)/s;if(0>o)return 0;var l=r.getCross(t)/s;if(0>l||l>1)return 0;var c=t.clone().scale(o);return a.x=e.x+c.x,a.y=e.y+c.y,1}return 0},i.getPosRelationToLine=function(e,t,n){return n.x*(t.y-e.y)+n.y*(e.x-t.x)+n.y*t.x-n.x*t.y},t}();e.IntersectionStruct=t,egret.registerClass(t,"ls.IntersectionStruct")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.sat=function(e,t,n,i){return n.length<1||i.length<1?!1:this.convexsat(e,t,n,i)},t.convexsat=function(e,t,n,i){if(n.length<1||i.length<2)return!1;var a=[];a=this.getUniqueAxis(n,a),a=this.getUniqueAxis(i,a);for(var r=0,s=a.length;s>r;r++){var o=this.getProjection(e,n,a[r]),l=this.getProjection(t,i,a[r]);if(!this.overlap(o,l))return!1}return!0},t.getUniqueAxis=function(t,n){for(var i,a=!1,i=new e.Vector2D,r=0,s=t.length;s>r;r++){var i=t[(r+1)%s].clone().substruct(t[r].x,t[r].y).normalize().perp;i.x<=0&&(0==i.x?i.y<0&&(i.y*=-1):(i.x*=-1,i.y*=-1)),a=!0;for(var o=0,l=n.length;l>o;o++)if(n[o].equals(i)){a=!1;break}a&&n.push(i)}return n},t.overlap=function(e,t){return e.x>t.y?!1:e.y<t.x?!1:(e.x-t.x)*(t.x-t.y)<0?!0:!0},t.getPolyBound=function(e){if(e.length<1)return[0,0,0,0];for(var t=e[0],n=[t.x,t.y,t.x,t.y],i=0;i<e.length;i++){var a=e[i];a.x<n[0]&&(n[0]=a.x),a.y<n[1]&&(n[1]=a.y),a.x>n[2]&&(n[2]=a.x),a.y>n[3]&&(n[3]=a.y)}return n},t.getCircleBound=function(e){if(2!==e.length)return[0,0,0,0];var t=e[0],n=e[1];return[t.x-n.x,t.y-n.x,t.x+n.x,t.y+n.x]},t.getProjection=function(t,n,i){var a,r,s=0;r=new e.Vector2D(n[0].x+t.x,n[0].y+t.y).dotProd(i),s=r;for(var o=0;o<n.length;o++)a=new e.Vector2D(n[o].x+t.x,n[o].y+t.y).dotProd(i),r>a&&(r=a),a>s&&(s=a);return new e.Vector2D(r,s)},t}();e.SAT=t,egret.registerClass(t,"ls.SAT")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.call(this),this.isTrigger=!1,this.triggerStatus=!1,this.isInvert=!1,this.operatorType=0}__extends(t,e);var n=__define,i=t,a=i.prototype;return n(a,"isFirstCondition",function(){return 0===this.index}),t}(e.BaseClass);e.Condition=t,egret.registerClass(t,"ls.Condition")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){this.status=!1,this.loopDatas=[],this.loopLayer=0,this.persistent=!0,this._checked=!1,this._checkall=!1,this.execActionIndex=0,this.searchInstances={}}var n=__define,i=t,a=i.prototype;return n(a,"loop",function(){if(null==this.conditions)return!1;for(var e=0,t=this.conditions.length;t>e;e++){var n=this.conditions[e];if(n.loop)return!0}return!1}),n(a,"checkall",function(){if(!this._checked){for(var e=0,t=this.conditions.length;t>e;e++){var n=this.conditions[e];if(1==n.operatorType){this._checkall=!0;break}}this._checked=!0}return this._checkall}),n(a,"isloop",function(){return this.loopDatas&&this.loopDatas.length?this.loopDatas[0]instanceof e.ForEvent:!1}),n(a,"isArray",function(){return this.loopDatas&&this.loopDatas.length?this.loopDatas[0]instanceof e.OnForEachArrayElementEvent:!1}),n(a,"action",function(){return this.actions[this.execActionIndex]}),n(a,"world",function(){return e.World.getInstance()}),a.execActions=function(e){this.actions&&(this.lastActionResults=[],this.execActionIndex=0,this.filterinstances=e,this.isloop?this.execloop():this.isArray?this.execArray():this.execNextAction())},a.execloop=function(){var e=[];e[0]=[],e[1]=[],e[2]=[];for(var t=0;t<this.loopLayer;t++){var n=this.loopDatas[t],i=Math.min(n.startIndex,n.endIndex),a=Math.max(n.startIndex,n.endIndex);e[0][t]=i,e[1][t]=a,e[2][t]=n}this.execloopLayer(e,0)},a.execloopLayer=function(t,n){for(var i=t[0][n],a=t[1][n];a>i;i++){var r=t[2][n];e.loopIndex[r.name]=i,n==this.loopLayer-1?(this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()):this.execloopLayer(t,n+1)}},a.execArray=function(){var t=this.loopDatas[0],n=e.eval_e(t.xyzDimention),i=t.array;switch(n){case 1:for(var a=0,r=i.width;r>a;a++)i.curX=a,i.curValue=i.at(a,0,0),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction();break;case 2:for(var a=0,r=i.width;r>a;a++){i.curX=a;for(var s=0,o=i.height;o>s;s++)i.curY=s,i.curValue=i.at(a,s,0),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()}break;case 3:for(var a=0,r=i.width;r>a;a++){i.curX=a;for(var s=0,o=i.height;o>s;s++){i.curY=s;for(var l=0,c=i.depth;c>l;l++)i.curZ=l,i.curValue=i.at(a,s,l),this.execActionIndex=0,this.lastActionResults=[],this.execNextAction()}}break;default:e.assert(!0,"无法解析当前数组维数："+n)}},a.execNextAction=function(){if(!(this.execActionIndex>=this.actions.length)){var t=this.action,n=this.world,i=t.callHanlderName,a=[];if("wait"===i){var r=e.EventSheetDecoder.decodeActionParams(t).params,s=e.eval_e(r[0]);return"number"!=typeof s&&(s=0),void egret.setTimeout(function(){this.execActionIndex++,this.execNextAction()},this,1e3*s)}var o=[];if(t.isFamily){for(var l=[],c=0,h=t.callTargets.length;h>c;c++)for(var u=t.callTargets[c],v=u.name,f=n.objectHash[v],d=0,g=f.length;g>d;d++)l.push(f[d]);a=o.concat(l)}else a=o.concat(t.callTargets);this.searchInstances={};for(var c=0,p=a.length;p>c;c++){for(var y=a[c],_=-1,d=0,m=this.filterinstances.length;m>d;d++){var u=this.filterinstances[d];y.name===u.name&&(this.searchInstances[u.u_id]=u,_=d)}if(-1==_){var b,x=y.name;if(b=e.isSingleInst(x)?[e.getInstanceByInstanceName(x)]:n.objectHash[x])for(var d=0,C=b.length;C>d;d++){var E=b[d];this.searchInstances[E.u_id]=E}}}if(this.lastActionResults){for(var I in this.searchInstances)for(var S=this.searchInstances[I],d=0,m=this.lastActionResults.length;m>d;d++){var T=this.lastActionResults[d];S.name===T.name&&delete this.searchInstances[S.u_id]}for(var c=0,p=this.lastActionResults.length;p>c;c++){var T=this.lastActionResults[c];this.searchInstances[T.u_id]=T}}if(t.isBehaviorExecAction){var O=t.callTargetBehavior[i];for(var I in this.searchInstances){var D=this.searchInstances[I];if(t.isFamily){e.lakeshoreInst()[D.name]=D;var w=D.getBehavior(t.callTargetBehavior.constructor);if(O&&w){var r=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(O.apply(w,r))}}else if(D.name===t.callTargets.name){e.lakeshoreInst()[D.name]=D;var w=D.getBehavior(t.callTargetBehavior.constructor);if(O&&w){var r=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(O.apply(w,r))}}}}else for(var I in this.searchInstances){var D=this.searchInstances[I];if(t.isFamily||D.name==t.callTargets.name){e.lakeshoreInst()[D.name]=D;var O=D[i];if(O){var r=e.EventSheetDecoder.decodeActionParams(t).params;this.execLastActionResult(O.apply(D,r))}}}this.execActionIndex++,this.execNextAction()}},a.execLastActionResult=function(e){if(e){var t=this.lastActionResults.length;if(t)for(var n=0;t>n;n++)for(var i=this.lastActionResults[n],a=0,r=e.length;r>a;a++){var s=e[a];i.name==s.name?this.lastActionResults[n]=s:this.lastActionResults=this.lastActionResults.concat(s)}else this.lastActionResults=this.lastActionResults.concat(e)}},t}();e.ConditionBlock=t,egret.registerClass(t,"ls.ConditionBlock")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.sceneWidth=0,e.sceneHeight=0,e.version=0,e.isHasJpg=!1,e.isHasPng=!1,e.openLog=!0,e}();e.Config=t,egret.registerClass(t,"ls.Config")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.apply(this,arguments),this.currentKeys={}}__extends(n,t);var i=(__define,n),a=i.prototype;return a.getStatus=function(t){return e.eval_e(this[t])===this.currentKeys[t]},n}(e.BaseClass);e.BaseEvent=t,egret.registerClass(t,"ls.BaseEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.index=0,this.execActionIndex=0,this.computeTargets={},this.enabled=!0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.AIEvent=t,egret.registerClass(t,"ls.AIEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t.KEY_DOWN="keyDown",t.KEY_UP="keyUp",t}(egret.Event);e.KeyboardEvent=t,egret.registerClass(t,"ls.KeyboardEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnForEachArrayElementEvent=t,egret.registerClass(t,"ls.OnForEachArrayElementEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(t,n,i,a,r){void 0===i&&(i=null),void 0===a&&(a=!1),void 0===r&&(r=!1),e.call(this,t,a,r),this.triggerTargets=[],this.triggerCondition=n,this.triggerData=i}__extends(t,e);var n=(__define,t);n.prototype;return t.TRIGGER="TRIGGER",t}(egret.Event);e.TriggerEvent=t,egret.registerClass(t,"ls.TriggerEvent")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.EventSheetVo=t,egret.registerClass(t,"ls.EventSheetVo");var n=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.FamilyVo=n,egret.registerClass(n,"ls.FamilyVo");var i=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.VariableVo=i,egret.registerClass(i,"ls.VariableVo");var a=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.CollisionDataVo=a,egret.registerClass(a,"ls.CollisionDataVo");var r=function(){function e(){this.enemyNames=[]}var t=(__define,e);t.prototype;return e}();egret.registerClass(r,"CollisionSearchVo");var s=function(){function a(){}var s=(__define,a);s.prototype;return a.saveEventSheetData=function(n){var i=e.Config.sceneInfo.eventsheetData;this.eventsheetVo=new t,this.eventsheetVo.eventSheetName=n,this.eventsheetVo.nextEventSheetName=i.attributes.next,this.eventsheetVo.prevEventSheetName=i.attributes.previous,this.eventsheetVo.layoutName=i.attributes.layout;var a=i.attributes.version;this.eventsheetVo.version=a?a:"1.1.1",this.eventSheets[n]=this.eventsheetVo},a.start=function(t){e.assert(null==t||""==t,t+" can not null!"),this.saveEventSheetData(t);var n=e.Config.sceneInfo.eventsheetData;e.assert(null==n,"can not find "+t),this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[];e.World.getInstance().objectList;this.currentEventSheetName=t;var i=n.children;if(void 0!==i){for(var a=0,r=i.length;r>a;a++){var s=i[a],o=s.attributes.type;switch(o){case"instance":e.LayoutDecoder.curSceneInstances[s.attributes.UID]&&this.curSceneInstancesData.push(s);break;case"family":var l=this.decodeFamily(s);this.curFamilys[l.name]=l;break;case"event":this.curSceneEventsData.push(s);break;case"variable":var c=this.decodeVaraible(s);if(c.initValue=decodeURIComponent(c.initValue),void 0==e.AISystem.instance[c.name]){switch(c.variableType){case"number":e.AISystem.instance[c.name]=+e.eval_e(c.initValue);break;case"string":e.AISystem.instance[c.name]=c.initValue+"";break;case"any":e.AISystem.instance[c.name]=c.initValue;break;case"boolean":e.AISystem.instance[c.name]=Boolean(e.eval_e(c.initValue))}void 0==e.AISystem.instance.globalVariables&&(e.AISystem.instance.globalVariables={}),e.AISystem.instance.globalVariables[c.name]=e.AISystem.instance[c.name]}}}this.decode()}},a.decode=function(){this.decodePropertys(),this.decodeEvents(),this.decodeFamilyBehaviors(),this.onBehaviorsCreate(),this.onInstancesCreate(),e.AISystem.instance.sendSceneInitComplete(),this.onRenderUpdate(),e.GameUILayer.stage.addEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)},a.decodeFamilyBehaviors=function(){var t=this.curFamilys,n=e.World.getInstance();for(var i in t)for(var a=t[i],r=a.insts,s=0,o=r.length;o>s;s++)for(var l=r[s],c=l.name,h=n.objectHash[c],u=0,v=h.length;v>u;u++)for(var f=h[u],d=0,g=a.behaviors.length;g>d;d++){var p=a.behaviors[d],y=p.clone();f.addBehavior(y),y.onCreate(),y.isCreated=!0}},a.onBehaviorsCreate=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var i=t[n];if(i){var a=i.behaviors;if(a)for(var r=0;r<a.length;r++){var s=a[r];s.onCreate(),s.isCreated=!0}}}},a.decodePropertys=function(){for(var t=0,n=this.curSceneInstancesData.length;n>t;t++){var i=this.curSceneInstancesData[t],a=(i.attributes.type,+i.attributes.UID),r=e.LayoutDecoder.curSceneInstances[a];if(null!=r){this.curSceneAiObjectsHash[r.name]=r,this.curSceneAiObjects.push(r);var s=i.children;if(s)for(var o=s.length,l=0;o>l;l++){var c=s[l];this.decodeInstancePropertie(c,r)}}else e.assert(!0,"EventSheetDecoder UID:"+a+" instance is null!")}},a.decodeFamily=function(t){var i=t.attributes.UID,a=""==i?[]:i.split(","),r=new n;if(r.name=t.attributes.target,r.UIDs=[],r.insts=[],a&&a.length)for(var s=0;s<a.length;s++)r.UIDs[s]=parseFloat(a[s]),r.insts[s]=e.LayoutDecoder.curSceneInstances[r.UIDs[s]];r.behaviors=[],r.variables=[];for(var o=t.children,s=0;s<o.length;s++){var l=o[s];switch(l.attributes.name){case"behaviors":for(var c=l.children,h=0;h<c.length;h++){var u=this.decodeBehavior(c[h]);r.behaviors[h]=u}break;case"variables":for(var v=l.children,f=0;f<v.length;f++){var d=this.decodeVaraible(v[f]);r.variables[f]=d}}}if(r.insts&&r.variables)for(var s=0;s<r.insts.length;s++)for(var g=r.insts[s],p=0;p<r.variables.length;p++){var y=r.variables[p];switch(y.initValue=decodeURIComponent(y.initValue),y.variableType){case"number":g[y.name]=+e.eval_e(y.initValue);break;case"string":g[y.name]=y.initValue;break;case"any":g[y.name]=y.initValue;break;case"boolean":g[y.name]=Boolean(e.eval_e(y.initValue))}}return r},a.decodeVaraible=function(e){var t=new i;return t.initValue=decodeURIComponent(e.attributes.initValue),t.variableType=e.attributes.variableType,t.name=e.attributes.variableName,t},a.decodeEvents=function(){for(var e=0;e<this.curSceneEventsData.length;e++){var t=this.curSceneEventsData[e],n=this.decodeEvent(t,e);n&&this.curSceneEvents.push(n)}},a.decodeEvent=function(t,n){var i=new e.AIEvent;i.index=n;var a=t.attributes.conditionRelationShip;a&&(i.conditionRelationShip=e.eval_e(a));var r=t.attributes.triggerOnceWhileTrue;r&&(i.triggerOnceWhileTrue=e.eval_e(r));var s=t.children;if(null!=s){for(var o,l=s.length,c=0,h=!1,u=0;l>u;u++)if("conditionBlock"===s[u].attributes.type){h=!0;break}if(h)for(var v=0,f=0;l>f;f++){var d,g=s[f],p=g.attributes.type;switch(p){case"conditionBlock":d=this.decodeConditionBlock(g.children,c,i),d.event=i,null==i.conditionBlocks&&(i.conditionBlocks=[]),i.conditionBlocks.push(d),0===c?o=d:(d.prevConditionBlock=o,o=d,d.prevConditionBlock.nextConditionBlock=d),c++;break;case"event":null==i.children&&(i.children=[]);var y=this.decodeEvent(g,v);y.parent=i,i.children.push(y),v++}}else{v=0;for(var _=[],f=0;l>f;f++){var g=s[f],p=g.attributes.type;switch(p){case"condition":case"action":_.push(g);break;case"event":null==i.children&&(i.children=[]);var y=this.decodeEvent(g,v);y.parent=i,i.children.push(y),v++}}d=this.decodeConditionBlock(_,0,i),d.event=i,null==i.conditionBlocks&&(i.conditionBlocks=[]),i.conditionBlocks.push(d),0===c?o=d:(d.prevConditionBlock=o,o=d,d.prevConditionBlock.nextConditionBlock=d),c++}return i}},a.decodeInstancePropertie=function(t,n){var i=t.attributes.type;switch(i){case"behavior":if(n.global)break;var a=this.decodeBehavior(t);n instanceof e.AIDisplayObject?n.addBehavior(a):e.assert(!0,n+"must instance of AIDisplayObject for have Behaviors");break;case"variable":var r=t.attributes.variableName,s=t.attributes.variableType,o=decodeURIComponent(t.attributes.initValue);switch(s){case"number":n.addVariable(r,+e.eval_e(o));break;case"string":n.addVariable(r,o+"");break;case"any":n.addVariable(r,o);break;case"boolean":n.addVariable(r,Boolean(e.eval_e(o)))}}},a.decodeBehavior=function(t){var n=t.attributes.behaviorType,i=e.getInstanceByPluginClassName(n);i.name=t.attributes.name;var a=t.children;if(a)for(var r=a.length,s=0;r>s;s++){var o=a[s],l=o.attributes.name,c=decodeURIComponent(o.attributes.value),h=o.attributes.valueDataType;switch(h){case"number":i[l]=+e.eval_e(c);break;case"string":i[l]=c+"";break;case"any":i[l]=c;break;case"boolean":i[l]=Boolean(e.eval_e(c))}}return i},a.decodeConditionBlock=function(t,n,i){var a=t;if(a){var r=new e.ConditionBlock;r.index=n,r.conditions=[],r.actions=[];for(var s,o,l,c,h=a.length,u=0,v=0,f=0;h>f;f++){var d=a[f],g=d.attributes.type;switch(g){case"condition":var p=this.decodeCondition(d,u,i);p.conditionBlock=r,p.event=i,void 0==p.callCondition&&(p.isFamily?e.assert(!0,"目标组没有"+p.callConditionName+"方法！！！"):e.assert(!0,"目标："+p.callTarget+"没有"+p.callConditionName+"方法！！！")),r.conditions.push(p),0===u?o=s=p:(p.prevCondition=o,o=p,p.prevCondition.nextCondition=p),u++;break;case"action":var y=this.decodeAction(d,v,i);
y.conditionBlock=r,y.event=i,r.actions.push(y),0===v?c=l=y:(y.prevAction=c,c=y,y.prevAction.nextAction=y),v++}}return r}return null},a.decodeConditionProperties=function(t){var n=t.data,i=n.children;if(i)for(var a=i.length,r=0;a>r;r++){var s=i[r],o=s.attributes,l=o.name,c=o.value,h=o.variable?"true"===o.variable:!1,u=(o.valueDataType,o.isFamily?"true"===o.isFamily:!1);c=decodeURIComponent(c),t.isFamily=u,h&&(c='"'+c+'"'),t[l]=e.eval_e(c)}return t},a.decodeConditionFamilyProperties=function(e,t){var n=[],i=t.children;if(i)for(var a=i.length,r=0;a>r;r++){var s=i[r],o=s.attributes.isFamily?"true"===s.attributes.isFamily:!1;if(o)for(var l=s.attributes.value,c=this.curFamilys[l],h=c.insts,u=0;u<h.length;u++)-1==n.indexOf(h[u].name)&&n.push(h[u].name)}return n},a.decodeCondition=function(t,n,i){var a=t.attributes.target,r=t.attributes.behaviorName,s=e.getInstanceByPluginClassName(t.attributes.paramsClass),o=t.attributes.callName,l=!1;t.attributes.invert&&(l="true"===t.attributes.invert);var c=!1;t.attributes.loop&&(c="true"===t.attributes.loop);var h=new e.Condition;if(h.index=n,h.firstCondition=0==n?h:null,h.targetName=a,h.paramClassName=t.attributes.paramsClass,h.isInvert=l,h.paramsInstance=s,h.callConditionName=o,h.isFamily="true"==t.attributes.family,h.event=i,1===e.Version.compareVersion(this.eventsheetVo.version,"1.1.1")){var u=0;t.attributes.operatorType&&(u=+t.attributes.operatorType),h.operatorType=u}else h.operatorType=+!i.conditionRelationShip;if(s&&(s.data=t,h.isTrigger=Boolean(e.eval_e(t.attributes.isTrigger)),h.isTrigger&&this.triggerConditions.push(h)),"onCollisionWithOtherObject"==o&&this.decodeCollsionFamily(t,h,a),e.isSingleInst(a))h.callTarget=e.getInstanceByInstanceName(a),h.callCondition=h.callTarget[o];else{if(h.isFamily){var v=null,f=this.curFamilys[a],d=f.insts;void 0==d&&alert("当前场景中没有"+a+"的组！！！");for(var g=0;g<d.length;g++){var p=d[g],y=e.World.getInstance().objectHash[p.name][0];if(null!=r&&""!=r){if(y){for(var _,m=f.behaviors,b=0,x=m.length;x>b;b++){var C=m[b];if(C.name==r){_=C;break}}v=null==_?y:_}}else v=[],v.push(y)}h.callTarget=v,void 0==v[0]?h.callCondition=v[o]:h.callCondition=v[0][o]}else{var v=null;void 0==e.World.getInstance().objectHash[a]&&alert("当前场景中没有"+a+"实例对象！！！");var y=e.World.getInstance().objectHash[a][0];if(null!=r&&""!=r){if(y){for(var m=y.behaviors,b=0,x=m.length;x>b;b++){var C=m[b];if(C.name==r){v=C;break}}v=null==v?y:v}}else v=y;h.callTarget=v,h.callCondition=h.callTarget[o]}void 0===h.callCondition&&e.assert(!0,"条件目标:"+h.targetName+",没有调用的方法名："+o)}return h},a.decodeCollsionFamily=function(t,n,i){var a=t.children;if(a){var s=a[0].attributes.value,o=e.eval_e(a[0].attributes.isFamily),l=e.eval_e(e.getTransformationStr(s)),c=(this.decodeConditionFamilyProperties(n.paramsInstance,t),null);if(n.isFamily){var h=this.curFamilys[i];if(h)for(var u=0,v=h.insts.length;v>u;u++){var f=h.insts[u],d=f.name;if(void 0===this.collisionSearchs[d]?(c=new r,c.owerName=d,this.collisionSearchs[d]=c):c=this.collisionSearchs[d],o){var g=this.curFamilys[l];if(g)for(var p=0,y=g.insts.length;y>p;p++){var _=g.insts[p],m=_.name;-1==c.enemyNames.indexOf(m)&&c.enemyNames.push(m)}}else-1==c.enemyNames.indexOf(s)&&c.enemyNames.push(s)}}else if(void 0===this.collisionSearchs[i]?(c=new r,c.owerName=i,this.collisionSearchs[i]=c):c=this.collisionSearchs[i],o){var g=this.curFamilys[l];if(g)for(var p=0,y=g.insts.length;y>p;p++){var _=g.insts[p],m=_.name;-1==c.enemyNames.indexOf(m)&&c.enemyNames.push(m)}}else-1==c.enemyNames.indexOf(s)&&c.enemyNames.push(s)}},a.decodeAction=function(t,n,i){var a=t.attributes.target,r=t.attributes.behaviorName,s=t.attributes.callName,o=e.eval_e(t.attributes.persistent),l=e.eval_e(t.attributes.family),c=new e.Action;c.isBehaviorExecAction=void 0!==r,c.persistent=o;var h=null;if(l){null==h&&(h=[]);for(var u=this.curFamilys[a],v=0,f=u.insts.length;f>v;v++){var d=u.insts[v];h.push(d)}if(c.isBehaviorExecAction){var g=u.behaviors;if(g)for(var v=0,p=g.length;p>v;v++){var y=g[v];y.name==r&&(c.callTargetBehavior=y)}}}else{if(e.isSingleInst(a))h=e.getInstanceByInstanceName(a);else{for(var _=this.curSceneAiObjects,v=0,m=_.length;m>v;v++){var b=_[v];if(b.name==a){h=b;break}}null===h&&(h=e.eval_e(a))}if(c.isBehaviorExecAction&&h){var g=h.behaviors;if(g)for(var v=0,p=g.length;p>v;v++){var y=g[v];if(y.name==r){c.callTargetBehavior=y;break}}}}return c.index=n,c.targetName=a,c.isFamily=l,c.callTargets=h,c.paramData=t.children,c.callHanlderName=s,c},a.decodeActionParams=function(t){var n={},i=[],a=t.paramData,r=[],s=!1;if(a&&a.length)for(var o=0,l=a.length;l>o;o++){var c=a[o],h=c.attributes,u=(h.valueDataType,h.name,decodeURIComponent(h.value)),v=h.variable?"true"===h.variable:!1,f=h.isFamily?"true"===h.isFamily:!1;f&&(s=!0),v&&(u='"'+u+'"');var d=e.eval_e(u);r[o]=f,i.push(d)}return n.params=i,n.isFamilys=r,n.hasFamily=s,n},a.tick=function(){return this._tick},a.eventsheetRender=function(t){var n=e.AISystem.instance,i=egret.getTimer();0!==this.lastTime&&(this._tick=i-this.lastTime,this._tick<0&&(this._tick=0),this.dt1=this._tick/1e3,this.dt1>.5?this.dt1=0:this.dt1>1/n.minimumFramerate&&(this.dt1=1/n.minimumFramerate)),this.lastTime=i,this.dt=this.dt1*this.timeScale,this.renderEvents(),this.renderBehaviors(),e.World.getInstance().sceneCamera.render(),this.renderCamera(),null!=this.onEventSheetTick&&this.onEventSheetTick(),this.onRenderUpdate(),this.checkCollistions()},a.onRenderUpdate=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var i=t[n];i instanceof e.AIDisplayObject&&(i.onTick(),i.renderUpdate())}},a.renderCamera=function(){e.World.getInstance().render()},a.onInstancesCreate=function(){for(var t in e.LayoutDecoder.curSceneInstances){var n=e.LayoutDecoder.curSceneInstances[t];n.onCreate()}for(var i in e.LayoutDecoder.noSceneInstances){var a=e.LayoutDecoder.noSceneInstances[i];a&&a.onCreate&&a.onCreate()}},a.renderBehaviors=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var i=t[n],a=i.behaviors;if(a)for(var r=0,s=a.length;s>r;r++){var o=a[r];if(o.enabled&&o.inst){var l=egret.getQualifiedClassName(o);"ls.ScrollToBehavior"!=l&&o.tick()}}}for(var n=0;n<t.length;n++){var i=t[n],a=i.behaviors;if(a)for(var r=0,s=a.length;s>r;r++){var o=a[r];if(o.enabled&&o.inst){var l=egret.getQualifiedClassName(o);"ls.ScrollToBehavior"==l&&o.tick()}}}},a.renderEvents=function(){for(var t=e.AISystem.instance.disableDataEvents,n=0;n<this.curSceneEvents.length;n++)if(void 0==t[n+1]){var i=this.curSceneEvents[n];this.execEvent(i)}},a.execEvent=function(e,t){if(void 0===t&&(t=null),e.enabled){var n=!1;if(e.parent?e.parent.conditionBlocks[0].status&&(n=!0):n=!0,n){var i=e.conditionBlocks;this.execConditionBlock(i[0],t)}}},a.execConditionBlock=function(t,n){if(t){t.cs={},t.loopDatas=[],t.loopLayer=0,this.execNextCondition(t.conditions[0],t,n,function(){for(var n,i=[],r=0;r<t.conditions.length;r++){var s=t.conditions[r];n=0==r?s.currentStatus:1==s.operatorType?n||s.currentStatus:n&&s.currentStatus,s.triggerStatus=!1}if(t.status=n,n){t.event.triggerOnceWhileTrue&&(t.event.enabled=!1);var o={};for(var l in t.cs.instanceStatus){var c,h=t.cs.instanceStatus[l],u=h.instance,v=h.ccs,f=0;for(var d in v){var g=v[d],p=g.c;c=0==f?g.status:1==p.operatorType?c||g.status:c&&g.status,f++}c&&(i.push(u),o[u.u_id]=u)}if(i.length>0){for(var y=0,_=i.length;_>y;y++)e.lakeshoreInst()[i[y].name]=i[y];t.execActions(i);var m=t.event;if(m.children)for(var b=0;b<m.children.length;b++){var x=m.children[b];x&&(x.lastFilterTargets=o,a.execEvent(x))}}}});var i=t.nextConditionBlock;i&&this.execConditionBlock(i,n)}},a.execNextCondition=function(t,n,i,a){if(void 0===a&&(a=null),t){var r,s=t,o=s.targetName,l=s.isFamily,c=s.callTarget,h=s.callCondition,u=(s.callConditionName,s.isInvert),v=(s.paramClassName,s.paramsInstance),f=s.isTrigger;if(s.currentStatus=!1,n.cs.instanceStatus||(n.cs.instanceStatus={}),f){if(s.triggerStatus){var d=s.triggerfilters,g=!1;for(var p in d){var y,_=d[p];if(c instanceof e.BaseBehavior){var m;m=_.behaviors;for(var b=0;b<m.length;b++){var x=m[b];if(x.name==c.name){y=x;break}}}if(e.lakeshoreInst()[_.name]=_,this.decodeConditionProperties(v),s.triggerData)for(var C in s.triggerData)v.currentKeys[C]=s.triggerData[C];if(s.triggerChangeValue)for(var E in s.triggerChangeValue)v[E]=s.triggerChangeValue[E];var I=h.apply(y?y:_,[v]);I.status&&(g=!0);var S=I.instances.concat();if(G){for(var T={},O=0;O<S.length;O++){var D=S[O];G[D.u_id]&&(T[D.u_id]=D)}for(var w=0;w<S.length;w++){var D=S[w];for(var L in T){var A=T[L];if(D.name==A.name&&D.u_id!=A.u_id){S.splice(w,1),w--;break}}}for(var M in G){var B=G[M];n.cs.instanceStatus[B.u_id]||(n.cs.instanceStatus[B.u_id]={instance:B,ccs:{}}),n.cs.instanceStatus[B.u_id].ccs[s.index]={c:s,status:!0}}}for(var O=0,R=S.length;R>O;O++){var _=S[O];n.cs.instanceStatus[_.u_id]||(n.cs.instanceStatus[_.u_id]={instance:_,ccs:{}}),n.cs.instanceStatus[_.u_id].ccs[s.index]={c:s,status:I.status}}s.triggerStatus=!1,s.triggerfilters={},s.currentStatus=g}}}else{if(l){for(var k=this.curFamilys[o].insts,P=[],N=0,X=k.length;X>N;N++)for(var Y=k[N].name,j=e.World.getInstance().objectHash[Y],V=0,U=j.length;U>V;V++)P.push(j[V]);r=P.concat()}else r=e.isSingleInst(o)?[e.getInstanceByInstanceName(o)]:e.World.getInstance().objectHash[o];var G=n.event.lastFilterTargets;if(G){var F={};r=r.concat();for(var H=0;H<r.length;H++){var D=r[H];G[D.u_id]&&(F[D.u_id]=D)}for(var w=0;w<r.length;w++){var D=r[w];for(var L in F){var A=F[L];if(D.name==A.name&&D.u_id!=A.u_id){r.splice(w,1),w--;break}}}for(var M in G){var B=G[M];n.cs.instanceStatus[B.u_id]||(n.cs.instanceStatus[B.u_id]={instance:B,ccs:{}}),n.cs.instanceStatus[B.u_id].ccs[s.index]={c:s,status:!0}}}for(var W=0;W<r.length;W++){var y,D=r[W];if(c instanceof e.BaseBehavior){var m;l?i&&i.familyVo&&(m=i.familyVo.behaviors):m=D.behaviors;for(var b=0;b<m.length;b++){var x=m[b];if(x.name==c.name){y=x;break}}}e.lakeshoreInst()[D.name]=D,this.decodeConditionProperties(v);var I=h.apply(y?y:D,[v]);if(I.status=u?!I.status:I.status,I.data&&(I.data instanceof e.ForEvent||I.data instanceof e.ForEachOrderEvent||I.data instanceof e.OnForEachArrayElementEvent)&&(n.loopDatas[n.loopLayer++]=I.data),n.cs.instanceStatus[D.u_id]||(n.cs.instanceStatus[D.u_id]={instance:D,ccs:{}}),n.cs.instanceStatus[D.u_id].ccs[s.index]={c:s,status:I.status},I.instances&&I.status)for(var q=0;q<I.instances.length;q++){var J=I.instances[q];n.cs.instanceStatus[J.u_id]||(n.cs.instanceStatus[J.u_id]={instance:J,ccs:{}}),n.cs.instanceStatus[J.u_id].ccs[s.index]={c:s,status:!0}}I.status&&(s.currentStatus=I.status)}}if(n.checkall){var z=t.nextCondition;z?this.execNextCondition(z,n,i,a):a&&a()}else if(s.currentStatus){var z=t.nextCondition;z?this.execNextCondition(z,n,i,a):a&&a()}else a&&a()}},a.checkCollistions=function(){var t=e.World.getInstance(),n=t.objectList,i={};for(var a in this.collisionSearchs){var r=this.collisionSearchs[a],s=t.objectHash[r.owerName];for(var o in s){var l=s[o];if(l.container.stage&&!l.isDead&&l.collision)for(var c=0;c<r.enemyNames.length;c++){var h=r.enemyNames[c],u=t.objectHash[h];for(var v in u){var f=u[v];if(f.container.stage&&f.collision&&!f.isDead){var d=e.Collision.checkCollision(l,f);d&&(null==i[l.u_id]&&(i[l.u_id]=[l,f]),null==i[f.u_id]&&(i[f.u_id]=[f,l]))}}}}}for(var g={},p=0;p<n.length;p++)if(n[p]instanceof e.AIDisplayObject){var y=n[p],_=i[y.u_id];if(null!=_){var m=_[1],b=0;null==g[y.u_id]&&(b++,g[y.u_id]=y),null==g[m.u_id]&&(b++,g[m.u_id]=m),2!=b&&y.setIsColliding(!0,m)}else y.setIsColliding(!1,null)}},a.execScenePauseOrPlay=function(t){0==t?(this.run=!1,e.GameUILayer.stage.removeEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)):(this.run=!0,e.GameUILayer.stage.addEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this))},a.destory=function(){this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[],this.triggerConditions=[],this.curFamilys={},e.AISystem.instance.disableDataEvents={},e.GameUILayer.stage.removeEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)},a.curSceneInstancesData=[],a.curSceneEventsData=[],a.curSceneAiObjects=[],a.curSceneAiObjectsHash={},a.curSceneEvents=[],a.curFamilys={},a.eventSheets={},a.collisionSearchs={},a.lastTime=0,a._tick=60,a.testShape=new egret.Sprite,a.dt=0,a.dt1=0,a.timeScale=1,a.triggerConditions=[],a.run=!0,a}();e.EventSheetDecoder=s,egret.registerClass(s,"ls.EventSheetDecoder")}(ls||(ls={}));var ls;!function(ls){function assert(e,t){if(e){var n;try{throw Error()}catch(i){n=i.stack}var t="【ERROR】:"+t+"\n\nStack trace: \n"+n;console.error&&console.error(t),isWeixinLogin()&&alert(t)}}function registerObject(e,t){window[e]=t}function lakeshoreInst(){return window}function eval_e(exp){try{if("number"==typeof exp)return exp;if(void 0===exp)return;if(null===exp)return null;if(""===exp)return"";if("0"===exp)return 0;if("true"===exp||exp===!0)return!0;if("false"===exp||exp===!1)return!1;var numexp=+exp;if(!isNaN(numexp))return numexp;var expressionObject=ls.EventSheetDecoder.expressionObject;if(void 0===expressionObject)return eval(exp);var expressValue=expressionObject[exp];return void 0!=expressValue?expressValue():"string"==typeof exp&&"a"===exp?exp:eval(exp)}catch(exception){return exp}}function getloopIndex(e){return ls.loopIndex[e]}function fps(){return 1/dt()}function dt(){return ls.EventSheetDecoder.dt1}function objectcount(){return ls.World.getInstance().objectList.length}function stageWidth(){return ls.GameUILayer.stage.stageWidth}function stageHeight(){return ls.GameUILayer.stage.stageHeight}function sceneWidth(){return ls.LayoutDecoder.sceneWidth}function sceneHeight(){return ls.LayoutDecoder.sceneHeight}function iswebgl(){return"webgl"==egret.Capabilities.renderMode}function timeScale(){return 1}function time(){return egret.getTimer()-ls.oldtime}function log(e){e+="",e=e.split(",");for(var t=0;t<e.length;t++){var n=eval_e(e[t]);ls.Log.log(n)}}function isPc(){if(window.navigator){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,i=0;i<t.length;i++)if(e.indexOf(t[i])>0){n=!1;break}return n}return!1}function injectProp(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!t)return!1;var i=!0;for(var a in t){var r=t[a];n&&"function"==typeof r||(e[a]=r)}return i}function getMiniSeconds(e){var t=/-/g,n=new Date(Date.parse(e.replace(t,"/")));return n.getTime()}function getRemainTimeStr(e,t,n){void 0===t&&(t=":"),void 0===n&&(n=!0);var i=this.getMiniSeconds(e),a=(new Date).getTime(),r=i-a;if(r>=0){var s=Math.round(r/1e3),o=Math.floor(s/3600),l=Math.floor((s-3600*o)/60),c=s-3600*o-60*l,h=10>o?"0"+o:o.toString(),u=10>l?"0"+l:l.toString(),v=10>c?"0"+c:c.toString();return h+t+u+t+v}return n?"00"+t+"00"+t+"00":""}function isInternal(e){if(void 0==ls.cacheInternal[e]){var t=!1;if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var i=ls.internalData[n];if(i.name==e){t=!0;break}}ls.cacheInternal[e]=t}return ls.cacheInternal[e]}function getPlugin(e){if(void 0==ls.cachePlugins[e]){var t="";if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var i=ls.internalData[n];if(i.name==e){t=i.plugin;break}}ls.cachePlugins[e]=t}return ls.cachePlugins[e]}function isSingleInst(e){return isInternal(e)}function getInstanceByInstanceName(e){var t,n;if(isSingleInst(e)){if(null==ls.singles[e]){if(n=egret.getDefinitionByName("ls."+getPlugin(e)),null==n)return void alert("name:"+e);n.name=e,t=null==n.instance?new n:n.instance,ls.singles[e]=t,registerObject(e,t)}else t=ls.singles[e];isInternal(e)&&(window[e]=t)}return t}function getInstanceByPluginClassName(e,t){void 0===t&&(t=!1);var n,i;if("Object"==e)return null;if(isSingleInst(e))if(null==ls.singles[e]){if(i=egret.getDefinitionByName("ls."+getPlugin(e)),null==i)return void(t||alert("name:"+e));i.name=e,n="System"==e?i.instance:new i,n.name=e,ls.singles[e]=n,registerObject(e,n)}else n=ls.singles[e];else{if(i=egret.getDefinitionByName("ls."+e),null==i)return t||alert("name:"+e),void(n=null);n=new i}return isInternal(e)&&(window[e]=n),n}function getTexture(e){if(e){var t,n=e;if(n){var i=ls.LayoutDecoder.spriteSheetDatas[n];if(i&&(t=i.texture),(void 0==t||null==t)&&(t=RES.getRes(n)),void 0!=t&&null!=t)return[t,i?i.offsetX:0,i?i.offsetY:0]}}return null}function getName(e){return e?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}function getTransformationStr(e){return e}function xmlToJson(e){var t={};if(1==e.nodeType)for(var n in e.attributes)t[n]=e.attributes[n];else 3==e.nodeType&&(t=e.name);if(e.children)for(var i=0;i<e.children.length;i++){var a=e.children[i],r=a.localName;if(r)if(void 0==t[r])t[r]=this.xmlToJson(a);else{if(void 0==t[r].length){var s=t[r];t[r]=[],t[r].push(s)}t[r].push(this.xmlToJson(a))}else t.text=a.text}return t}function round6dp(e){return Math.round(1e6*e)/1e6}function is_undefined(e){return"undefined"==typeof e}function is_number(e){return"number"==typeof e}function is_string(e){return"string"==typeof e}function isPot(e){return e>0&&0===(e-1&e)}function abs(e){return e=eval_e(e),Math.abs(e)}function acos(e){return e=eval_e(e),Math.acos(e)}function angle(e,t,n,i){return e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i),180*Math.atan2(i-t,n-e)/Math.PI}function asin(e){return e=eval_e(e),Math.asin(e)}function atan(e){return e=eval_e(e),Math.atan(e)}function atan2(e,t){return e=eval_e(e),t=eval_e(t),Math.atan2(e,t)}function ceil(e){return e=eval_e(e),Math.ceil(e)}function floor(e){return e=eval_e(e),Math.floor(e)}function sin(e){return e=eval_e(e),Math.sin(e)}function cos(e){return e=eval_e(e),Math.cos(e)}function sqrt(e){return e=eval_e(e),Math.sqrt(e)}function tan(e){return e=eval_e(e),Math.tan(e)}function cosp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),(e+t+(e-t)*Math.cos(n*Math.PI))/2}function distance(e,t,n,i){e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i);var a=e-n,r=t-i;return Math.sqrt(a*a+r*r)}function exp(e){return e=eval_e(e),Math.exp(e)}function pow(e,t){return e=eval_e(e),t=eval_e(t),Math.pow(e,t)}function getbit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e&1<<t?1:0}function lerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e+(t-e)*n}function unlerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e==t?0:(n-e)/(t-e)}function log10(e){return e=eval_e(e),Math.log(e)/Math.LN10}function max(e,t){return e=eval_e(e),t=eval_e(t),Math.max(e,t)}function min(e,t){return e=eval_e(e),t=eval_e(t),Math.min(e,t)}function pi(){return Math.PI}function qarp(e,t,n,i){return e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i),lerp(lerp(e,t,i),lerp(t,n,i),i)}function round(e){return e=eval_e(e),Math.round(e)}function random(){return Math.random()}function togglebit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e^1<<t}function float(e){return e=eval_e(e),+e}function int(e){return e=eval_e(e),parseInt(e)}function rgb(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),Math.max(Math.min(e,255),0)|Math.max(Math.min(t,255),0)<<8|Math.max(Math.min(n,255),0)<<16}function getRed(e){return e=eval_e(e),255&e}function getGreen(e){return e=eval_e(e),(65280&e)>>8}function getBlue(e){return e=eval_e(e),(16711680&e)>>16}function regexp_escape(e){return e=eval_e(e),e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function find(e,t){return e=eval_e(e),t=eval_e(t),e.search(new RegExp(regexp_escape(t),"i"))}function replace(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.replace(new RegExp(regexp_escape(t),"gi"),n)}function left(e,t){return e=eval_e(e),t=eval_e(t),e.substr(e,t)}function right(e,t){return e=eval_e(e),e.substr(e.length-t)}function len(e){return void 0==e||null==e?0:(e=eval_e(e),e+="",e.length)}function toFixed(e,t){return e=eval_e(e),t=eval_e(t),parseFloat(parseFloat(e).toFixed(t))}function lowercase(e){return e=eval_e(e),e.toLowerCase()}function upppercase(e){return e=eval_e(e),e.toUpperCase()}function trim(e){return e=eval_e(e),e.trim()}function mid(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.substr(t,n)}function newline(){return"\n"}function zeropad(e,t){e=eval_e(e),t=eval_e(t);var n=0>e?"-":"";0>e&&(e=-e);for(var i=t-e.toString().length,a=0;i>a;a++)n+="0";return n+e.toString()}function choose(){var e=Math.floor(Math.random()*(arguments.length-1));return arguments[e+1]}function getTime(){return(new Date).getTime()}function week(){return(new Date).getDay()}function year(){return(new Date).getFullYear()}function month(){return(new Date).getMonth()}function day(){return(new Date).getDate()}function hours(){return(new Date).getHours()}function minutes(){return(new Date).getMinutes()}function seconds(){return(new Date).getSeconds()}function minuteSeconds(){return(new Date).getMilliseconds()}function clamp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),t>e?t:e>n?n:e}function isWeixinLogin(){if(window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.toLowerCase){var e=window.navigator.userAgent.toLowerCase(),t=e.match(/MicroMessenger/i);return t&&t.length>0&&"micromessenger"==t[0]}return!1}function compare(e,t,n){var i=eval_e(e),a=eval_e(n);switch(t){case OperationType.EQUAL_TO:return i==a;case OperationType.GREATER_OR_EQUAL:return i>=a;case OperationType.GREATER_THAN:return i>a;case OperationType.LESS_OR_EQUAL:return a>=i;case OperationType.LESS_THAN:return a>i;case OperationType.NOT_EQUAL_TO:return i!=a}return!1}ls.loopIndex={},ls.assert=assert,ls.registerObject=registerObject,ls.lakeshoreInst=lakeshoreInst,ls.eval_e=eval_e,ls.getloopIndex=getloopIndex,ls.fps=fps,ls.dt=dt,ls.objectcount=objectcount,ls.stageWidth=stageWidth,ls.stageHeight=stageHeight,ls.sceneWidth=sceneWidth,ls.sceneHeight=sceneHeight,ls.iswebgl=iswebgl,ls.timeScale=timeScale,ls.oldtime=egret.getTimer(),ls.time=time,ls.log=log,ls.isPc=isPc,ls.injectProp=injectProp,ls.getMiniSeconds=getMiniSeconds,ls.getRemainTimeStr=getRemainTimeStr,ls.internalData=[],ls.cacheInternal={},ls.cachePlugins={},ls.isInternal=isInternal,ls.getPlugin=getPlugin,ls.isSingleInst=isSingleInst,ls.singles={},ls.getInstanceByInstanceName=getInstanceByInstanceName,ls.getInstanceByPluginClassName=getInstanceByPluginClassName,ls.getTexture=getTexture,ls.getName=getName,ls.getTransformationStr=getTransformationStr,ls.xmlToJson=xmlToJson,ls.round6dp=round6dp,ls.is_undefined=is_undefined,ls.is_number=is_number,ls.is_string=is_string,ls.isPot=isPot,ls.abs=abs,ls.acos=acos,ls.angle=angle,ls.asin=asin,ls.atan=atan,ls.atan2=atan2,ls.ceil=ceil,ls.floor=floor,ls.sin=sin,ls.cos=cos,ls.sqrt=sqrt,ls.tan=tan,ls.cosp=cosp,ls.distance=distance,ls.exp=exp,ls.pow=pow,ls.getbit=getbit,ls.lerp=lerp,ls.unlerp=unlerp,ls.log10=log10,ls.max=max,ls.min=min,ls.pi=pi,ls.qarp=qarp,ls.round=round,ls.random=random,ls.togglebit=togglebit,ls["float"]=float,ls["int"]=int,ls.rgb=rgb,ls.getRed=getRed,ls.getGreen=getGreen,ls.getBlue=getBlue,ls.regexp_escape=regexp_escape,ls.find=find,ls.replace=replace,ls.left=left,ls.right=right,ls.len=len,ls.toFixed=toFixed,ls.lowercase=lowercase,ls.upppercase=upppercase,ls.trim=trim,ls.mid=mid,ls.newline=newline,ls.zeropad=zeropad,ls.choose=choose,ls.getTime=getTime,ls.week=week,ls.year=year,ls.month=month,ls.day=day,ls.hours=hours,ls.minutes=minutes,ls.seconds=seconds,ls.minuteSeconds=minuteSeconds,ls.clamp=clamp,ls.isWeixinLogin=isWeixinLogin;var OperationType=function(){function e(){}var t=(__define,e);t.prototype;return e.EQUAL_TO="equalTo",e.NOT_EQUAL_TO="notEqualTo",e.LESS_THAN="lessThan",e.LESS_OR_EQUAL="lessOrEqual",e.GREATER_THAN="greaterThan",e.GREATER_OR_EQUAL="greaterOrEqual",e}();ls.OperationType=OperationType,egret.registerClass(OperationType,"ls.OperationType");var InstanceVariablesType=function(){function e(){}var t=(__define,e);t.prototype;return e.TEXT="text",e.INT="int",e.NUMBER="Number",e.BOOLEAN="boolean",e}();ls.InstanceVariablesType=InstanceVariablesType,egret.registerClass(InstanceVariablesType,"ls.InstanceVariablesType"),ls.compare=compare}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.call(this),this.updateCamera=!0}__extends(t,e);var n=(__define,t),i=n.prototype;return i.lookAtPoint=function(e){this.oldX!=e.x&&(this.oldX=e.x,this.updateCamera=!0,this.scrollX=e.x),this.oldY!=e.y&&(this.oldY=e.y,this.updateCamera=!0,this.scrollY=e.y)},i.lookAt=function(e,t){this.oldX!=e&&(this.oldX=e,this.updateCamera=!0,this.scrollX=e),this.oldY!=t&&(this.oldY=t,this.updateCamera=!0,this.scrollY=t)},i.lookAtX=function(e){this.oldX!=e&&(this.oldX=e,this.scrollX=e,this.updateCamera=!0)},i.lookAtY=function(e){this.oldY!=e&&(this.oldY=e,this.scrollY=e,this.updateCamera=!0)},i.add=function(e,t){this.isSet||(this.x-=e,this.y-=t,this.isSet=!0)},t}(egret.Sprite);e.Layer=t,egret.registerClass(t,"ls.Layer")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.clearLayers=function(){this.layers={},e.GameUILayer.renderContainer.removeChildren()},t.getLayerByIndex=function(t,n){if(void 0===this.layers[n]){var i=new e.Layer;i.layerIndex=n,i.scrollX=e.GameUILayer.stage.stageWidth/2,i.scrollY=e.GameUILayer.stage.stageHeight/2,this.layers[n]=i;for(var a=e.GameUILayer.renderContainer,r=0,s=a.numChildren,o=0;s>o;o++){var l=a.getChildAt(o),c=l.layerIndex;if(!(n>c))break;r++}var h=e.LayoutDecoder.layers[n];void 0===h&&(h=new e.LayerVo,h.index=n,h.parallaxX=t.parallaxX,h.parallaxY=t.parallaxY,h.layerAlpha=1,h.layerVisible=!0,h.layerScaleX=100,h.layerScaleY=100,h.cacheAsBitmap=!1,e.LayoutDecoder.layers[n]=h),i.scaleX=h.layerScaleX/100,i.scaleY=h.layerScaleY/100,i.alpha=h.layerAlpha,i.visible=h.layerVisible,i.cacheAsBitmap=h.cacheAsBitmap,e.GameUILayer.renderContainer.addChildAt(i,r)}return this.layers[n]},t.getIndexByLayer=function(e){return e?e.layerIndex:-1},t.getLayer=function(e){return this.layers[e]},t.layers={},t}();e.LayerManager=t,egret.registerClass(t,"ls.LayerManager")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.LayerVo=t,egret.registerClass(t,"ls.LayerVo")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._x=e,this._y=t}var t=__define,n=e,i=n.prototype;return t(i,"x",function(){return this._x},function(e){this._x=e}),t(i,"y",function(){return this._y},function(e){this._y=e}),t(i,"length",function(){return Math.sqrt(this._x*this._x+this._y*this._y)},function(e){var t=this.angle;this._x=Math.cos(t)*e,this._y=Math.sin(t)*e}),t(i,"lengthSQ",function(){return this._x*this._x+this._y*this._y}),t(i,"angle",function(){return Math.atan2(this._y,this._x)},function(e){var t=this.length;this._x=Math.cos(e)*t,this._y=Math.sin(e)*t}),t(i,"rotation",void 0,function(e){var t=e/180*Math.PI;this.angle=t}),i.normalize=function(){var e=this.length;return e?(this.x/=e,this.y/=e,this):this},i.truncate=function(e){return this.length=Math.min(e,this.length),this},i.reverse=function(){return this._x=-this._x,this._y=-this._y,this},i.isNormalized=function(){return 1==this.length},i.dotProd=function(e){return this._x*e._x+this._y*e._y},i.crossProd=function(e){return 0===this.getCross(e)},i.getCross=function(e){return this._x*e._y-this._y*e._x},e.angleBetween=function(e,t){return e.isNormalized()||(e=e.clone().normalize()),t.normalize()||(t=t.clone().normalize()),Math.acos(e.dotProd(t))},t(i,"perp",function(){return new e(-this._y,this._x)}),i.sign=function(e){return this.perp.dotProd(e)<0?-1:1},i.distance=function(e){return Math.sqrt(this.distanceSQ(e))},i.distanceSQ=function(e){var t=e._x-this._x,n=e._y-this._y;return t*t+n*n},i.equals=function(e){return this._x===e._x&&this._y===e._y},i.isZero=function(){return 0===this._x&&0===this._y},i.scale=function(e){return this._x*=e,this._y*=e,this},i.add=function(e,t){return this._x+=e,this._y+=t,this},i.substruct=function(e,t){return this._x-=e,this._y-=t,this},i.multiply=function(e,t){return this._x*=e,this._y*=t,this},i.divide=function(e,t){return this._x/=e,this._y/=t,this},i.clone=function(){var t=new e;return t._x=this._x,t._y=this._y,t},i.toString=function(){return"(x="+this.x+", y="+this.y+")"},e}();e.Vector2D=t,egret.registerClass(t,"ls.Vector2D")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.Layout=t,egret.registerClass(t,"ls.Layout");var n=function(){function n(){}var i=(__define,n);i.prototype;return n.getTexture=function(e){for(var t in this.spriteSheets){var n=this.spriteSheets[t],i=n.getTexture(e);if(void 0!=i)return i}return null},n.saveLayout=function(n){var i=e.Config.sceneInfo.layoutData,a=new t;a.layoutName=n,a.nextLayoutName=i.attributes.next,a.prevLayoutName=i.attributes.previous,a.eventSheetName=i.attributes.eventSheet;var r=i.attributes.version;a.version=r?r:"1.1.1",this.layouts[n]=a,this.layoutVo=a},n.decodeExpressions=function(){if(this.layoutVo.eventSheetName){var t=e[this.layoutVo.layoutName];if(void 0!==t){var n=t();e.EventSheetDecoder.expressionObject={};for(var i in n){var a=decodeURIComponent(i);a=a.replace(/^['\"]{1}(.*)['\"]{1}$/,"$1"),e.EventSheetDecoder.expressionObject[a]=n[i]}}}},n.start=function(t){e.assert(null==t||""==t,"layout canot null!");var i=e.Config.sceneInfo.layoutData;e.assert(null==i,"can not find"+t);var a=i.attributes.sceneSize.split(",");this.sceneWidth=+a[0],this.sceneHeight=+a[1],this.currentLayoutName=t,this.saveLayout(t),this.decodeExpressions();var r=i.children;if(r){for(var s=[],o=0,l=r.length;l>o;o++){var c=r[o];if("layer"!=c.localName){var h=this.decodeInstance(c);if(h&&void 0!==h.index){var u=c.attributes.index?+c.attributes.index:o;h.index=u,s.push(h)}}else if(null==this.layers[+c.attributes.index]){var v=this.decodeLayers(c);this.layers[v.index]=v}}s=s.concat(n.globalInstances),s.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0});for(var o=0;o<s.length;o++){var h=s[o];e.World.getInstance().addChild(h)}}if(e.internalData)for(var o=0;o<e.internalData.length;o++){var f=e.internalData[o].name,d=e.getInstanceByPluginClassName(f,!0);d&&(d.initialize&&d.initialize(),this.noSceneInstances[f]=d)}for(var g in this.curSceneInstances)e.registerObject(this.curSceneInstances[g].name,this.curSceneInstances[g])},n.decodeInstances=function(e){var t=[];if(e){var n=e.children;if(n)for(var i=0;i<n.length;i++){var a=n[i];if("layer"==a.localName){if(null==this.layers[+a.attributes.index]){var r=this.decodeLayers(a);this.layers[r.index]=r}}else{var s=this.decodeInstance(a);s&&void 0!==s.index&&(s.index=+a.attributes.index),s&&t.push(s)}}}return t},n.decodeLayers=function(t){var n=new e.LayerVo;return n.index=+t.attributes.index,n.parallaxX=+t.attributes.parallaxX,n.parallaxY=+t.attributes.parallaxY,n.layerAlpha=+t.attributes.layerAlpha,n.layerVisible="false"!=t.attributes.index,n.layerScaleX=+t.attributes.layerScaleX,n.layerScaleY=+t.attributes.layerScaleY,n.cacheAsBitmap="true"==t.attributes.cacheAsBitmap,n},n.decodeInstance=function(t){if("spritesheets"!=t.localName){var n=+t.attributes.UID,i=t.attributes.plugin,a=t.attributes.name;if(e.isInternal(a))return null;var r=this.curSceneInstances[n];if(void 0!=r)return r;if(r=e.getInstanceByPluginClassName(i),r.isModel=!0,r.name=a,r.id=n,r.parallaxX=+t.attributes.parallaxX,r.parallaxY=+t.attributes.parallaxY,null!=t.children){null==this.instanceNames[a]&&(this.instanceNames[a]=a);for(var s,o=!1,l={},c=0,h=t.children.length;h>c;c++){var u=t.children[c],v=u.attributes.name,f=u.attributes.value,d=u.attributes.valueDataType;switch(v){case"layer":o=!0,r[v]=+f;break;case"actions":r.setData(u.children);break;case"behaviors":s=u;break;default:switch(d){case"number":l[v]=+f;break;case"string":l[v]=decodeURIComponent(f),"collisionData"==v&&(r.collisionVectorData=this.decodeCollision(r,l[v]),r.collisionSourceData=decodeURIComponent(u.attributes.sourceValue),r.collisionSourceVectorData=this.decodeCollision(r,r.collisionSourceData));break;case"boolean":l[v]=e.eval_e(f);break;case"any":l[v]=e.eval_e(decodeURIComponent(f))}}}l.hasOwnProperty("width")&&(r.width=l.width),l.hasOwnProperty("height")&&(r.height=l.height);for(var g in l)r[g]=l[g];return s&&this.decodeGlobalBehaviors(r,s),o||(r.layer=0),r&&r.initialize(),null==this.curSceneInstances[n]&&(this.curSceneInstances[n]=r),r
}}},n.decodeCollision=function(t,n){var i;if(t&&n)if(""==n)t.collisionType-1;else{var a=n.split("/n");if(2==a.length)switch(t.collisionType=+a[0],t.collisionType){case 0:i=[];var r=a[1].indexOf("_");if(-1!=r)for(var s=a[1].split("_"),o=0;o<s.length;o++){for(var l=s[o],c=l.split(","),h=[],u=0;u<c.length;u++){var v=c[u].split("|"),f=new e.Vector2D(+v[0],+v[1]);h[u]=f}i[o]=h}else{for(var c=a[1].split(","),h=[],o=0;o<c.length;o++){var v=c[o].split("|"),f=new e.Vector2D(+v[0],+v[1]);h[o]=f}i[0]=h}break;case 1:var d=a[1].split("|"),g=new e.Circle;g.center=new e.Vector2D(+d[0],+d[1]),g.radius=+d[2],i=g;break;case 2:var p=a[1].split("|");i=new e.Vector2D(+p[0],+p[1])}}return i},n.decodeGlobalBehaviors=function(t,n){if(t&&n&&t.global){var i=n.children;if(i)for(var a=0;a<i.length;a++){var r=i[a],s=e.EventSheetDecoder.decodeBehavior(r);t instanceof e.AIDisplayObject?t.addBehavior(s):e.assert(!0,t+"must instance of AIDisplayObject for have Behaviors")}}},n.destory=function(){this.instanceNames={},this.layers={}},n.curSceneInstances={},n.noSceneInstances={},n.instanceNames={},n.layouts={},n.spriteSheets={},n.spriteSheetDatas={},n.globalInstances=[],n.layers={},n}();e.LayoutDecoder=n,egret.registerClass(n,"ls.LayoutDecoder")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.log=function(t){if(e.Config.openLog){if(null==this.logText){var n=e.GameUILayer.testContainer;n.graphics.clear(),n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,250,250),n.graphics.endFill(),this.logText=new egret.TextField,this.logText.width=250,this.logText.height=250,this.logText.size=14,this.logText.lineSpacing=6,this.logText.fontFamily="宋体",this.logText.textColor=49664,this.logText.x=5,this.logText.y=5,n.addChild(this.logText)}this.logCache.length>12&&this.logCache.shift(),t=void 0==t?"":t,this.logCache.push(t);for(var i="",a=0;a<this.logCache.length;a++)i+=this.logCache[a]+"\n";this.logText.text=i,this.logText.scrollV=this.logText.maxScrollV-12<0?0:this.logText.maxScrollV-12}},t.logCache=[],t}();e.Log=t,egret.registerClass(t,"ls.Log")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.configResouces={},e.componentResources={},e}();e.ResCache=t,egret.registerClass(t,"ls.ResCache")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t.init=function(e){e&&(this.stage=e,null==this.renderContainer&&(this.renderContainer=new egret.Sprite,this.renderContainer.name="renderContainer",e.addChild(this.renderContainer)),null==this.debugContainer&&(this.debugContainer=new egret.Sprite,this.debugContainer.name="debugContainer",e.addChild(this.debugContainer)),null==this.testContainer&&(this.testContainer=new egret.Sprite,this.testContainer.name="testContainer",e.addChild(this.testContainer)),null==this.preContainer&&(this.preContainer=new egret.Sprite,this.preContainer.name="preContainer",e.addChild(this.preContainer)),null==this.loadingContainer&&(this.loadingContainer=new egret.Sprite,this.loadingContainer.name="loadingContainer",e.addChild(this.loadingContainer)),null==this.drawContainer&&(this.drawContainer=new egret.Sprite,this.drawContainer.name="drawContainer",e.addChild(this.drawContainer)),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onStageTouchEvent,this)),window.document&&window.document.getElementsByClassName&&(window.document.getElementsByClassName("egret-player")[0].style.cursor="default"),window.addEventListener&&((180===window.orientation||0===window.orientation)&&(t.orientation=1),(90===window.orientation||-90===window.orientation)&&(t.orientation=0),window.addEventListener("onorientationchange"in window?"orientationchange":"resize",function(){(180===window.orientation||0===window.orientation)&&(t.orientation=1),(90===window.orientation||-90===window.orientation)&&(t.orientation=0)},!1))},t.onStageTouchEvent=function(e){this.touchX=e.stageX,this.touchY=e.stageY},t.touchX=0,t.touchY=0,t.orientation=0,t}(egret.DisplayObjectContainer);e.GameUILayer=t,egret.registerClass(t,"ls.GameUILayer")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(t){this.oldSceneX=0,this.oldSceneY=0,this.newSceneX=0,this.newSceneY=0,this.updateCamera=!1,this.fov=250,this.scene=t,this._scrollX=e.GameUILayer.stage.stageWidth>>1,this._scrollY=e.GameUILayer.stage.stageHeight>>1,this.otherLayers=[]}var n=__define,i=t,a=i.prototype;return a.resetCamera=function(){e.GameUILayer.renderContainer.x=e.GameUILayer.renderContainer.y=0,this.oldSceneX=this.oldSceneY=0,this.newSceneX=this.newSceneY=0},a.lookAtPoint=function(e){this.pos!=e&&(this.pos=e,this._scrollX=this.pos.x,this._scrollY=this.pos.y,this.updateCamera=!0)},a.lookAtX=function(e){this._scrollX!=e&&(this.updateCamera=!0,this._scrollX=e)},a.lookAtY=function(e){this._scrollY!=e&&(this.updateCamera=!0,this._scrollY=e)},a.lookAtChar=function(e){this.lookAtTarget=e,(this._scrollX!=this.lookAtTarget.x||this._scrollY!=this.lookAtTarget.y)&&(this.updateCamera=!0,this._scrollX=this.lookAtTarget.x,this._scrollY=this.lookAtTarget.y)},n(a,"cameraLayer",function(){return this._cameraLayer},function(t){this._cameraLayer=t,this.otherLayers=[];for(var n=0,i=e.GameUILayer.renderContainer.numChildren;i>n;n++){var a=e.GameUILayer.renderContainer.getChildAt(n);a!==this._cameraLayer&&this.otherLayers.push(a)}}),a.render=function(){if(this.cameraLayer){if(!this.cameraLayer.updateCamera)return;this._cameraLayer=this.cameraLayer;var t=e.LayoutDecoder.sceneWidth,n=e.LayoutDecoder.sceneHeight,i=e.GameUILayer.stage.stageWidth,a=e.GameUILayer.stage.stageHeight,r=i>>1,s=a>>1,o=t-(i/this.cameraLayer.scaleX>>1),l=n-(a/this.cameraLayer.scaleY>>1);this.cameraLayer.scrollX<r/this.cameraLayer.scaleX&&(this.cameraLayer.scrollX=r/this.cameraLayer.scaleX),this.cameraLayer.scrollY<s/this.cameraLayer.scaleY&&(this.cameraLayer.scrollY=s/this.cameraLayer.scaleY),this.cameraLayer.scrollX>o&&(this.cameraLayer.scrollX=o),this.cameraLayer.scrollY>l&&(this.cameraLayer.scrollY=l),this.cameraLayer.tx=(this.cameraLayer.scrollX-r)*this.cameraLayer.parallaxX/100,this.cameraLayer.ty=(this.cameraLayer.scrollY-s)*this.cameraLayer.parallaxY/100,this.cameraLayer.dScrollX=isNaN(this.cameraLayer.oldScrollX)?this.cameraLayer.scrollX-r:this.cameraLayer.scrollX-this.cameraLayer.oldScrollX,this.cameraLayer.dScrollY=isNaN(this.cameraLayer.oldScrollY)?this.cameraLayer.scrollY-s:this.cameraLayer.scrollY-this.cameraLayer.oldScrollY,this.cameraLayer.oldScrollX=this.cameraLayer.scrollX,this.cameraLayer.oldScrollY=this.cameraLayer.scrollY,this.cameraLayer.x=-this.cameraLayer.tx*this.cameraLayer.scaleX,this.cameraLayer.y=-this.cameraLayer.ty*this.cameraLayer.scaleY,this.cameraLayer.x-=r*(this.cameraLayer.scaleX-1),this.cameraLayer.y-=s*(this.cameraLayer.scaleY-1),this.cameraLayer.x=this.cameraLayer.x>>0,this.cameraLayer.y=this.cameraLayer.y>>0;for(var c=0,h=this.otherLayers.length;h>c;c++){var u=this.otherLayers[c],v=this.cameraLayer.tx,f=this.cameraLayer.ty,d=-this.cameraLayer.tx*u.parallaxX/this.cameraLayer.parallaxX,g=-this.cameraLayer.ty*u.parallaxY/this.cameraLayer.parallaxY,p=r*(u.scaleX-1)-this.cameraLayer.tx,y=s*(u.scaleY-1)-this.cameraLayer.ty;u.update=!1,u.tmpTx!=v&&(u.tmpTx=v,u.update=!0),u.tmpTy!=f&&(u.tmpTy=f,u.update=!0),u.tmpX1!=d&&(u.tmpX1=d,u.update=!0),u.tmpY1!=g&&(u.tmpY1=g,u.update=!0),u.tmpX2!=p&&(u.tmpX2=p,u.update=!0),u.tmpY2!=y&&(u.tmpY2=y,u.update=!0),u.update&&(u.anchorOffsetX=this.cameraLayer.tx,u.anchorOffsetY=this.cameraLayer.ty,u.x=u.tmpX1-u.tmpX2,u.y=u.tmpY1-u.tmpY2,u.anchorOffsetX=u.anchorOffsetX>>0,u.anchorOffsetY=u.anchorOffsetY>>0,u.x=u.x>>0,u.y=u.y>>0)}this.cameraLayer.updateCamera=!1}},t}();e.SceneCamera=t,egret.registerClass(t,"ls.SceneCamera")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){if(this._objectList=[],this._objectHash={},this._updateCamera=!0,t._instance)throw new Error(this.constructor+"为单例！");t._instance=this,this._sceneCamera=new e.SceneCamera(this)}var n=__define,i=t,a=i.prototype;return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},n(a,"sceneCamera",function(){return this._sceneCamera}),n(a,"objectList",function(){return this._objectList}),n(a,"objectHash",function(){return this._objectHash}),a.scrollToTarget=function(e){this._sceneCamera.lookAtChar(e)},a.scrollToXY=function(e,t){this._sceneCamera.lookAtPoint(new egret.Point(e,t))},a.scrollToX=function(e){this._sceneCamera.lookAtX(e)},a.scrollToY=function(e){this._sceneCamera.lookAtY(e)},n(a,"cameraLayer",function(){return this._sceneCamera.cameraLayer}),a.render=function(){},a.getChildByUID=function(e){void 0===e&&(e=0);for(var t=0,n=this._objectList.length;n>t;t++){var i=this._objectList[t];if(i.id==e)return i}return null},a.getChildByName=function(e){var t=[];if(null==e||""==e)return t;for(var n=0,i=this._objectList.length;i>n;n++){var a=this._objectList[n];a.name==e&&t.push(a)}return t},a.addChildLayerAt=function(t,n,i){var a=t.container;if(void 0!=a&&null!=a){var r=e.LayerManager.getLayer(n);r?r.addChildAt(a,i):(r=e.LayerManager.getLayerByIndex(t,n),r.parallaxX=t.parallaxX,r.parallaxY=t.parallaxY,r.addChild(a))}this._addChild(t)},a.addChild=function(t){var n=t.container;if(void 0!=n&&null!=n){var i=t.layer,a=e.LayerManager.getLayerByIndex(t,i);a.parallaxX=t.parallaxX,a.parallaxY=t.parallaxY,a.addChild(n)}this._addChild(t)},a._addChild=function(e){var t=e.name;this._objectHash.hasOwnProperty(t)||(this._objectHash[t]=[]);for(var n=-1,i=0;i<this._objectHash[t].length;i++){var a=this._objectHash[t][i];if(a.u_id==e.u_id){n=i;break}}-1==n?(this._objectHash[t].push(e),this._objectList.push(e)):this._objectHash[t][n]=e},a.removeChild=function(t){if(t){var n=this.objectList.indexOf(t);-1!=n&&this._objectList.splice(n,1);var i=t.container;if(i&&null!=i.parent&&i.parent.removeChild(i),this._objectHash.hasOwnProperty(t.name)){for(var a=this._objectHash[t.name],r=-1,s=0;s<a.length;s++){var o=a[s];if(o.u_id==t.u_id){r=s;break}}-1!=r&&a.splice(r,1)}t.id>=0&&delete e.LayoutDecoder.curSceneInstances[t.id],e.Trigger.removeTrigger(t)}},a.removeAllChildrens=function(){e.Trigger.removeAllTriggers();for(var t in this._objectHash){var n=this._objectHash[t];if(n)for(var i=n.length-1;i>=0;i--){var a=n[i];a.global||a.destoryOnChangeScene()}}},a.destory=function(){this._sceneCamera.lookAtPoint(new egret.Point(0,0)),null!=t.onWorldDestory&&t.onWorldDestory(),e.LayoutDecoder.destory(),e.EventSheetDecoder.destory(),this._sceneCamera.resetCamera(),this.removeAllChildrens(),e.LayerManager.clearLayers()},t.renderFirst=!0,t}();e.World=t,egret.registerClass(t,"ls.World")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this.id=0,this.name="Object",this.isModel=!1,this.timeScale=-1,this.parallaxX=100,this.parallaxY=100,this.isDead=!1,this.global=!1,this.variables={},this.index=0,this.paramInstances={},this.actionSaves={},this.currentStatus=!0,this.selfStatus=!0,this._uid=0,n._uniqueID++,n.U_ID++,this._uid=n.U_ID,this.name="Object",this.plugin=egret.getQualifiedClassName(this),e.Trigger.register(this)}__extends(n,t);var i=__define,a=n,r=a.prototype;return i(r,"u_id",function(){return this._uid}),i(r,"dt",function(){return 1/60}),r.getClass=function(){return this.constructor},r.initialize=function(){},r.onCreate=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCreated))},r.onTick=function(){},r.addVariable=function(t,n){this[t]=e.eval_e(n),this.variables[t]=e.eval_e(n)},r.getFirstPicked=function(){var t=e.World.getInstance().objectHash[this.name];return t?t[0]:void 0},r.onCreated=function(e){return{instances:[this],status:!0}},r.compareInstanceVariable=function(t){return{instances:[this],status:e.compare(this[t.instanceVariable],t.operationType,t.value)}},r.compareTwoValue=function(t){return{instances:[this],status:e.compare(t.value1,t.operationType,t.value2)}},r.isBetweenValues=function(t){var n=e.eval_e(t.value),i=e.eval_e(t.lowerValue),a=e.eval_e(t.highValue);return a>i?{instances:[this],status:n>i&&a>n}:{instances:[this],status:i>n&&n>a}},r.isNumberNaN=function(t){return{instances:[this],status:"number"==typeof e.eval_e(t.value)}},r.addTo=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject addTo parameter type incorrect!!"),this[t]+=i,this.variables[t]=this[t]},r.setBoolean=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==i,this.variables[t]=this[t]},r.setValue=function(t,n){var i=e.eval_e(n);this[t]=i,this.variables[t]=this[t]},r.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i,this.variables[t]=this[t]},r.toogleBoolean=function(e){this[e]=!this[e],this.variables[e]=this[e]},r.destoryOnChangeScene=function(){this.destory()},r.destory=function(){},r.saveToJSON=function(){return{plugin:egret.getQualifiedClassName(this),id:this.id,uid:this.u_id,name:this.name,isModel:this.isModel,isDead:this.isDead,paramInstances:this.paramInstances,timeScale:this.timeScale,global:this.global,variables:JSON.stringify(this.variables)}},r.loadFromJSON=function(e){if(e){this.plugin=e.plugin,this.id=e.id,this._uid=e.uid,this.name=e.name,this.isModel=e.isModel,this.isDead=e.isDead,this.paramInstances=e.paramInstances,this.timeScale=e.timeScale,this.global=e.global,this.variables=JSON.parse(e.variables);for(var t in this.variables)this.addVariable(t,this.variables[t])}},r.clone=function(){var e=this.getClass(),t=new e;t.id=-Number.MAX_VALUE,t.name=this.name,t.isModel=!1,t.timeScale=this.timeScale,t.global=this.global;for(var n in this.variables)t.addVariable(n,this.variables[n]);return t},n._uniqueID=0,n.U_ID=0,n}(egret.EventDispatcher);e.AIObject=t,egret.registerClass(t,"ls.AIObject");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareTwoValuesEvent=n,egret.registerClass(n,"ls.CompareTwoValuesEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsBetweenValuesEvent=i,egret.registerClass(i,"ls.IsBetweenValuesEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsNumberNaNEvent=a,egret.registerClass(a,"ls.IsNumberNaNEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnCreatedEvent=r,egret.registerClass(r,"ls.OnCreatedEvent");var s=function(e){function t(){e.apply(this,arguments),this.value=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareInstanceVariableEvent=s,egret.registerClass(s,"ls.CompareInstanceVariableEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this._isAddToStage=!1,this._collision=!1,this._isCollisioning=!1,this._mirrored=3,this._sourceWidth=0,this._sourceHeight=0,this._x=0,this._y=0,this._anchorX=0,this._anchorY=0,this._anchorOffsetX=0,this._anchorOffsetY=0,this._width=1,this._height=1,this._scaleX=1,this._scaleY=1,this._scale=1,this._angle=0,this._alpha=1,this._visible=!0,this.behaviors=[],this.layer=0,this.vx=0,this.vy=0,this.snapPixelsEnabled=!1,this.isInScreenOnce=!1,this.solidEnabeld=!1,this.platformEnabled=!1,this.jumpthruEnabled=!1,this.collisionType=-1,this.collisionIsRect=!0,this.scaleContainer=!0,this.update=!0,this._updateX=!0,this._updateY=!0,this._updateWidth=!0,this._updateHeight=!0,this._updateAngle=!0,this._updateAnchorOffsetX=!0,this._updateAnchorOffsetY=!0,this._updateScaleX=!0,this._updateScaleY=!0,this.isOldCollision=!1,this._scaleXChanged=!1,this._scaleYChanged=!1,this.onTweenStatus={},this._container=new egret.Sprite,this._container.owner=this,this._container.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStageHanlder,this),this._container.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStageHanlder,this),this._container.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEvent,this)}__extends(n,t);var i=__define,a=n,r=a.prototype;return r.onTouchEvent=function(t){switch(this._isTouchDown=t.touchDown,this._touchPointID=t.touchPointID,this._touchX=t.localX,this._touchY=t.localY,this._touchStageX=t.stageX,this._touchStageY=t.stageY,t.type){case egret.TouchEvent.TOUCH_TAP:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonTap));break;case egret.TouchEvent.TOUCH_BEGIN:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonBegin));break;case egret.TouchEvent.TOUCH_END:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonEnd));break;case egret.TouchEvent.TOUCH_MOVE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonMove));break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonReleaseOutside))}},i(r,"sortIndex",function(){var t=e.World.getInstance().objectHash[this.name];return t?t.indexOf(this):0}),i(r,"count",function(){return e.World.getInstance().objectHash[this.name].length}),i(r,"layerIndex",function(){return e.LayerManager.getIndexByLayer(this.container.parent)}),i(r,"enabled",function(){return this.container.touchEnabled},function(e){this.container.touchChildren=this.container.touchEnabled=e}),i(r,"collision",function(){return this._collision},function(e){this._collision=e}),i(r,"isCollsioning",function(){return this._isCollisioning},function(e){this._isCollisioning=e}),i(r,"isOnScreen",function(){return this.container.stage?(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getTransformedBounds(e.GameUILayer.stage,this._boundRect),void 0===this._stageRect?this._stageRect=new egret.Rectangle(0,0,e.GameUILayer.stage.stageWidth,e.GameUILayer.stage.stageHeight):(this._stageRect.width=e.GameUILayer.stage.stageWidth,this._stageRect.height=e.GameUILayer.stage.stageHeight),this._boundRect.intersects(this._stageRect)):!1}),r.getBounds=function(){return this.container.stage&&(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getBounds(this._boundRect)),this._boundRect},r.intersects=function(e){var t=this.getGlobalBounds(),n=e.getGlobalBounds();return t.intersects(n)},r.intersects_rect_off=function(e,t,n){var i=this.getBounds(),a=e.getBounds();return a=a.clone(),a.offset(t,n),i.intersects(a)},r.getGlobalBounds=function(){return this.container.stage&&(this.renderUpdate(),this._boundRect=this._boundRect?this._boundRect:new egret.Rectangle,this.container.getTransformedBounds(e.GameUILayer.stage,this._boundRect)),this._boundRect},r.getCacheCollisionPolygonData=function(){for(var t=[],n=0;n<this.collisionVectorData.length;n++){for(var i=[],a=0;a<this.collisionVectorData[n].length;a++){var r=this.collisionVectorData[n][a],s=new egret.Matrix;s.translate(r.x-this.anchorOffsetX,r.y-this.anchorOffsetY),s.scale(this.scaleX,this.scaleY),s.rotate(this.angle*Math.PI/180),i[a]=new e.Vector2D(s.tx,s.ty)}t[n]=i}return t},r.getLines=function(){var e=this.getCacheCollisionPolygonData(),t=e[0],n=t[0],i=t[1],a=t[2],r=t[3],s={p1x:n.x,p1y:n.y,p2x:i.x,p2y:i.y},o={p1x:i.x,p1y:i.y,p2x:a.x,p2y:a.y},l={p1x:a.x,p1y:a.y,p2x:r.x,p2y:r.y},c={p1x:r.x,p1y:r.y,p2x:n.x,p2y:n.y};return[s,o,l,c]},r.renderUpdate=function(){if(this.update){var e=this.container;e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,this.scaleContainer&&(e.scaleX=this.scaleX,e.scaleY=this.scaleY),e.rotation=this.angle,e.anchorOffsetX=this.width*this.anchorX,e.anchorOffsetY=this.height*this.anchorY,this.snapPixelsEnabled&&(e.x=e.x>>0,e.y=e.y>>0,e.width=e.width>>0,e.height=e.height>>0,e.anchorOffsetX=e.anchorOffsetX>>0,e.anchorOffsetY=e.anchorOffsetY>>0),e.alpha=this.alpha,e.visible=this.visible,this.update=!1}},i(r,"box",function(){return this.getBounds()}),r.setIsColliding=function(t,n){if(this.collisionTarget=n,t&&(this.isCollsioning=t),this.isOldCollision!=t&&(this.isOldCollision=t,n&&t)){var i=new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,{object:n});i.changeValue={},i.changeValue.object=n,this.dispatchEvent(i);var i=new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,{object:this});i.changeValue={},i.changeValue.object=this,n.dispatchEvent(i)}},i(r,"mirrored",function(){return this._mirrored},function(e){if(this._mirrored!=e)switch(this._mirrored=e,this._mirrored){case 0:this.scaleX=-1;break;case 1:this.scaleY=-1;break;case 2:this.scaleX=-1,this.scaleY=-1;break;case 3:this.scaleX=1,this.scaleY=1}}),r.getBehavior=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t];if(n.constructor==e)return n}return null},r.addBehavior=function(e){return null!=e?("ls.ScrollToBehavior"==egret.getQualifiedClassName(e)&&(this.isHasCamera=!0),e.inst=this,e.enabled=e.enabled,this.isInScreenOnce=!1,this.behaviors.push(e),!0):!1},r.removeBehavior=function(e){if(null!=e){var t=this.behaviors.indexOf(e);if(-1!=t)return e=null,this.behaviors.splice(t,1)}return null},r.removeAllBehaviors=function(){for(var e=0;e<this.behaviors.length;e++){this.behaviors[e];this.global||(this.behaviors.splice(e,1),e--)}},i(r,"container",function(){return this._container}),i(r,"x",function(){return this._x},function(e){this._x!=e&&(this._x=e,this.update=!0,this._updateX=!0)}),i(r,"y",function(){return this._y},function(e){this._y!=e&&(this._y=e,this.update=!0,this._updateY=!0)}),i(r,"width",function(){return this._width},function(e){this._width!=e&&(this._width=e,this.update=!0,this._updateWidth=!0)}),i(r,"height",function(){return this._height},function(e){this._height!=e&&(this._height=e,this.update=!0,this._updateHeight=!0)}),i(r,"angle",function(){return this._angle},function(e){this._angle!=e&&(this._angle=e,this.update=!0,this._updateAngle=!0)}),i(r,"alpha",function(){return this._alpha},function(e){this._alpha!=e&&(this._alpha=e,this.update=!0)}),i(r,"visible",function(){return this._visible},function(e){this._visible!=e&&(this._visible=e,this.update=!0)}),i(r,"scale",function(){return this._scale},function(e){this._scale=e,this._scaleX=this._scaleY=e,this.update=!0}),i(r,"scaleX",function(){return this._scaleX},function(e){this._scaleX!=e&&(this._scaleX=e,this.update=!0,this._updateScaleX=!0)}),i(r,"scaleY",function(){return this._scaleY},function(e){this._scaleY!=e&&(this._scaleY=e,this.update=!0,this._updateScaleY=!0)}),i(r,"anchorX",function(){return this._anchorX},function(e){this._anchorX!=e&&(this._anchorX=e,this._anchorOffsetX=this.width*e,this.update=!0,this._updateAnchorOffsetX=!0)}),i(r,"anchorOffsetX",function(){return this._anchorOffsetX}),i(r,"anchorOffsetY",function(){return this._anchorOffsetY}),i(r,"anchorY",function(){return this._anchorY},function(e){this._anchorY!=e&&(this._anchorY=e,this._anchorOffsetY=this.height*e,this.update=!0,this._updateAnchorOffsetY=!0)}),r.isTouchDown=function(e){return{instances:[this],status:this._isTouchDown}},r.onButtonTap=function(e){return{instances:[this],status:!0}},r.onButtonBegin=function(e){return{instances:[this],status:!0}},r.onButtonEnd=function(e){return{instances:[this],status:!0}},r.onButtonMove=function(e){return{instances:[this],status:!0}},r.onButtonReleaseOutside=function(e){return{instances:[this],status:!0}},r.isEnabled=function(e){return{instances:[this],status:this.enabled}},r.isBetweenAngles=function(t){var n=e.eval_e(t.angle),i=e.eval_e(t.angle1),a=e.eval_e(t.angle2),r=this._isClosewideform(i,a);return r?{instances:[this],status:this._isClosewideform(n,i)&&this._isClosewideform(n,a)}:{instances:[this],status:this._isClosewideform(n,i)&&!this._isClosewideform(n,a)}},r.isclockwiseform=function(t){var n=e.eval_e(t.angle1),i=e.eval_e(t.angle2);return{instances:[this],status:this._isClosewideform(n,i)}},r._isClosewideform=function(t,n){var i=e.MathUtils.toRadian(t),a=e.MathUtils.toRadian(n),r=Math.sin(i),s=Math.cos(i),o=Math.sin(a),l=Math.cos(a);return 0>=s*o-r*l},r.isObjectMoving=function(e){var t=this.x,n=this.y;return this._oldX!=t||this._oldY!=n?(this._oldX=t,this._oldY=n,{instances:[this],status:!0}):{instances:[this],status:!1}},r.compareX=function(t){return{instances:[this],status:e.compare(this.x,t.operationType,t.x)}},r.compareY=function(t){return{instances:[this],status:e.compare(this.y,t.operationType,t.y)}},r.compareWidth=function(t){return{instances:[this],status:e.compare(this.width,t.operationType,t.width)}},r.compareHeight=function(t){return{instances:[this],status:e.compare(this.height,t.operationType,t.height)}},r.compareAlpha=function(t){return{instances:[this],status:e.compare(this.alpha,t.operationType,t.alpha)}},r.compareMirored=function(t){return{instances:[this],status:e.eval_e(t.mirrored)==this._mirrored}},r.compareObjectMoveAngle=function(t){var n=this.x,i=this.y,a=!1;if(isNaN(this._oldMoveX)||isNaN(this._oldMoveY))this._oldMoveX=n,this._oldMoveY=i;else if(this._oldMoveX!=n||this._oldMoveY!=i){var r=Math.atan2(i-this._oldMoveY,n-this._oldMoveX),s=e.MathUtils.toAngle(r);a=e.compare(s,t.operationType,t.angle),this._oldMoveX=n,this._oldMoveY=i}return{instances:[this],status:a}},r.compareObjectAngle=function(t){return{instances:[this],status:e.compare(this.angle,t.operationType,t.angle)}},r.compareTargetDistance=function(t){var n=e.eval_e(t.x),i=e.eval_e(t.y),a=n-this.x,r=i-this.y,s=Math.sqrt(a*a+r*r);return{instances:[this],status:e.compare(s,t.operationType,t.distance)}},r.onAddToStage=function(e){return{instances:[this],status:null!=this.container.stage||this._isAddToStage}},r.onRemoveToToStage=function(){return{instances:[this],status:!this.container.stage||!this._isAddToStage}},r.isOnScreenOrFalse=function(t){return{instances:[this],status:1===e.eval_e(t.isOnScreen)?this.isOnScreen:!this.isOnScreen}},r.isVisible=function(t){return{instances:[this],status:0!==e.eval_e(t.isVisible)}},r.onCollisionWithOtherObject=function(e){return{instances:[this,e.object],status:e.getStatus("object")}},r.onEnabledDisabledCollision=function(e){return{instances:[this],status:1==e.status}},r.isOverlappingOtherObject=function(e){return{instances:[this.collisionTarget,e.object],status:this.collisionTarget.name==e.object.name}},r.onTweenComplete=function(e){return{instances:[this],status:e.getStatus("key")}},r.pickByUniqueID=function(t){for(var n,i=e.World.getInstance().objectHash[this.name],a=0;a<i.length;a++){var r=i[a];if(r.id==e.eval_e(t.uniqueID)){n=r;break}}return{instances:[r],status:Boolean(n)}},r.onDestory=function(e){return{instances:[this],status:!0}},r.spawn=function(t,n,i,a,r){var s=e.eval_e(n),o=e.eval_e(i),l=e.eval_e(a),r=e.eval_e(r);e.assert("number"!=typeof s||"number"!=typeof o||"number"!=typeof l,"AIDisplayObject spawn parameter type incorrect!!");var c=t.clone();c.layer=s,1==r?(c.angle=this.angle,c.relyOnTarget=this):c.relyOnTarget=null;var h=e.MathUtils.angleTo(this.x,this.y,this.x+o,this.y+l),u=Math.sqrt(o*o+l*l),v=e.MathUtils.toRadian(c.angle)+e.MathUtils.toRadian(h);return c.x=this.x+Math.cos(v)*u,c.y=this.y+Math.sin(v)*u,c.initialize(),c.onCreate(),t.cloneBehavior(c),e.lakeshoreInst()[c.name]=c,e.World.getInstance().addChild(c),[c]},r.moveAtAngle=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i,"AIDisplayObject moveAtAngle parameter type incorrect!!"),e.assert("number"!=typeof a,"AIDisplayObject moveAtAngle parameter type incorrect!!");var r=e.MathUtils.toRadian(i);this.x+=Math.cos(r)*a*e.timeScale(),this.y+=Math.sin(r)*a*e.timeScale()},r.moveForward=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject moveForward parameter type incorrect!!");var i=e.MathUtils.toRadian(this.angle);this.x+=Math.cos(i)*n*e.timeScale(),this.y+=Math.sin(i)*n*e.timeScale()},r.moveToTargetPoint=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof i,"AIDisplayObject moveToTargetPoint parameter type incorrect!!");var a=t-this.x,r=n-this.y,s=Math.sqrt(a*a+r*r);if(i>s)this.x=t,this.y=n;else{var o=Math.atan2(r,a);this.x+=Math.cos(o)*i*e.timeScale(),this.y+=Math.sin(o)*i*e.timeScale()}},r.rotateClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateClockWise parameter type incorrect!!"),this.angle+=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},r.rotateCounterClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateCounterClockWise parameter type incorrect!!"),this.angle-=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},r.rotateTowardAngle=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject rotateTowardAngle parameter type incorrect!!");var r=e.MathUtils.toAngle(e.MathUtils.angleRadius(e.MathUtils.toRadian(this.angle),e.MathUtils.toRadian(i),e.MathUtils.toRadian(a*e.timeScale())));isNaN(r)||this.angle!=r&&(this.angle=r)},r.rotateTowardPosition=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),a=e.eval_e(i);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof a,"AIDisplayObject rotateTowardPosition parameter type incorrect!!");var r=e.MathUtils.angleTo(this.x,this.y,t,n),s=e.MathUtils.toAngle(e.MathUtils.angleRadius(e.MathUtils.toRadian(this.angle),e.MathUtils.toRadian(r),e.MathUtils.toRadian(a*e.timeScale())));isNaN(s)||this.angle!=s&&(this.angle=s)},r.setAngle=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAngle parameter type incorrect!!"),this.angle=n},r.setAngleTowardPosition=function(t,n){var t=e.eval_e(t),n=e.eval_e(n);e.assert("number"!=typeof t||"number"!=typeof n,"AIDisplayObject setAngleTowardPosition parameter type incorrect!!");var i=e.MathUtils.angleTo(this.x,this.y,t,n);this.angle=i},r.setHeight=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setHeight parameter type incorrect!!"),this.height=n},r.setMirrored=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setMirrored parameter type incorrect!!"),this.mirrored=n},r.setPosition=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject setPosition parameter type incorrect!!"),this.x=i,this.y=a},r.setPositionToAnotherObject=function(t,n,i){var a=e.eval_e(n),r=e.eval_e(i),s=t instanceof e.AIObject?t:e.eval_e(t);e.assert("number"!=typeof a||"number"!=typeof a,"AIDisplayObject setPositionToAnotherObject parameter type incorrect!!"),this.x=s.x+a,this.y=s.y+r},r.setScale=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScale parameter type incorrect!!"),this.scale=n},r.setScaleX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleX parameter type incorrect!!"),this.scaleX=n},r.setScaleY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleY parameter type incorrect!!"),this.scaleY=n},r.setSize=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject setSize parameter type incorrect!!"),this.width=i,this.height=a},r.setVisible=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setVisible parameter type incorrect!!"),this.visible=1==n
},r.setAlpha=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAlpha parameter type incorrect!!"),1e-4>n&&(n=0),n>1&&(n=1),this.alpha=n},r.setWidth=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setWidth parameter type incorrect!!"),this.width=n},r.setX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setX parameter type incorrect!!"),this.x=n},r.setY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setY parameter type incorrect!!"),this.y=n},r.setEnabled=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setEnabled parameter type incorrect!!"),this.enabled=n>=1},r.setMask=function(e){e&&e instanceof n&&(this.container.mask=e.container)},r.setMaskByLayer=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);n&&(this.container.mask=n)},r.setMaskIsNull=function(){this.container.mask=null},r.addColorMatrixFilter=function(e){if(e){var t=e.split(",");if(t&&20==t.length){for(var n=[],i=0;i<t.length;i++)n[i]=+t[i];var a=new egret.ColorMatrixFilter(n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(a)}}},r.addBlurFilter=function(t,n){t=e.eval_e(t),n=e.eval_e(n);var i=new egret.BlurFilter(t,n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(i)},r.addDropShadowFilter=function(t,n,i,a,r,s,o,l,c,h,u){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l),c=e.eval_e(c),h=e.eval_e(h),u=e.eval_e(u);var v=new egret.DropShadowFilter(t,n,i,a,r,s,o,l,c,h,u);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(v)},r.addGlowFilter=function(t,n,i,a,r,s,o,l){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l);var c=new egret.GlowFilter(t,n,i,a,r,s,o,l);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(c)},r.removeFilterByType=function(t){if(t=e.eval_e(t),this.container.filters)for(var n=0,i=0;i<this.container.filters.length;i++){var a=this.container.filters[i];switch(t){case 0:a instanceof egret.ColorMatrixFilter&&(this.container.filters.splice(i-n,1),n++);break;case 1:a instanceof egret.BlurFilter&&(this.container.filters.splice(i-n,1),n++);break;case 2:a instanceof egret.DropShadowFilter&&(this.container.filters.splice(i-n,1),n++);break;case 3:a instanceof egret.GlowFilter&&(this.container.filters.splice(i-n,1),n++)}}},r.removeAllFilters=function(){this.container.filters=null},r.execTween=function(t,n,i,a,r,s,o,l,c,h,u,v,f,d,g){var p=t?e.eval_e(t):"lsTweenStartKey",y=e.eval_e(h),_=e.eval_e(u),m=e.eval_e(v),b=egret.Ease[_],x={};null!==n&&void 0!==n&&""!==n&&(x.x=e.eval_e(n)),null!==i&&void 0!==i&&""!==i&&(x.y=e.eval_e(i)),null!==a&&void 0!==a&&""!==a&&(x.anchorX=e.eval_e(a)),null!==r&&void 0!==r&&""!==r&&(x.anchorY=e.eval_e(r)),null!==s&&void 0!==s&&""!==s&&(x.width=e.eval_e(s)),null!==o&&void 0!==o&&""!==o&&(x.height=e.eval_e(o)),null!==l&&void 0!==l&&""!==l&&(x.angle=e.eval_e(l)),null!==c&&void 0!==c&&""!==c&&(x.alpha=e.eval_e(c)),null!==d&&void 0!==d&&""!==d&&(x.scaleX=e.eval_e(d)),null!==g&&void 0!==g&&""!==g&&(x.scaleY=e.eval_e(g));var C=arguments.callee.prototype;egret.setTimeout(function(){egret.Tween.get(this,{loop:1==f,onChange:null,onChangeObj:this}).to(x,y,b).wait(0).call(function(t){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onTweenComplete,{key:t})),C.onActionComplete&&C.onActionComplete()},this,[p])},this,m)},r.enabledDisabledCollision=function(t){var n=e.eval_e(t);this.collision=1==n},r.onAddToStageHanlder=function(e){this._isAddToStage=!0},r.onRemoveToStageHanlder=function(e){this._isAddToStage=!1},r.destoryTest=function(){this.destory()},r.destoryOnChangeScene=function(){this.removeAllBehaviors(),this.destory(!0)},r.destory=function(t){if(void 0===t&&(t=!1),t&&this.behaviors)for(var n=0;n<this.behaviors.length;n++){var i=this.behaviors[n];i.destory()}this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDestory)),this.container.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStageHanlder,this),this.container.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStageHanlder,this),e.World.getInstance().removeChild(this),this.container=null,this.global||(this.isDead=!0),this.onDestoryHanlder&&this.onDestoryHanlder()},r.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.collision=this.collision,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.snapPixelsEnabled=this.snapPixelsEnabled,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.relyOnTarget=this.relyOnTarget,e.solidEnabeld=this.solidEnabeld,e.platformEnabled=this.platformEnabled,e.jumpthruEnabled=this.jumpthruEnabled,e.variables=JSON.stringify(this.variables),e.behaviors=[];for(var n=0;n<this.behaviors.length;n++){var i=this.behaviors[n];e.behaviors[n]=i.saveToJSON(),e.behaviors[n].plugin=egret.getQualifiedClassName(i)}return e},r.loadFromJSON=function(n){if(n){this.x=n.x,this.y=n.y,this.width=n.width,this.height=n.height,this.scale=n.scale,this.scaleX=n.scaleX,this.scaleY=n.scaleY,this.angle=n.angle,this.alpha=n.alpha,this.visible=n.visible,this.mirrored=n.mirrored,this.collision=n.collision,this.anchorX=n.anchorX,this.anchorY=n.anchorY,this.layer=n.layer,this.parallaxX=n.parallaxX,this.parallaxY=n.parallaxY,this.snapPixelsEnabled=n.snapPixelsEnabled,this.collisionData=n.collisionData,this.collisionType=n.collisionType,this.collisionSourceData=n.collisionSourceData,this.collisionVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionData),this.collisionSourceVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionSourceData),this.collisionIsRect=n.collisionIsRect,this.scaleContainer=n.scaleContainer,this.enabled=n.enabled,this.relyOnTarget=n.relyOnTarget,this.solidEnabeld=n.solidEnabeld,this.platformEnabled=n.platformEnabled,this.jumpthruEnabled=n.jumpthruEnabled,this.variables=JSON.parse(n.variables);for(var i in this.variables)this[i]=this.variables[i];this.removeAllBehaviors();for(var a=0;a<n.behaviors.length;a++){var r=n.behaviors[a],s=r.plugin.slice(3),o=e.getInstanceByPluginClassName(s);o.loadFromJSON(r);for(var l=-1,c=0;c<this.behaviors.length;c++)if(egret.getQualifiedClassName(this.behaviors[c])==egret.getQualifiedClassName(o)){l=c;break}-1!=l&&(this.addBehavior(o),o.onCreate())}t.prototype.loadFromJSON.call(this,n)}},r.clone=function(){var e=t.prototype.clone.call(this);return e.name=this.name,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.global=this.global,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionVectorData=this.collisionVectorData,e.collisionSourceVectorData=this.collisionSourceVectorData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.collision=this.collision,e.relyOnTarget=this.relyOnTarget,e.snapPixelsEnabled=this.snapPixelsEnabled,e.solidEnabeld=this.solidEnabeld,e.platformEnabled=this.platformEnabled,e.jumpthruEnabled=this.jumpthruEnabled,e},r.cloneBehavior=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t],i=n.clone();e.addBehavior(i),i.isCreated||(i.isCreated=!0,i.onCreate())}},n}(e.AIObject);e.AIDisplayObject=t,egret.registerClass(t,"ls.AIDisplayObject");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsButtonDownEvent=n,egret.registerClass(n,"ls.IsButtonDownEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonTapEvent=i,egret.registerClass(i,"ls.OnButtonTapEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonBeginEvent=a,egret.registerClass(a,"ls.OnButtonBeginEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonEndEvent=r,egret.registerClass(r,"ls.OnButtonEndEvent");var s=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonMoveEvent=s,egret.registerClass(s,"ls.OnButtonMoveEvent");var o=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonReleaseOutsideEvent=o,egret.registerClass(o,"ls.OnButtonReleaseOutsideEvent");var l=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsButtonEnabledEvent=l,egret.registerClass(l,"ls.IsButtonEnabledEvent");var c=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsBetweenAnglesEvent=c,egret.registerClass(c,"ls.IsBetweenAnglesEvent");var h=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsClockwiseFromEvent=h,egret.registerClass(h,"ls.IsClockwiseFromEvent");var u=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsObjectMovingEvent=u,egret.registerClass(u,"ls.IsObjectMovingEvent");var v=function(e){function t(){e.apply(this,arguments),this.x=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareXPosEvent=v,egret.registerClass(v,"ls.CompareXPosEvent");var f=function(e){function t(){e.apply(this,arguments),this.y=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareYPosEvent=f,egret.registerClass(f,"ls.CompareYPosEvent");var d=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareWidthEvent=d,egret.registerClass(d,"ls.CompareWidthEvent");var g=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareHeightEvent=g,egret.registerClass(g,"ls.CompareHeightEvent");var p=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareOpacityEvent=p,egret.registerClass(p,"ls.CompareOpacityEvent");var y=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareMirroredStatusEvent=y,egret.registerClass(y,"ls.CompareMirroredStatusEvent");var _=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareObjectMoveAngleEvent=_,egret.registerClass(_,"ls.CompareObjectMoveAngleEvent");var m=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareObjectAngleEvent=m,egret.registerClass(m,"ls.CompareObjectAngleEvent");var b=function(e){function t(){e.apply(this,arguments),this.x=0,this.y=0,this.distance=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareTargetDistanceEvent=b,egret.registerClass(b,"ls.CompareTargetDistanceEvent");var x=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnStartOfLayoutEvent=x,egret.registerClass(x,"ls.OnStartOfLayoutEvent");var C=function(e){function t(){e.apply(this,arguments),this.isOnScreen=1}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsOnScreenEvent=C,egret.registerClass(C,"ls.IsOnScreenEvent");var E=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsVisibleEvent=E,egret.registerClass(E,"ls.IsVisibleEvent");var I=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnCollisionWithOtherObjectEvent=I,egret.registerClass(I,"ls.OnCollisionWithOtherObjectEvent");var S=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnEnabledDisabledCollisionEvent=S,egret.registerClass(S,"ls.OnEnabledDisabledCollisionEvent");var T=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsOverlappingOtherObjectEvent=T,egret.registerClass(T,"ls.IsOverlappingOtherObjectEvent");var O=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickByUniqueIDEvent=O,egret.registerClass(O,"ls.PickByUniqueIDEvent");var D=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDestoryEvent=D,egret.registerClass(D,"ls.OnDestoryEvent");var w=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnTweenCompleteEvent=w,egret.registerClass(w,"ls.OnTweenCompleteEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this._sourceWidth=0,this._sourceHeight=0,this._isResourceLoaded=!1,this.name="Sprite",this._bitmap=new egret.Bitmap,this.container.addChild(this._bitmap)}__extends(n,t);var i=__define,a=n,r=a.prototype;return i(r,"bitmapURL",function(){return this._bitmapURL}),r.initialize=function(){this.createBitmap(this.url)},r.createBitmap=function(t){if(t&&""!=t){this._bitmapURL=t;var n=this,i=e.getTexture(t);if(null!=i)var a=i[0];if(null!=a)this._bitmap.texture=a,this._sourceWidth=a.textureWidth,this._sourceHeight=a.textureHeight,this._bitmap.width=this.width,this._bitmap.height=this.height,this._bitmap.smoothing=!0,i&&(this._bitmap.x=i[1],this._bitmap.y=i[2]),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),this.dispatchEvent(new egret.Event(egret.Event.COMPLETE));else{var r=function(t){t&&(n._bitmap.texture=t,n._sourceWidth=t.textureWidth,n._sourceHeight=t.textureHeight,n._bitmap.width=n.width,n._bitmap.height=n.height,n.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),n.dispatchEvent(new egret.Event(egret.Event.COMPLETE)))};RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_IMAGE)}}},r.loadImage=function(t){var n=e.eval_e(t);this.createBitmap(n)},i(r,"width",function(){return this._width},function(e){this._width!=e&&(this._width=e,this.update=!0),this._bitmap&&this._bitmap.width!=e&&(this._bitmap.width=e)}),i(r,"height",function(){return this._height},function(e){this._height!=e&&(this._height=e,this.update=!0),this._bitmap&&this._bitmap.height!=e&&(this._bitmap.height=e)}),r.beginFill=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.beginFill(t,n)},r.beginGadientFill=function(t,n,i,a,r){t=e.eval_e(t);var s=n.split(",");s.forEach(function(e,t,n){e=parseFloat(e)});var o=i.split(",");o.forEach(function(e,t,n){e=parseFloat(e)});var l=a.split(",");l.forEach(function(e,t,n){e=parseFloat(e)});var c=r.split(",");c.forEach(function(e,t,n){e=parseFloat(e)}),c.length>5&&e.assert(!0,"渐变填充矩阵数据长度不能大于5");var h=new egret.Matrix;h.createGradientBox(c[0],c[1],c[2],c[3],c[4]),this.container.graphics.beginGradientFill(t,s,o,l,h)},r.endFill=function(){this.container.graphics.endFill()},r.clear=function(){this.container.graphics.clear()},r.lineStyle=function(t,n,i,a,r,s,o){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),o=e.eval_e(o),this.container.graphics.lineStyle(t,n,i,a,r,s,o)},r.moveTo=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY)},r.lineTo=function(t,n){t=e.eval_e(t),n=e.eval_e(n),this.container.graphics.lineTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY)},r.drawRect=function(t,n,i,a){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),this.container.graphics.drawRect(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,i,a)},r.drawCircle=function(t,n,i){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),this.container.graphics.drawCircle(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,i)},r.drawEllipse=function(t,n,i,a){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),this.container.graphics.drawEllipse(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,i,a)},r.drawRoundRect=function(t,n,i,a,r,s){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),this.container.graphics.drawRoundRect(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,i,a,r,s)},r.drawArc=function(t,n,i,a,r,s){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),this.container.graphics.drawArc(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY,i,a,r,s)},r.curveTo=function(t,n,i,a,r,s){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY),this.container.graphics.curveTo(i-this.x+this.anchorOffsetX,a-this.y+this.anchorOffsetY,r-this.x+this.anchorOffsetX,s-this.y+this.anchorOffsetY)},r.cubicCurveTo=function(t,n,i,a,r,s,o,l){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),r=e.eval_e(r),s=e.eval_e(s),o=e.eval_e(o),l=e.eval_e(l),this.container.graphics.moveTo(t-this.x+this.anchorOffsetX,n-this.y+this.anchorOffsetY),this.container.graphics.cubicCurveTo(i-this.x+this.anchorOffsetX,a-this.y+this.anchorOffsetY,r-this.x+this.anchorOffsetX,s-this.y+this.anchorOffsetY,o-this.x+this.anchorOffsetX,l-this.y+this.anchorOffsetY)},r.onResourceLoaded=function(e){return{instances:[this],status:!0}},r.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i},r.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);return e.url=this.url,e},r.loadFromJSON=function(e){e&&(this.url=e.url,t.prototype.loadFromJSON.call(this,e))},r.clone=function(){var e=t.prototype.clone.call(this);return e.url=this.url,e},n}(e.AIDisplayObject);e.AISprite=t,egret.registerClass(t,"ls.AISprite");var n=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnResourceLoadedEvent=n,egret.registerClass(n,"ls.OnResourceLoadedEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){if(t.call(this),this._heading=0,this._lastUpdate=0,this._lastTime=0,this.SHAKE_THRESHOLD=1e3,this.isShakeble=!0,this.minimumFramerate=30,this.disableDataEvents={},this.lastRegex="",this.lastFlags="",this.loadStorages={},this.saveStorages={},null!=n._instance)throw new Error("AISystem 为单例！！！");this.name="System",n._instance=this,this.onDevice(),this.onGetGeolocation(),this.onDeviceMotion()}__extends(n,t);var i=__define,a=n,r=a.prototype;return r.onDevice=function(){egret.DeviceOrientation&&(this._orientation=new egret.DeviceOrientation,this._orientation.addEventListener(egret.OrientationEvent.CHANGE,this.onOrientation,this))},r.onOrientation=function(t){this._alpha=t.alpha,this._beta=t.beta,this._gamma=t.gamma,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDeviceOrientationChanged))},r.onGetGeolocation=function(){egret.Geolocation&&(this._gps=new egret.Geolocation,this._gps.addEventListener(egret.GeolocationEvent.CHANGE,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.PERMISSION_DENIED,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.UNAVAILABLE,this.onGeolocation,this))},r.onGeolocation=function(t){switch(t.type){case egret.GeolocationEvent.CHANGE:this._latitude=t.latitude,this._longitude=t.longitude,this._altitude=t.altitude,this._speed=t.speed,this._heading=t.heading,this._accuracy=t.accuracy,this._altitudeAccuracy=t.altitudeAccuracy,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDevicePostionChanged));break;case egret.GeolocationEvent.PERMISSION_DENIED:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationPermissionDenied));break;default:this._geolocationErrorMessage=t.errorMessage,this._geolocationErrorType=t.errorType,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationFail))}},r.onDeviceMotion=function(){window.DeviceMotionEvent&&window.addEventListener("devicemotion",this.ondeviceMotionHandler,!1)},r.ondeviceMotionHandler=function(t){var i=n.instance;i._curTime=egret.getTimer();var a=i._curTime-i._lastUpdate;if(a>100){var r=t.accelerationIncludingGravity;i._lastUpdate=i._curTime,i._x=r.x,i._y=r.y,i._z=r.z;var s=Math.abs(i._x+i._y+i._z-i._lastX-i._lastY-i._lastZ)/a*1e4;s>i.SHAKE_THRESHOLD&&i._curTime-i._lastTime>1100&&i.isShakeble&&(i._lastTime=i._curTime,i.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,i.onDeviceShake))),i._lastX=i._x,i._lastY=i._y,i._lastZ=i._z}},i(n,"instance",function(){return null==this._instance&&(this._instance=new n),this._instance}),r.sendSceneInitComplete=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneInitComplete))},r.runOs=function(t){var n=e.eval_e(t.os);return{instances:[this],status:n==egret.Capabilities.os}},r.isMobile=function(t){return{instances:[this],status:e.eval_e(t.mobile)==egret.Capabilities.isMobile}},r.onRunTimeType=function(t){return{instances:[this],status:e.eval_e(t.runtimeType)==egret.Capabilities.runtimeType}},r.runLanguageType=function(t){return{instances:[this],status:e.eval_e(t.language)==egret.Capabilities.language}},r.onGeolocationPermissionDenied=function(e){return{instances:[this],status:!0}},r.onGeolocationFail=function(e){return{instances:[this],status:!0}},r.onDeviceShake=function(e){return{instances:[this],status:!0}},r.onDevicePostionChanged=function(e){return{instances:[this],status:!0}},r.onDeviceOrientationChanged=function(e){return{instances:[this],status:!0}},r.onGameDataLoadComplete=function(e){return{instances:[this],status:e.getStatus("key")}},r.onGameDataSaveComplete=function(e){return{instances:[this],status:e.getStatus("key")}},r.everyTick=function(e){return{instances:[this],status:!0}},r.everyXSecondEvent=function(t){return t.curTime=egret.getTimer(),t.curTime-t.oldTime>=1e3*e.eval_e(t.interval)?(t.oldTime=t.curTime,{instances:[this],status:!0}):{instances:[this],status:!1}},r.onSceneInitComplete=function(e){return{instances:[this],status:!0}},r.onSceneEndComplete=function(e){return{instances:[this],status:!0}},r.isValueType=function(e){return{instances:[this],status:!0}},r.objectUIDExist=function(t){return{instances:[this],status:null!=e.LayoutDecoder.curSceneInstances[e.eval_e(t.UID)]}},r.testRegex=function(t){var n=e.eval_e(t.str);n+="";var i=t.regex,a=t.flags;return this.cacheRegex&&i==this.lastRegex&&a==this.lastFlags||(this.cacheRegex=new RegExp(i,a),this.lastRegex=i,this.lastFlags=a),this.cacheRegex.lastIndex=0,{instances:[this],status:this.cacheRegex.test(n)}},r.pickRandomInstance=function(t){var n=e.World.getInstance().objectHash[t.object.name],i=n[Math.floor(Math.random()*n.length)];return{instances:[i],status:n&&n.length>0,selectSingle:!0}},r.pickAll=function(t){var n=e.World.getInstance().objectHash[t.object.name];return{instances:n,status:!0}},r.pickInstanceByCondition=function(t){var n=[],i=e.World.getInstance().objectHash[t.object.name];if(i)for(var a=0;a<i.length;a++){var r=i[a];window[r.name]=r,e.EventSheetDecoder.decodeConditionProperties(t);var s=e.compare(t.expression,t.operationType,t.value);s&&n.push(r)}return n.length>0?{instances:n,status:!0}:{instances:[this],status:!1}},r.pickInstanceByIndex=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){var i=e.eval_e(t.index);if(i<n.length-1&&i>=0)return{instances:[n[i]],status:!0}}return{instances:[this],status:!1}},r.pickInstanceOverlapping=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){for(var i=[],a=e.eval_e(t.x),r=e.eval_e(t.y),s=0;s<n.length;s++){var o=n[s],l=o.getGlobalBounds();l.contains(a,r)&&i.push(o)}if(i.length>0)return{instances:i,status:!0}}return{instances:[this],status:!1}},r.pickInstanceEvaluate=function(e){return{instances:[this],status:!1}},r.pickInstanceByGUID=function(t){var n=e.LayoutDecoder.curSceneInstances[t.guid];return{instances:[n],status:null!=n}},r.execFor=function(e){return{instances:[this],status:!0,data:e}},r.execForEachSort=function(e){return{instances:[this],status:!0,data:e}},r.compareVariable=function(t){return{instances:[this],status:e.compare(n.instance[t.variable],t.operationType,t.value)}},r.onLayerIsExist=function(t){return{instances:[this],status:null!=e.LayerManager.getLayer(e.eval_e(t.layer))}},r.onLayerIsVisible=function(t){var n=e.LayerManager.getLayer(e.eval_e(t.layer));return n?{instances:[this],status:n.visible==e.eval_e(1==t.isVisible)}:{instances:[this],status:!1}},r.createObject=function(t,n,i,a){var r=e.eval_e(n),s=e.eval_e(i),o=e.eval_e(a);e.assert("number"!=typeof r||"number"!=typeof s||"number"!=typeof o,"AISystem createObject parameter type incorrect!!");var l=t.clone();return l.layer=r,l.x=Math.round(s),l.y=Math.round(o),l.initialize(),l.onCreate(),t.cloneBehavior(l),e.lakeshoreInst()[l.name]=l,e.World.getInstance().addChild(l),[l]},r.gotoScene=function(t){egret.callLater(function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneEndComplete)),e.World.getInstance().destory(),t=t,e.StartUp.onConfigLoad(t)},this)},r.disableEvents=function(t,n){var i,a=e.eval_e(t),r=n+"";if(0!=r.length){i=1==r.length?[r]:r.split(",");for(var s=0;s<i.length;s++){var o=+i[s];1==a?delete this.disableDataEvents[o]:this.disableDataEvents[o]=o}}},r.showLoadingLogo=function(t){var t=e.eval_e(t);e.GameUILayer.stage.addChild(e.GameUILayer.preContainer),e.GameUILayer.preContainer.alpha=1;var n=egret.Tween.get(e.GameUILayer.preContainer);n.wait(1e3*t-250),n.to({alpha:0},250),setTimeout(function(){e.GameUILayer.stage.removeChild(e.GameUILayer.preContainer)},1e3*t)},r.onScenePauseOrPlay=function(t){var t=e.eval_e(t);e.EventSheetDecoder.execScenePauseOrPlay(t)},r.log=function(t){e.log(t)},r.addTo=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject addTo parameter type incorrect!!"),this[t]+=i,this.globalVariables[t]=this[t]},r.setBoolean=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==i,this.globalVariables[t]=this[t]},r.setValue=function(t,n){var i=e.eval_e(n);this[t]=i,this.globalVariables[t]=this[t]},r.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i,this.globalVariables[t]=this[t]},r.toogleBoolean=function(e){this[e]=!this[e],this.globalVariables[e]=this[e]},r.stopLoop=function(){},r.load=function(e){},r.restartScene=function(){e.assert(null==e.LayoutDecoder.currentLayoutName,"current layout name is null!"),this.gotoScene(e.LayoutDecoder.currentLayoutName)},r.resetGlobalVariables=function(){},r.scrollToObject=function(t){var n=t.getFirstPicked();n&&e.World.getInstance().sceneCamera.lookAtChar(n)},r.scrollToPos=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.World.getInstance().sceneCamera.lookAtPoint(new egret.Point(i,a))},r.scrollToXPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtX(n)},r.scrollToYPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtY(n)},r.setLayerAngle=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&i.rotation!=n&&(i.rotation=n)},r.setLayerBgColor=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.bgColor=n,i.graphics.clear(),i.graphics.beginFill(n),i.graphics.drawRect(0,0,i.scaleX*e.LayoutDecoder.sceneWidth,i.scaleY*e.LayoutDecoder.sceneHeight),i.graphics.endFill())},r.setLayerBgColorAlpha=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.graphics.clear(),i.graphics.beginFill(i.bgColor,n),i.graphics.drawRect(0,0,i.scaleX*e.LayoutDecoder.sceneWidth,i.scaleY*e.LayoutDecoder.sceneHeight),i.graphics.endFill())},r.setLayerAlpha=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.alpha=n)},r.setLayerParallax=function(t,n,i){for(var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.World.getInstance().objectList,r=0,s=a.length;s>r;r++){var o=a[r];o.index==t&&(o.parallaxX=n,o.parallaxY=i)}var l=e.LayerManager.getLayer(t);l&&(l.parallaxX=n,l.parallaxY=i)},r.setLayerScale=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.LayerManager.getLayer(t);a&&(a.scaleX!=n||a.scaleY!=i)&&(a.scaleX=n,a.scaleY=i)},r.setLayerVisible=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.visible=1==n)},r.setObjectTimeScale=function(t,n){if(t){n=e.eval_e(n),0>n&&(n=0);for(var i=e.World.getInstance().objectHash[t.name],a=0;a<i.length;a++)i[a].timeScale=n}},r.setTimeScale=function(t){e.EventSheetDecoder.timeScale=e.eval_e(t),e.EventSheetDecoder.timeScale<0&&(e.EventSheetDecoder.timeScale=0)},r.startDeviceOrientation=function(t){var n=e.eval_e(t);this._orientation&&(0==n?this._orientation.stop():this._orientation.start())},r.startDeviceGeolocation=function(t){var n=e.eval_e(t);this._gps&&(0==n?this._gps.stop():this._gps.start())},r.onLoadComplete=function(){},r.loadStorageFromJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t);this.loadStorages[t]=!1;var n=localStorage.getItem(t);if(void 0!=n&&null!=n){var i=JSON.parse(n),a=e.World.getInstance().objectList;for(var r in i){for(var s=i[r],o=null,l=0;l<a.length;l++){var c=a[l];if(c.u_id==parseFloat(r)){o=c;break}}if(o)o.loadFromJSON(s);else if(s.plugin){var h=s.plugin.slice(3),u=e.getInstanceByPluginClassName(h);u.loadFromJSON(s),u.initialize(),u.onCreate(),e.World.getInstance().addChild(u),e.registerObject(u.name,u);for(var l=0;l<e.EventSheetDecoder.curSceneEvents.length;l++)for(var v=e.EventSheetDecoder.curSceneEvents[l],f=0;f<v.conditionBlocks.length;f++)for(var d=v.conditionBlocks[f],g=0;g<d.conditions.length;g++){var p=d.conditions[g];p.callTarget instanceof e.AIObject&&p.callTarget.u_id==u.u_id&&(p.callTarget=u,d.cs&&d.cs.instanceStatus&&d.cs.instanceStatus[u.u_id]&&(d.cs.instanceStatus[u.u_id].instance=u))}}}for(var y=[],l=0;l<a.length;l++){var c=a[l];void 0==i[c.u_id]&&y.push(c)}for(var l=0;l<y.length;l++)e.World.getInstance().removeChild(y[l]),y[l].destory();y=[];var _=i.globalVariables;for(var m in _)this[m]=_[m];console.log("加载存档完毕！！"),this.loadStorages[t]=!0,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataLoadComplete,{key:t}))}},r.saveStorageToJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t);this.saveStorages[t]=!1;var n={},i=e.World.getInstance().objectList;if(i)for(var a=0;a<i.length;a++){var r=i[a];n[r.u_id]=r.saveToJSON()}n.globalVariables=this.globalVariables;var s=JSON.stringify(n);localStorage.setItem(t,s),console.log("保存存档完毕！！"),console.log(s),this.saveStorages[t]=!0,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataSaveComplete,{key:t}))},r.destory=function(){},i(r,"alpha",function(){return this._alpha}),i(r,"beta",function(){return this._beta}),i(r,"gamma",function(){return this._gamma}),i(r,"latitude",function(){return this._latitude
}),i(r,"longitude",function(){return this._longitude}),i(r,"altitude",function(){return this._altitude}),i(r,"speed",function(){return this._speed}),i(r,"heading",function(){return this._heading}),i(r,"accuracy",function(){return this._accuracy}),i(r,"altitudeAccuracy",function(){return this._altitudeAccuracy}),i(r,"geolocationErrorMessage",function(){return this._geolocationErrorMessage}),i(r,"geolocationErrorType",function(){return this._geolocationErrorType}),r.layerX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.x},r.layerY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.y},r.layerAngle=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.rotation},r.layerAlpha=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.alpha},r.layerVisible=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.visible},r.layerAnchorOffsetX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.anchorOffsetX},r.layerAnchorOffsetY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.anchorOffsetY},r.layerWidth=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.width},r.layerHeight=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.height},r.layerScaleX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.scaleX},r.layerScaleY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.scaleY},r.layerParallaxX=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.parallaxX},r.layerParallaxY=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);return n.parallaxY},n}(e.AIObject);e.AISystem=t,egret.registerClass(t,"ls.AISystem");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RunOsEvent=n,egret.registerClass(n,"ls.RunOsEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsMobileEvent=i,egret.registerClass(i,"ls.IsMobileEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RuntimeTypeEvent=a,egret.registerClass(a,"ls.RuntimeTypeEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RunLanguageEvent=r,egret.registerClass(r,"ls.RunLanguageEvent");var s=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGeolocationPermissionDeniedEvent=s,egret.registerClass(s,"ls.OnGeolocationPermissionDeniedEvent");var o=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGeolocationFailEvent=o,egret.registerClass(o,"ls.OnGeolocationFailEvent");var l=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDeviceShakeEvent=l,egret.registerClass(l,"ls.OnDeviceShakeEvent");var c=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDevicePositionChangedEvent=c,egret.registerClass(c,"ls.OnDevicePositionChangedEvent");var h=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.onDeviceOrientationChangedEvent=h,egret.registerClass(h,"ls.onDeviceOrientationChangedEvent");var u=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.EveryTickEvent=u,egret.registerClass(u,"ls.EveryTickEvent");var v=function(e){function t(){e.call(this),this.interval=0,this.oldTime=0,this.curTime=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.EveryXSecondsEvent=v,egret.registerClass(v,"ls.EveryXSecondsEvent");var f=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.TestRegexEvent=f,egret.registerClass(f,"ls.TestRegexEvent");var d=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnSceneInitCompleteEvent=d,egret.registerClass(d,"ls.OnSceneInitCompleteEvent");var g=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnSceneEndCompleteEvent=g,egret.registerClass(g,"ls.OnSceneEndCompleteEvent");var p=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsValueTypeEvent=p,egret.registerClass(p,"ls.IsValueTypeEvent");var y=function(e){function t(){e.call(this),this.UID=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ObjectUIDExistEvent=y,egret.registerClass(y,"ls.ObjectUIDExistEvent");var _=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickRandomInstanceEvent=_,egret.registerClass(_,"ls.PickRandomInstanceEvent");var m=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickAllEvent=m,egret.registerClass(m,"ls.PickAllEvent");var b=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickByComparisionEvent=b,egret.registerClass(b,"ls.PickByComparisionEvent");var x=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanceByIndexEvent=x,egret.registerClass(x,"ls.PickInstanceByIndexEvent");var C=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanecOverlappingEvent=C,egret.registerClass(C,"ls.PickInstanecOverlappingEvent");var E=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanceEvaluateEvent=E,egret.registerClass(E,"ls.PickInstanceEvaluateEvent");var I=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanceByGUIDEvent=I,egret.registerClass(I,"ls.PickInstanceByGUIDEvent");var S=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareVariableEvent=S,egret.registerClass(S,"ls.CompareVariableEvent");var T=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ForEachOrderEvent=T,egret.registerClass(T,"ls.ForEachOrderEvent");var O=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ForEvent=O,egret.registerClass(O,"ls.ForEvent");var D=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGameDataLoadCompleteEvent=D,egret.registerClass(D,"ls.OnGameDataLoadCompleteEvent");var w=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGameDataSaveCompleteEvent=w,egret.registerClass(w,"ls.OnGameDataSaveCompleteEvent");var L=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnLayerIsExistEvent=L,egret.registerClass(L,"ls.OnLayerIsExistEvent");var A=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnLayerIsVisibleEvent=A,egret.registerClass(A,"ls.OnLayerIsVisibleEvent")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.register=function(t){t.addEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeTrigger=function(t){t.removeEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeAllTriggers=function(){for(var t=0,n=e.World.getInstance().objectList.length;n>t;t++)this.removeTrigger(e.World.getInstance().objectList[t])},t.setConditionStatus=function(t,n,i,a){void 0===i&&(i=null),void 0===a&&(a=null),void 0==t.triggerfilters&&(t.triggerfilters={}),t.triggerfilters[n.u_id]=n,t.triggerStatus=!0,t.triggerData=i,t.triggerChangeValue=a,e.EventSheetDecoder.run||e.EventSheetDecoder.execScenePauseOrPlay(1)},t.onTrigger=function(t){for(var n=(e.AISystem.instance.disableDataEvents,e.EventSheetDecoder.triggerConditions),i=t.currentTarget,a=i instanceof e.BaseBehavior,r=t.triggerData,s=0,o=n.length;o>s;s++){var l=n[s];if(l.event.enabled){if(l.callCondition!=t.triggerCondition)continue;if(l.isFamily)if(a){var c=e.EventSheetDecoder.curFamilys[l.targetName].insts;if(c)for(var h=0,u=c.length;u>h;h++)for(var v=c[h],f=v.name,d=e.World.getInstance().objectHash[f],g=0,p=d.length;p>g;g++){var y=d[g];this.getCollsionStatus(l,r)&&this.compareParam(l,r)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,r.object,r,t.changeValue),this.setConditionStatus(l,y,r,t.changeValue))}}else{var _=null,c=e.EventSheetDecoder.curFamilys[l.targetName].insts;if(c){for(var h=0,u=c.length;u>h;h++)for(var v=c[h],f=v.name,d=e.World.getInstance().objectHash[f],g=0,p=d.length;p>g;g++){var y=d[g];if(y.u_id==i.u_id){_=y;break}}this.getCollsionStatus(l,r)&&this.compareParam(l,r)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,r.object,r,t.changeValue),_&&this.setConditionStatus(l,_,r,t.changeValue))}else e.assert(!0,"组触发条件目标查找失败,组名："+l.targetName)}else if(a)l.callTarget.name==i.name&&l.targetName==i.inst.name&&this.getCollsionStatus(l,r)&&this.compareParam(l,r)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,r.object,r,t.changeValue),this.setConditionStatus(l,i.inst,r,t.changeValue));else{var _=null;l.targetName==i.name&&(_=i),_&&this.getCollsionStatus(l,r)&&this.compareParam(l,r)&&("onCollisionWithOtherObject"===l.callConditionName&&this.setConditionStatus(l,r.object,r,t.changeValue),this.setConditionStatus(l,_,r,t.changeValue))}}}},t.compareParam=function(t,n){var i=!1;if(n)for(var a=t.paramsInstance.data,r=0,s=a.children.length;s>r;r++){var o=e.eval_e(decodeURIComponent(a.children[r].attributes.value));for(var l in n){var c=n[l];if(c instanceof e.AIObject&&o instanceof e.AIObject){if(c.name==o.name){i=!0;break}}else if(c==o){i=!0;break}}if(i)break}else i=!0;return i},t.getCollsionStatus=function(t,n){if("onCollisionWithOtherObject"===t.callConditionName&&n){var i=t.paramsInstance,a=i.data,r=a.children,s=!1;if(r&&r.length>0)for(var o=0;o<r.length;o++){var l=r[o];if(n.object.name===e.eval_e(decodeURIComponent(l.attributes.value)).name){s=!0;break}}if(!s)return!1}return!0},t}();e.Trigger=t,egret.registerClass(t,"ls.Trigger")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=__define,i=t;i.prototype;return n(t,"nativeBase64",function(){return"function"==typeof window.atob}),t.decode=function(e){if(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),this.nativeBase64&&window.atob)return window.atob(e);for(var t,n,i,a,r,s,o,l=[],c=0;c<e.length;)a=this._keyStr.indexOf(e.charAt(c++)),r=this._keyStr.indexOf(e.charAt(c++)),s=this._keyStr.indexOf(e.charAt(c++)),o=this._keyStr.indexOf(e.charAt(c++)),t=a<<2|r>>4,n=(15&r)<<4|s>>2,i=(3&s)<<6|o,l.push(String.fromCharCode(t)),64!==s&&l.push(String.fromCharCode(n)),64!==o&&l.push(String.fromCharCode(i));return l=l.join("")},t.encode=function(e){if(e=e.replace(/\r\n/g,"\n"),!this.nativeBase64||!window.btoa){for(var t,n,i,a,r,s,o,l=[],c=0;c<e.length;)t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),a=t>>2,r=(3&t)<<4|n>>4,s=(15&n)<<2|i>>6,o=63&i,isNaN(n)?s=o=64:isNaN(i)&&(o=64),l.push(this._keyStr.charAt(a)),l.push(this._keyStr.charAt(r)),l.push(this._keyStr.charAt(s)),l.push(this._keyStr.charAt(o));return l=l.join("")}window.btoa(e)},t.decodeBase64AsArray=function(e,n){n=n||1;var i,a,r,s=t.decode(e),o=new Uint32Array(s.length/n);for(i=0,r=s.length/n;r>i;i++)for(o[i]=0,a=n-1;a>=0;--a)o[i]+=s.charCodeAt(i*n+a)<<(a<<3);return o},t.decompress=function(t,n,i){e.assert(!0,"GZIP/ZLIB compressed TMX Tile Map not supported!")},t.decodeCSV=function(e){for(var t=e.replace("\n","").trim().split(","),n=[],i=0;i<t.length;i++)n.push(+t[i]);return n},t._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t}();e.Base64=t,egret.registerClass(t,"ls.Base64")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.isCollision=function(e,t,n,i,a,r){return e>=n&&n+a>=e&&t>=i&&i+r>=t},t.isCollsionWithRect=function(e,t,n,i,a,r,s,o){return e>=a&&e>=a+s?!1:a>=e&&a>=e+n?!1:t>=r&&t>=r+o?!1:r>=t&&r>=t+i?!1:!0},t.isCollisionPointWithCircle=function(e,t,n,i,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-i,2))<=a},t.isCollisionCircleWithCircle=function(e,t,n,i,a,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-i,2))<=a+r},t.isCollisionRectWithCircle=function(e,t,n,i,a,r,s){var o=.5*n,l=.5*i,c=a-(e+o),h=r-(t+l),u=Math.min(c,o),v=Math.max(u,-o),f=Math.min(h,l),d=Math.max(f,-l);return s*s>=(v-c)*(v-c)+(d-h)*(d-h)},t.checkPointCollideShape=function(e,t,n){var i=n.length;if(3>i)return!1;var a=0,r=[];for(a=0;a<n.length;a++){var s=new egret.Point(n[a].x,n[a].y);r.push(s)}for(a=0;a<r.length;a++)r[a].x+=t.x,r[a].y+=t.y;if(this.vectorCrossPoint(r[0],e,r[1])>0)return!1;if(this.vectorCrossPoint(r[0],e,r[i-1])<0)return!1;a=2;for(var o=i-1,l=-1;o>=a;){var c=a+o>>1;this.vectorCrossPoint(r[0],e,r[c])>0?(l=c,o=c-1):a=c+1}return 0>l?!1:this.vectorCrossPoint(r[l-1],e,r[l])<0},t.vectorCrossPoint=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},t.hitTest=function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<t.length;i++){var a=e[n],r=t[i];if(this.simpleLineTest(a,r))return!0}return!1},t.simpleLineTest=function(e,t){var n=e.p1x,i=e.p1y,a=e.p2x,r=e.p2y,s=t.p1x,o=t.p1y,l=t.p2x,c=t.p2y,h=(a-n)*(o-i)-(s-n)*(r-i),u=(a-n)*(c-i)-(l-n)*(r-i),v=(l-s)*(i-o)-(n-s)*(c-o),f=(l-s)*(r-o)-(a-s)*(c-o);return 0>=h*u&&0>=v*f},t.intersects_rect=function(e,t){return!(t.right<e.left||t.bottom<e.top||t.left>e.right||t.top>e.bottom)},t.segments_intersect=function(e,t,n,i,a,r,s,o){var l,c,h,u,v,f,d,g;if(n>e?(c=e,l=n):(c=n,l=e),s>a?(f=a,v=s):(f=s,v=a),f>l||c>v)return!1;if(i>t?(u=t,h=i):(u=i,h=t),o>r?(g=r,d=o):(g=o,d=r),g>h||u>d)return!1;var p=a-e+s-n,y=r-t+o-i,_=n-e,m=i-t,b=s-a,x=o-r,C=Math.abs(m*b-x*_),E=b*y-x*p;if(Math.abs(E)>C)return!1;var I=_*y-m*p;return Math.abs(I)<=C},t.testOverlap=function(t,n){if(!t||!n||t===n)return!1;var i=!1;return t.pushoutSolid&&(i=!0,!n.customSolidEnabled)?!1:n.pushoutSolid&&(i=!0,!t.customSolidEnabled)?!1:(t.jumpthruEnabled||t.platformEnabled||t.collision||t.solidEnabeld)&&(n.jumpthruEnabled||n.platformEnabled||n.collision||n.solidEnabeld)?e.Collision.checkCollision(t,n):!1},t.getLines=function(t){var n=e.MathUtils.toRadian(t.angle),i=new egret.Matrix;i.translate(-t.width/2,-t.height/2),i.rotate(n);var a=new egret.Matrix;a.translate(t.width/2,-t.height/2),a.rotate(n);var r=new egret.Matrix;r.translate(t.width/2,t.height/2),r.rotate(n);var s=new egret.Matrix;s.translate(-t.width/2,t.height/2),s.rotate(n);var o=[],l={p1x:i.tx+t.x,p1y:i.ty+t.y,p2x:a.tx+t.x,p2y:a.tx+t.y},c={p1x:a.tx+t.x,p1y:a.ty+t.y,p2x:r.tx+t.x,p2y:r.ty+t.y},h={p1x:r.tx+t.x,p1y:r.ty+t.y,p2x:s.tx+t.x,p2y:s.ty+t.y},u={p1x:s.tx+t.x,p1y:s.ty+t.y,p2x:i.tx+t.x,p2y:i.ty+t.y};return o.push(l,c,h,u),o},t.getSolidCollisionCandidates=function(e,t,n){},t.testOverlapSolid=function(t){for(var n=e.World.getInstance().objectList,i=0;i<n.length;i++){var a=n[i];if(a!=t){var r=!1;if(a.solidEnabeld&&(r=!0),t.pushoutSolid&&void 0!==a.customSolidEnabled&&a.customSolidEnabled&&(r=!0),r&&this.testOverlap(t,a))return a}}return null},t.testOverlapJumpThru=function(t,n){void 0===n&&(n=!1);var i=e.World.getInstance().objectList,a=null;n&&(a=[]);for(var r=0,s=i.length;s>r;r++){var o=i[r];if(o.jumpthruEnabled&&this.testOverlap(t,o)){if(!n)return[o];a.push(o)}}return a},t.pushInFractional=function(e,t,n,i,a){for(var r,s=2,o=!1,l=!1,c=e.x,h=e.y;a>=s;)r=1/s,s*=2,e.x+=t*r*(o?1:-1),e.y+=n*r*(o?1:-1),this.testOverlap(e,i)?(o=!0,l=!0):(o=!1,l=!1,c=e.x,h=e.y);l&&(e.x=c,e.y=h)},t.pushOutSolid=function(e,t,n,i,a,r){void 0===i&&(i=0),void 0===a&&(a=!1),void 0===r&&(r=null);for(var s=i||50,o=e.x,l=e.y,c=null,h=null,u=0;s>u;u++){e.x=o+t*u,e.y=l+n*u;var v=this.testOverlap(e,c);if(!v)if(c=this.testOverlapSolid(e))h=c;else if(a&&(c=r?this.testOverlap(e,r)?r:null:this.testOverlapJumpThru(e),c&&(h=c)),!c)return h&&this.pushInFractional(e,t,n,h,16),!0}return e.x=o,e.y=l,!1},t.pushOutSolidNearest=function(t,n){void 0===n&&(n=100);var i=e.is_undefined(i)?100:i,a=0,r=t.x,s=t.y,o=0,l=0,c=0,h=this.testOverlapSolid(t);if(!h)return!0;for(;i>=a;){switch(o){case 0:l=0,c=-1,a++;break;case 1:l=1,c=-1;break;case 2:l=1,c=0;break;case 3:l=1,c=1;break;case 4:l=0,c=1;break;case 5:l=-1,c=1;break;case 6:l=-1,c=0;break;case 7:l=-1,c=-1}if(o=(o+1)%8,t.x=Math.floor(r+l*a),t.y=Math.floor(s+c*a),!this.testOverlap(t,h)&&(h=this.testOverlapSolid(t),!h))return!0}return t.x=r,t.y=s,!1},t.calculateSolidBounceAngle=function(t,n,i,a){void 0===a&&(a=null);var r=t.x,s=t.y,o=Math.max(10,e.distance(n,i,r,s)),l=e.MathUtils.radianTo(n,i,r,s),c=a||this.testOverlapSolid(t);if(!c)return e.MathUtils.clampRadian(l+Math.PI);var h,u,v,f,d=c,g=e.MathUtils.toRadian(5);for(h=1;36>h;h++)if(u=l-h*g,t.x=n+Math.cos(u)*o,t.y=i+Math.sin(u)*o,!this.testOverlap(t,d)&&(d=a?null:this.testOverlapSolid(t),!d)){v=u;break}36===h&&(v=e.MathUtils.clampRadian(l+Math.PI));var d=c;for(h=1;36>h;h++)if(u=l+h*g,t.x=n+Math.cos(u)*o,t.y=i+Math.sin(u)*o,!this.testOverlap(t,d)&&(d=a?null:this.testOverlapSolid(t),!d)){f=u;break}if(36===h&&(f=e.MathUtils.clampRadian(l+Math.PI)),t.x=r,t.y=s,f===v)return f;var p,y=e.MathUtils.angleDiff(f,v)/2;p=e.MathUtils.angleClockWise(f,v)?e.MathUtils.clampRadian(v+y+Math.PI):e.MathUtils.clampRadian(f+y);var _=Math.cos(l),m=Math.sin(l),b=Math.cos(p),x=Math.sin(p),C=_*b+m*x,E=_-2*C*b,I=m-2*C*x;return e.MathUtils.radianTo(0,0,E,I)},t}();e.CollisionUtils=t,egret.registerClass(t,"ls.CollisionUtils")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.toRadian=function(e){return e*this.TO_RADIAN},e.toAngle=function(e){return e*this.TO_ANGLE},e.clampAngle=function(e){return e%=360,0>e&&(e+=360),e},e.clampRadian=function(e){return e%=2*Math.PI,0>e&&(e+=2*Math.PI),e},e.angleRotate=function(t,n,i){var a=this.toRadian(t),r=this.toRadian(n);return e.toAngle(this.angleRadius(a,r,i))},e.angleRadius=function(e,t,n){var i=Math.sin(e),a=Math.cos(e),r=Math.sin(t),s=Math.cos(t);return Math.acos(i*r+a*s)>n?a*r-i*s>0?this.clampRadian(e+n):this.clampRadian(e-n):this.clampRadian(t)},e.angleClockWise=function(e,t){var n=Math.sin(e),i=Math.cos(e),a=Math.sin(t),r=Math.cos(t);return 0>=i*a-n*r},e.angleTo=function(e,t,n,i){return this.toAngle(Math.atan2(i-t,n-e))},e.radianTo=function(e,t,n,i){return Math.atan2(i-t,n-e)},e.distance=function(e,t,n,i){var a=n-e,r=i-t;return Math.sqrt(a*a+r*r)},e.color16ToUnit=function(e){var t="0x"+e.slice(1);return parseInt(t,16)},e.angleDiff=function(e,t){if(e===t)return 0;var n=Math.sin(e),i=Math.cos(e),a=Math.sin(t),r=Math.cos(t),s=n*a+i*r;return s>=1?0:-1>=s?Math.PI:Math.acos(s)},e.TO_RADIAN=Math.PI/180,e.TO_ANGLE=180/Math.PI,e}();e.MathUtils=t,egret.registerClass(t,"ls.MathUtils")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.compareVersion=function(e,t){var n=e.split("."),i=t.split("."),a=n[0]+"."+n[1];n[2]&&(a+=n[2]);var r=i[0]+"."+i[1];i[2]&&(r+=i[2]);var s=+a,o=+r;return s>o?1:s===o?0:-1},e.version="1.2",e}();e.Version=t,egret.registerClass(t,"ls.Version")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.execute=function(e){this.stage=e.stage,this.onLayerInit(e),this.onPreResourceLoad()},t.onLayerInit=function(t){e.GameUILayer.init(t.stage),e.GameUILayer.document=t},t.onPreResourceLoad=function(){var n=e.ResCache.configResouces.projects;n&&(this.publish=!0),this.publish?t.loadConfig(n.children):RES.getResByUrl("resource/assets/projects.xml",function(e){t.loadConfig(e.children)},this,RES.ResourceItem.TYPE_XML)},t.loadConfig=function(n){var i=n;if(i){for(var a=0;a<i.length;a++){var r=i[a],s=r.localName,o=r.attributes;if("internal"===s){var l=r.children[0].text,c=JSON.parse(decodeURIComponent(l));e.internalData=c.internalComponents}}for(var a=0;a<i.length;a++){var r=i[a],s=r.localName,o=r.attributes;switch(s){case"sceneSize":e.Config.sceneWidth=+o.width,e.Config.sceneHeight=+o.height,e.Config.openLog=1==+o.openLog;break;case"info":if(t.baseUrl=o.baseUrl,e.Config.sceneInfo={layoutName:o.layoutName,layoutUrl:o.layoutUrl,eventsheetName:o.eventsheetName,eventsheetUrl:o.eventsheetUrl,baseUrl:t.baseUrl},this.publish)this.globalData=e.ResCache.configResouces.global,e.LayoutDecoder.globalInstances=e.LayoutDecoder.decodeInstances(this.globalData),e.Config.sceneInfo.layoutData=e.ResCache.configResouces[e.Config.sceneInfo.layoutName],e.Config.sceneInfo.eventsheetData=e.ResCache.configResouces[e.Config.sceneInfo.eventsheetName],e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName);else{var h=this;h.onGlobalConfigLoad(e.Config.sceneInfo.baseUrl+"global.xml",function(){RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},e.Config.sceneInfo)},[e.Config.sceneInfo.layoutName])}break;case"version":e.Config.version=+r.text}}}},t.onGlobalConfigLoad=function(t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),RES.getResByUrl(t,function(t){this.globalData=t,e.LayoutDecoder.globalInstances=e.LayoutDecoder.decodeInstances(this.globalData),null!=n&&n.apply(null,i)},this,RES.ResourceItem.TYPE_XML)},t.onConfigLoad=function(t){e.Config.sceneInfo.layoutName=t,e.Config.sceneInfo.layoutUrl=t+".xml",this.publish?(e.Config.sceneInfo.layoutData=e.ResCache.configResouces[e.Config.sceneInfo.layoutName],e.Config.sceneInfo.eventsheetName=e.Config.sceneInfo.layoutData.attributes.eventSheet,e.Config.sceneInfo.eventsheetData=e.ResCache.configResouces[e.Config.sceneInfo.layoutData.attributes.eventSheet],e.Config.sceneInfo.eventsheetUrl=e.Config.sceneInfo.layoutData.attributes.eventSheet+".xml",e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)):RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,e.Config.sceneInfo.eventsheetName=t.attributes.eventSheet,e.Config.sceneInfo.eventsheetUrl=e.Config.sceneInfo.eventsheetName+".xml",RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},this)},t.publish=!1,t}();e.StartUp=t,egret.registerClass(t,"ls.StartUp")}(ls||(ls={}));