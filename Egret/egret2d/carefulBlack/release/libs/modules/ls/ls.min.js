var ls;!function(e){var t=function(e){function t(){e.call(this),this._sid=0,t.UID++,this._sid=t.UID}__extends(t,e);var n=__define,i=t,a=i.prototype;return n(a,"sid",function(){return this._sid}),n(a,"className",function(){return egret.getQualifiedClassName(this)}),a.getClass=function(){return this.constructor},a.clone=function(){var e=this.getClass();return new e},t.UID=0,t}(egret.EventDispatcher);e.BaseClass=t,egret.registerClass(t,"ls.BaseClass")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.loopSelections=t,egret.registerClass(t,"ls.loopSelections");var n=function(e){function t(){e.call(this),this.index=0,this.instances={}}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseClass);e.Action=n,egret.registerClass(n,"ls.Action")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this.enabled=1,this.isCreated=!1,this.renderEnabled=!0,e.Trigger.register(this)}__extends(n,t);var i=(__define,n),a=i.prototype;return a.onCreate=function(){},a.tick=function(){},a.saveToJSON=function(){return{enabled:this.enabled,name:this.name,paramInstances:this.paramInstances}},a.loadFromJSON=function(e){e&&(this.enabled=e.enabled,this.name=e.name,this.paramInstances=e.paramInstances)},a.getClass=function(){return this.constructor},a.destory=function(){},a.clone=function(){var e=this.getClass(),t=new e;return t.name=this.name,t.enabled=this.enabled,t.paramInstances=this.paramInstances,t},n}(egret.EventDispatcher);e.BaseBehavior=t,egret.registerClass(t,"ls.BaseBehavior")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){this.radius=0}var t=(__define,e);t.prototype;return e}();e.Circle=t,egret.registerClass(t,"ls.Circle");var n=function(){function n(){}var i=(__define,n);i.prototype;return n.checkCollision=function(t,n){if(!t||!n||t==n)return!1;if(!t.getBounds().intersects(n.getBounds()))return!1;new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y);return 0==t.collisionType&&0==n.collisionType?this.checkPolygonCollisionPolygon(t,n):1==t.collisionType&&1==n.collisionType?this.checkCircleCollisionCircle(t,n):2==t.collisionType&&2==n.collisionType?this.checkDotCollisionDot(t,n):0==t.collisionType&&1==n.collisionType?this.checkCircleCollisionPolygon(n,t):1==t.collisionType&&0==n.collisionType?this.checkCircleCollisionPolygon(t,n):0==t.collisionType&&2==n.collisionType?this.checkDotCollisionPolygon(n,t):2==t.collisionType&&0==n.collisionType?this.checkDotCollisionPolygon(t,n):1==t.collisionType&&2==n.collisionType?this.checkDotCollisionCircle(n,t):2==t.collisionType&&1==n.collisionType?this.checkDotCollisionCircle(t,n):!1},n.checkPolygonCollisionPolygon=function(t,n){var i=!1;if(0==t.angle&&0==n.angle&&1==t.collisionVectorData.length&&1==n.collisionVectorData.length&&4==t.collisionVectorData[0].length&&4==n.collisionVectorData[0].length)i=this.checkCommonCollision(t,n);else{t.collisionIsRect&&n.collisionIsRect;for(var a=t.getCacheCollisionPolygonData(),s=n.getCacheCollisionPolygonData(),r=0;r<a.length;r++){for(var o=a[r],l=0;l<s.length;l++){var c=s[l];if(i=e.SAT.sat(new e.Vector2D(t.x,t.y),new e.Vector2D(n.x,n.y),o,c))break}if(i)break}}return i},n.isCollsionWithRect=function(e,t,n,i,a,s,r,o){return e>=a&&e>=a+r?!1:a>=e&&a>=e+n?!1:t>=s&&t>=s+o?!1:s>=t&&s>=t+i?!1:!0},n.checkCommonCollision=function(e,t){var n=e.collisionVectorData[0],i=t.collisionVectorData[0],a=n.concat().reverse(),s=i.concat().reverse(),r=a[1].x-a[0].x,o=a[2].y-a[1].y,l=s[1].x-s[0].x,c=s[2].y-s[1].y,h=new egret.Matrix;h.translate(a[0].x-e.anchorOffsetX,a[0].y-e.anchorOffsetY),h.scale(e.scaleX,e.scaleY);var u=e.x+h.tx,v=e.y+h.ty,f=new egret.Matrix;f.translate(s[0].x-t.anchorOffsetX,s[0].y-t.anchorOffsetY),f.scale(t.scaleX,t.scaleY);var g=t.x+f.tx,d=t.y+f.ty;return this.isCollsionWithRect(u,v,r*e.scaleX,o*e.scaleY,g,d,l*t.scaleX,c*t.scaleY)},n.checkDotCollisionDot=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,s=t.angle*Math.PI/180,r=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(s);var l=new egret.Matrix;l.translate(a.x-n.anchorOffsetX,a.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(r);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty);return c.equals(h)},n.checkDotCollisionCircle=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,s=t.angle*Math.PI/180,r=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(s);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(r);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),v=a.radius*n.scale;return v*v>=u},n.checkDotCollisionPolygon=function(t,n){var i=t.collisionVectorData,a=t.angle*Math.PI/180,s=n.angle*Math.PI/180,r=new egret.Matrix;r.translate(i.x-t.anchorOffsetX,i.y-t.anchorOffsetY),r.scale(t.scaleX,t.scaleY),r.rotate(a);var o=new e.Vector2D(t.x+r.tx,t.y+r.ty),l=n.collisionVectorData,c=!1,h=0;if(l){for(var u=0;u<l.length;u++){for(var v=l[u],f=0;f<v.length;f++){var g=v[f],d=(f+1)%v.length,p=new egret.Matrix;p.translate(g.x-n.anchorOffsetX,g.y-n.anchorOffsetY),p.scale(n.scaleX,n.scaleY),p.rotate(s);var y=new egret.Matrix;y.translate(v[d].x-n.anchorOffsetX,v[d].y-n.anchorOffsetY),y.scale(n.scaleX,n.scaleY),y.rotate(s);var _=new e.Vector2D(n.x+p.tx,n.y+p.ty),m=new e.Vector2D(n.x+y.tx,n.y+y.ty);if(_.y!=m.y&&!(o.y<(_.y<m.y?_.y:m.y)||o.y>=(_.y>m.y?_.y:m.y))){var x=(o.y-_.y)*(m.x-_.x)/(m.y-_.y)+_.x;x>o.x&&h++}}c=h%2==1}return c}return!1},n.checkCircleCollisionCircle=function(t,n){var i=t.collisionVectorData,a=n.collisionVectorData,s=t.angle*Math.PI/180,r=n.angle*Math.PI/180,o=new egret.Matrix;o.translate(i.center.x-t.anchorOffsetX,i.center.y-t.anchorOffsetY),o.scale(t.scaleX,t.scaleY),o.rotate(s);var l=new egret.Matrix;l.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),l.scale(n.scaleX,n.scaleY),l.rotate(r);var c=new e.Vector2D(t.x+o.tx,t.y+o.ty),h=new e.Vector2D(n.x+l.tx,n.y+l.ty),u=c.distanceSQ(h),v=i.radius*t.scale,f=a.radius*n.scale;return(v+f)*(v+f)>=u},n.checkCircleCollisionPolygon=function(n,i){var a=n.collisionVectorData,s=n.angle*Math.PI/180,r=i.angle*Math.PI/180,o=a.radius*n.scale,l=!1,c=i.collisionVectorData,h=new egret.Matrix;h.translate(a.center.x-n.anchorOffsetX,a.center.y-n.anchorOffsetY),h.scale(n.scaleX,n.scaleY),h.rotate(s);var u=new e.Vector2D(n.x+h.tx,n.y+h.ty);if(c){for(var v=0;v<c.length;v++){for(var f=c[v],g=0;g<f.length;g++){var d=f[g],p=new egret.Matrix;p.translate(d.x-i.anchorOffsetX,d.y-i.anchorOffsetY),p.scale(i.scaleX,i.scaleY),p.rotate(r);var d=new e.Vector2D(p.tx+i.x,p.ty+i.y);if(u.distanceSQ(d)<=o*o){l=!0;break}var y=(g+1)%f.length,_=new egret.Matrix;_.translate(f[y].x-i.anchorOffsetX,f[y].y-i.anchorOffsetY),_.scale(i.scaleX,i.scaleY),_.rotate(r);var m=new e.Vector2D(i.x+p.tx,i.y+p.ty),x=new e.Vector2D(i.x+_.tx,i.y+_.ty),b=new t;if(b.center=new e.Vector2D(n.x+h.tx,n.y+h.ty),b.radius=a.radius*n.scale,this.circleCollisionLine(b,m,x)){l=!0;break}}if(l)break}return l}return!1},n.circleCollisionLine=function(e,t,n){var i=e.center.x-t.x,a=e.center.y-t.y,s=n.x-t.x,r=n.y-t.y,o=Math.sqrt(s*s+r*r);s/=o,r/=o;var l=i*s+a*r,c=0,h=0;return 0>=l?(c=t.x,h=t.y):l>=o?(c=n.x,h=n.y):(c=t.x+s*l,h=t.y+r*l),(e.center.x-c)*(e.center.x-c)+(e.center.y-h)*(e.center.y-h)<=e.radius*e.radius},n.pointToSegDist=function(e,t,n,i,a,s){var r=(a-n)*(e-n)+(s-i)*(t-i);if(0>=r)return Math.sqrt((e-n)*(e-n)+(t-i)*(t-i));var o=(a-n)*(a-n)+(s-i)*(s-i);if(r>=o)return Math.sqrt((e-a)*(e-a)+(t-s)*(t-s));var l=r/o,c=n+(a-n)*l,h=i+(s-i)*l;return Math.sqrt((e-c)*(e-c)+(h-i)*(h-i))},n.distFromPointToLine=function(e,t,n){var i=n.x-t.x,a=n.y-n.x,s=n.x*t.y-t.x*n.y;return Math.abs(i*e.x+a*e.y+s)/Math.sqrt(i*i+a*a)},n}();e.Collision=n,egret.registerClass(n,"ls.Collision")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){this.tlx=0,this.tly=0,this.trx=0,this.try_=0,this.brx=0,this.bry=0,this.blx=0,this.bly=0,this.minresult=0,this.maxresult=0}var t=(__define,e),n=t.prototype;return n.offset=function(e,t){return this.tlx+=e,this.tly+=t,this.trx+=e,this.try_+=t,this.brx+=e,this.bry+=t,this.blx+=e,this.bly+=t,this},n.set_from_rect=function(e){this.tlx=e.left,this.tly=e.top,this.trx=e.right,this.try_=e.top,this.brx=e.right,this.bry=e.bottom,this.blx=e.left,this.bly=e.bottom},n.set_from_rotated_rect=function(e,t){if(0===t)this.set_from_rect(e);else{var n=Math.sin(t),i=Math.cos(t),a=e.left*n,s=e.top*n,r=e.right*n,o=e.bottom*n,l=e.left*i,c=e.top*i,h=e.right*i,u=e.bottom*i;this.tlx=l-s,this.tly=c+a,this.trx=h-s,this.try_=c+r,this.brx=h-o,this.bry=u+r,this.blx=l-o,this.bly=u+a}},n.midX=function(){return(this.tlx+this.trx+this.brx+this.blx)/4},n.midY=function(){return(this.tly+this.try_+this.bry+this.bly)/4},n.at=function(e,t){if(t)switch(e){case 0:return this.tlx;case 1:return this.trx;case 2:return this.brx;case 3:return this.blx;case 4:return this.tlx;default:return this.tlx}else switch(e){case 0:return this.tly;case 1:return this.try_;case 2:return this.bry;case 3:return this.bly;case 4:return this.tly;default:return this.tly}},n.minmax4=function(e,t,n,i){t>e?i>n?(n>e?this.minresult=e:this.minresult=n,t>i?this.maxresult=t:this.maxresult=i):(i>e?this.minresult=e:this.minresult=i,t>n?this.maxresult=t:this.maxresult=n):i>n?(n>t?this.minresult=t:this.minresult=n,e>i?this.maxresult=e:this.maxresult=i):(i>t?this.minresult=t:this.minresult=i,e>n?this.maxresult=e:this.maxresult=n)},n.bounding_box=function(e){this.minmax4(this.tlx,this.trx,this.brx,this.blx),e.left=this.minresult,e.right=this.maxresult,this.minmax4(this.tly,this.try_,this.bry,this.bly),e.top=this.minresult,e.bottom=this.maxresult},n.contains_pt=function(e,t){var n=this.tlx,i=this.tly,a=this.trx-n,s=this.try_-i,r=this.brx-n,o=this.bry-i,l=e-n,c=t-i,h=a*a+s*s,u=a*r+s*o,v=a*l+s*c,f=r*r+o*o,g=r*l+o*c,d=1/(h*f-u*u),p=(f*v-u*g)*d,y=(h*g-u*v)*d;if(p>=0&&y>0&&1>p+y)return!0;a=this.blx-n,s=this.bly-i;var h=a*a+s*s,u=a*r+s*o,v=a*l+s*c;return d=1/(h*f-u*u),p=(f*v-u*g)*d,y=(h*g-u*v)*d,p>=0&&y>0&&1>p+y},n.segments_intersect=function(e,t,n,i,a,s,r,o){var l,c,h,u,v,f,g,d;if(n>e?(c=e,l=n):(c=n,l=e),r>a?(f=a,v=r):(f=r,v=a),f>l||c>v)return!1;if(i>t?(u=t,h=i):(u=i,h=t),o>s?(d=s,g=o):(d=o,g=s),d>h||u>g)return!1;var p=a-e+r-n,y=s-t+o-i,_=n-e,m=i-t,x=r-a,b=o-s,C=Math.abs(m*x-b*_),E=x*y-b*p;if(Math.abs(E)>C)return!1;var I=_*y-m*p;return Math.abs(I)<=C},n.intersects_segment=function(e,t,n,i){if(this.contains_pt(e,t)||this.contains_pt(n,i))return!0;var a,s,r,o,l;for(l=0;4>l;l++)if(a=this.at(l,!0),s=this.at(l,!1),r=this.at(l+1,!0),o=this.at(l+1,!1),this.segments_intersect(e,t,n,i,a,s,r,o))return!0;return!1},n.intersects_quad=function(e){var t=e.midX(),n=e.midY();if(this.contains_pt(t,n))return!0;if(t=this.midX(),n=this.midY(),e.contains_pt(t,n))return!0;var i,a,s,r,o,l,c,h,u,v;for(u=0;4>u;u++)for(v=0;4>v;v++)if(i=this.at(u,!0),a=this.at(u,!1),s=this.at(u+1,!0),r=this.at(u+1,!1),o=e.at(v,!0),l=e.at(v,!1),c=e.at(v+1,!0),h=e.at(v+1,!1),this.segments_intersect(i,a,s,r,o,l,c,h))return!0;return!1},e}();e.Quad=t,egret.registerClass(t,"ls.Quad")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(e,t,n,i){}var t=(__define,e),n=t.prototype;return n.getTreeBoundInfo=function(e){},e}();e.QuadTree=t,egret.registerClass(t,"ls.QuadTree")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){this.intersectionIndex=-1,this.intersectionPoint=new e.Vector2D}var n=(__define,t),i=n.prototype;return i.getPrevIndex=function(e,t){return(e-1+t)%t},i.getNextIndex=function(e,t){return(e+1)%t},i.isConcavePoly=function(e){return e.length<=3?!1:this.getNextConcaveIndex(e,0)>=0},i.onSeparateConcavePoly=function(e){var t=[];return this.isAntiClockDir(e)||e.reverse(),this.separateConcavePoly(e,t,0),t},i.getNextConcaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return-1;for(var n=e.length,i=n+t,a=t;i>a;a++){var s=this.getPrevIndex(a,n),r=this.getNextIndex(a,n),o=(a+n)%n,l=this.getMultiPtClockDir(e[o],e[s],e[r]);if(1==l)return a%n}return-1},i.getAllConvaveIndex=function(e,t){if(void 0===t&&(t=0),e.length<=3)return[];for(var n=[],i=e.length,a=i+t,s=t;a>s;s++){var r=this.getPrevIndex(s,i),o=this.getNextIndex(s,i),l=(s+i)%i,c=this.getMultiPtClockDir(e[l],e[r],e[o]);1==c&&n.push(s%i)}return n},i.separateConcavePoly=function(e,t,n){if(e.length<=3)return void t.push(e);var i=this.getNextConcaveIndex(e,n);if(n=i+1,0>i)return void t.push(e);if(this.getSplitPointByRgnBCinter(e,i)){var a=[],s=[];return this.splitPolyByIntersection(e,i,a,s),this.separateConcavePoly(a,t,n),void this.separateConcavePoly(s,t,n)}t.push(e)},i.splitPolyByIntersection=function(e,t,n,i){var a=e.length;if(0>t||t>=a)return!1;if(this.intersectionIndex<0||this.intersectionIndex>=a)return!1;if(t<=this.intersectionIndex+1)for(var s=this.intersectionIndex,a=t+a;a>=s;s++)n.push(e[s%a]);else for(var s=this.intersectionIndex;t>=s;s++)n.push(e[s]);if(t<=this.intersectionIndex)for(var s=t;s<this.intersectionIndex;s++)i.push(e[s]);else for(var s=t;s<this.intersectionIndex+a;s++)i.push(e[s%a]);return e[this.intersectionIndex].equals(this.intersectionPoint)||(n.push(this.intersectionPoint),i.push(this.intersectionPoint)),!0},i.getSplitPointByRgnBCinter=function(t,n){if(t.length<=3)return!1;for(var i=t.length,a=(n-1+i)%i,s=(n+1)%i,r=[],o=[],l=[],c=[],h=[],u=[],v=[],f=[],g=a>s?a:a+i,d=s;g>d;d++){var p=d%i,y=this.getMultiPtClockDir(t[n],t[a],t[p]),_=this.getMultiPtClockDir(t[n],t[s],t[p]);0>y&&_>0?r.push(p):y>=0&&_>=0?o.push(p):0>=y&&0>_?l.push(p):c.push(p)}if(h=this.getVisiblePtsOnRegion(t,n,r),u=o.concat(),f=c.concat(),v=this.getVisiblePtsOnRegion(t,n,l),h.length>0){var m=[],x=[];if(this.setSplitByRegion(t,h,m,x),x.length>0?this.intersectionIndex=this.getBestIntersectionPt(t,n,x):this.intersectionIndex=this.getBestIntersectionPt(t,n,m),this.intersectionIndex<0||this.intersectionIndex>=i)return!1}if(u.length<1||v.length<1)return console.error("BC分区为空错误！！"),!1;var b=u[u.length-1],C=v[0],E=new e.Vector2D(t[C].x-t[b].x,t[C].y-t[b].y),I=new e.Vector2D(t[n].x-t[a].x,t[n].y-t[a].y),S=new e.Vector2D(t[n].x-t[s].x,t[n].y-t[s].y),T=new e.Vector2D(I.x+S.x>>1,I.y+S.y>>1),O=new e.Vector2D;return 1!=this.getCrossByRadialAndSegment(t[n],T,t[b],E,O)?!1:(this.intersectionIndex=b,this.intersectionPoint=O,!0)},i.getMultiPtClockDir=function(e,t,n){var i=(e.x-t.x)*(n.y-e.y)-(n.x-e.x)*(e.y-t.y);return i>0?1:0>i?-1:0},i.getMultiPtClockDirByIndex=function(e,t){if(e.length<=2)return 0;var n=e[t%e.length],i=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length];return this.getMultiPtClockDir(n,i,a)},i.isAntiClockDir=function(e){if(e.length<=2)return!0;for(var t=0,n=1,i=e.length;i>n;n++){var a=(n+1)%i,s=(n+2)%i,r=(e[a].x-e[n].x)*(e[s].y-e[a].y);r-=(e[a].y-e[n].y)*(e[s].x-e[a].x),0>r?t--:r>0&&t++}return 0>=t},i.isInsection=function(t,n,i,a){var s=new e.Vector2D(i.x-t.x,i.y-t.y),r=n.x*a.y-n.y*a.x,o=r*r,l=n.x*n.x+n.y*n.y,c=a.x*a.x+a.y*a.y;if(o>.01*l*c){var h=(s.x*a.y-s.y*a.x)/r;if(0>h||h>1)return 0;var u=(s.x*n.y-t.y*n.x)/r;return 0>u||u>1?0:1}return 0},i.isVisiblePtOnConcave=function(e,t,n){for(var i=0,a=e.length;a>i;i++){var s=(i+1)%a;if(i!=t&&i!=n&&s!=t&&s!=n&&this.isInsection(e[t],e[n],e[i],e[s]))return!1}return!0},i.getVisiblePtsOnRegion=function(e,t,n){for(var i=[],a=0,s=n.length;s>a;a++)this.isVisiblePtOnConcave(e,t,n[a])&&i.push(n[a]);return i},i.setSplitByRegion=function(e,t,n,i){for(var a=0,s=e.length;s>a;a++)this.getMultiPtClockDirByIndex(e,t[a])?n.push(t[a]):i.push(t[a])},i.dotProd=function(e,t){return e.dotProd(t)},i.getBestIntersectionPt=function(e,t,n){if(n.length<1)return-1;for(var i=e.length,a=(t-1+i)%i,s=(t+1)%i,r=e[t].clone().substruct(e[a].x,e[a].y).normalize(),o=(e[t].clone().substruct(e[s].x,e[s].y).normalize(),-1),l=-1,c=0,h=n.length;h>c;c++){var u=n[c],v=e[u],f=v.clone().substruct(e[t].x,e[t].y).normalize(),g=r.clone().dotProd(f);g>l&&(o=u)}return o},i.getCrossByRadialAndSegment=function(e,t,n,i,a){var s=n.clone().substruct(e.x,e.y),r=t.getCross(i);if(r*r>.01*t.lengthSQ*i.lengthSQ){var o=s.getCross(i)/r;if(0>o)return 0;var l=s.getCross(t)/r;if(0>l||l>1)return 0;var c=t.clone().scale(o);return a.x=e.x+c.x,a.y=e.y+c.y,1}return 0},i.getPosRelationToLine=function(e,t,n){return n.x*(t.y-e.y)+n.y*(e.x-t.x)+n.y*t.x-n.x*t.y},t}();e.IntersectionStruct=t,egret.registerClass(t,"ls.IntersectionStruct")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.sat=function(e,t,n,i){return n.length<1||i.length<1?!1:this.convexsat(e,t,n,i)},t.convexsat=function(e,t,n,i){if(n.length<1||i.length<2)return!1;var a=[];a=this.getUniqueAxis(n,a),a=this.getUniqueAxis(i,a);for(var s=0,r=a.length;r>s;s++){var o=this.getProjection(e,n,a[s]),l=this.getProjection(t,i,a[s]);if(!this.overlap(o,l))return!1}return!0},t.getUniqueAxis=function(t,n){for(var i,a=!1,i=new e.Vector2D,s=0,r=t.length;r>s;s++){var i=t[(s+1)%r].clone().substruct(t[s].x,t[s].y).normalize().perp;i.x<=0&&(0==i.x?i.y<0&&(i.y*=-1):(i.x*=-1,i.y*=-1)),a=!0;for(var o=0,l=n.length;l>o;o++)if(n[o].equals(i)){a=!1;break}a&&n.push(i)}return n},t.overlap=function(e,t){return e.x>t.y?!1:e.y<t.x?!1:(e.x-t.x)*(t.x-t.y)<0?!0:!0},t.getPolyBound=function(e){if(e.length<1)return[0,0,0,0];for(var t=e[0],n=[t.x,t.y,t.x,t.y],i=0;i<e.length;i++){var a=e[i];a.x<n[0]&&(n[0]=a.x),a.y<n[1]&&(n[1]=a.y),a.x>n[2]&&(n[2]=a.x),a.y>n[3]&&(n[3]=a.y)}return n},t.getCircleBound=function(e){if(2!==e.length)return[0,0,0,0];var t=e[0],n=e[1];return[t.x-n.x,t.y-n.x,t.x+n.x,t.y+n.x]},t.getProjection=function(t,n,i){var a,s,r=0;s=new e.Vector2D(n[0].x+t.x,n[0].y+t.y).dotProd(i),r=s;for(var o=0;o<n.length;o++)a=new e.Vector2D(n[o].x+t.x,n[o].y+t.y).dotProd(i),s>a&&(s=a),a>r&&(r=a);return new e.Vector2D(s,r)},t}();e.SAT=t,egret.registerClass(t,"ls.SAT")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.call(this),this.isTrigger=!1,this.isInvert=!1,this.operatorType=0}__extends(t,e);var n=__define,i=t,a=i.prototype;return n(a,"isFirstCondition",function(){return 0===this.index}),t}(e.BaseClass);e.Condition=t,egret.registerClass(t,"ls.Condition")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){this.status=!1,this.loopDatas=[],this.loopLayers=0}var n=__define,i=t,a=i.prototype;return n(a,"loop",function(){if(null==this.conditions)return!1;for(var e=0;e<this.conditions.length;e++){var t=this.conditions[e];if(t.loop)return!0}return!1}),a.execActions=function(t){if(null!=this.actions){var n=t;this.lastActionResults=[];for(var i=0;i<this.actions.length;i++){var a=this.actions[i];a.lastLoopSelectInstances=[]}if(this.loopDatas&&this.loopDatas.length>0)if(this.loopDatas.length>3)e.assert(!0,"不支持三层以上循环！！！");else{var s=this.loopDatas[0],r=this.loopDatas[1],o=this.loopDatas[2];if(s&&s instanceof e.ForEachOrderEvent&&(n=this.execForEach(s,n)),r&&r instanceof e.ForEachOrderEvent&&(n=this.execForEach(r,n)),o&&o instanceof e.ForEachOrderEvent&&(n=this.execForEach(o,n)),s&&s instanceof e.ForEvent)for(var l=+e.eval_e(s.startIndex),c=+e.eval_e(s.endIndex),h=s.name,i=l;l>=c?i>=c:c>=i;c>=l?i++:i--)if(e.loopIndex[h]=i,r&&r instanceof e.ForEvent)for(var u=+e.eval_e(r.startIndex),v=+e.eval_e(r.endIndex),f=r.name,g=u;u>=v?g>=v:v>=g;v>=u?g++:g--)if(e.loopIndex[f]=g,o&&o instanceof e.ForEvent)for(var d=+e.eval_e(o.startIndex),p=+e.eval_e(o.endIndex),y=o.name,_=d;d>=p?_>=p:p>=_;p>=d?_++:_--)e.loopIndex[y]=_,this.execLoopAction(!0,n,_);else this.execLoopAction(!0,n,g);else this.execLoopAction(!0,n,i);else if(s&&s instanceof e.OnForEachArrayElementEvent){var m=s,x=m.array;if(x){var b=e.eval_e(m.xyzDimention);switch(b){case 1:for(var i=0;i<x.width;i++)x.curX=i,this.execLoopAction(!0,n,i),x.curValue=x.at(i,0,0);break;case 2:for(var i=0;i<x.width;i++)for(var g=0;g<x.height;g++)x.curX=i,x.curY=g,this.execLoopAction(!0,n,i),x.curValue=x.at(i,g,0);break;case 3:for(var i=0;i<x.width;i++)for(var g=0;g<x.height;g++)for(var _=0;_<x.depth;_++)x.curX=i,x.curY=g,x.curZ=_,this.execLoopAction(!0,n,i),x.curValue=x.at(i,g,_);break;default:e.assert(!0,"无法解析当前数组维数："+b)}}}}else this.execLoopAction(!1,n,0)}},a.execForEach=function(t,n){var i=t.object,a=e.eval_e(t.order),s=e.World.getInstance().objectHash[i.name],r=[];if(s){for(var o=0;o<s.length;o++){var l=s[o];this.instancesStatus[l.u_id]&&this.instancesStatus[l.u_id].status&&r.push(l)}for(var c=-1,o=0;o<r.length;o++){var h=r[o].name;if(c=t.expression.indexOf(h),-1!=c)break}-1!=c&&r.sort(function(n,i){e.lakeshoreInst()[n.name]=n;var s=+e.eval_e(t.expression);s=s||0,e.lakeshoreInst()[i.name]=i;var r=+e.eval_e(t.expression);return r=r||0,0===a?s>r?1:r>s?-1:0:s>r?-1:r>s?1:0});for(var o=0;o<n.length;o++){var u=n[o];u.name==i.name&&n.splice(o,1)}n=n.concat(r)}return n},a.execLoopAction=function(e,t,n){void 0===n&&(n=0),this.event.execActionIndex=0,this.actions.length>0&&this.execLoopNextAction(this.actions[this.event.execActionIndex],e,t,n)},a.execLoopNextAction=function(t,n,i,a){if(void 0===a&&(a=0),!(this.event.execActionIndex>=this.actions.length)){var s=e.World.getInstance(),r=t.callTarget,o=r.name,l=e.EventSheetDecoder.decodeActionParams(t).params,c=t.callHanlderName;if("wait"==c){var h=e.eval_e(l[0]);return"number"!=typeof h&&(h=0),void egret.setTimeout(function(e,t){this.event.execActionIndex++,this.execLoopNextAction(this.actions[this.event.execActionIndex],e,t)},this,1e3*h,n,i)}for(var u=0;u<i.length;u++)e.lakeshoreInst()[i[u].name]=i[u];for(var v=[],f=0;f<l.length;f++){var g=l[f];if(g instanceof e.AIObject)for(var d=0;d<i.length;d++){var p=i[d];if(p.name==g.name){e.lakeshoreInst()[p.name]=p,v.push(p);break}}}r instanceof e.BaseBehavior&&(o=t.targetName);var y=[];if(e.isSingleInst(o))y=[e.getInstanceByInstanceName(o)];else if(t.isFamily){for(var _=e.EventSheetDecoder.curFamilys[t.callTarget],f=0;f<i.length;f++){var p=i[f];e.lakeshoreInst()[p.name]=p;for(var m=0;m<_.insts.length;m++){var x=_.insts[m];x.name==p.name&&y.push(p)}}if(0===y.length)for(var u=0;u<_.insts.length;u++)for(var x=_.insts[u],b=s.objectHash[x.name],C=0;C<b.length;C++){var E=b[C];y.push(E)}}else{for(var f=0;f<i.length;f++){var p=i[f];p.name==o&&(e.lakeshoreInst()[p.name]=p,y.push(p))}if(0===y.length&&!this.event.computeTargets[o]){var b=s.objectHash[o];if(b)for(var f=0;f<b.length;f++){var E=b[f];y.push(E)}else console.error("没有查到目标【"+o+"】实例列表！！")}}var I=!1;if(this.lastActionResults&&this.lastActionResults.length>0){for(var f=0;f<y.length;f++)for(var S=y[f],d=this.lastActionResults.length-1;d>=0;d--){var T=this.lastActionResults[d];if(S==T){I=!0;break}}I&&(y=this.lastActionResults)}if(y.length>0){var O=this.execSingleAction(t,y,a);O&&O.length>0?this.lastActionResults=O:this.lastActionResults=[]}this.event.execActionIndex++,this.execLoopNextAction(this.actions[this.event.execActionIndex],n,i,a)}},a.execSingleAction=function(t,n,i){void 0===i&&(i=0);for(var a=t.callTarget,s=(a.name,t.callHanlderName),r=e.EventSheetDecoder.decodeActionParams(t),o=r.params,l=r.isFamilys,c=0;c<n.length;c++){var h=n[c];if(!h.isDead){var u;if(a instanceof e.BaseBehavior)for(var v=h.behaviors,f=0;f<v.length;f++){var g=v[f];if(g.name==a.name){u=g;break}}else u=h;var d=u[s];if(d){if(a instanceof e.AIObject&&"WebSocket"!=u.name&&(e.lakeshoreInst()[u.name]=u),r.hasFamily){for(var p=0;p<o.length;p++){var y=l[p];if(y){var _=o[p],m=e.EventSheetDecoder.curFamilys[_];o[p]=m.insts[Math.floor(m.insts.length*Math.random())]}}var x=d.apply(u,o)}else var x=d.apply(u,o);void 0!=x?t.lastLoopSelectInstances[i]=x:t.lastLoopSelectInstances[i]=[]}}}return t.lastLoopSelectInstances[i]},t}();e.ConditionBlock=t,egret.registerClass(t,"ls.ConditionBlock")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.sceneWidth=0,e.sceneHeight=0,e.version=0,e.isHasJpg=!1,e.isHasPng=!1,e.openLog=!0,e}();e.Config=t,egret.registerClass(t,"ls.Config")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseClass);e.BaseEvent=t,egret.registerClass(t,"ls.BaseEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments),this.index=0,this.execActionIndex=0,this.computeTargets={},this.enabled=!0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.AIEvent=t,egret.registerClass(t,"ls.AIEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t.KEY_DOWN="keyDown",t.KEY_UP="keyUp",t}(egret.Event);e.KeyboardEvent=t,egret.registerClass(t,"ls.KeyboardEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnForEachArrayElementEvent=t,egret.registerClass(t,"ls.OnForEachArrayElementEvent")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(t,n,i,a,s){void 0===i&&(i=null),void 0===a&&(a=!1),void 0===s&&(s=!1),e.call(this,t,a,s),this.triggerTargets=[],this.triggerCondition=n,this.triggerData=i}__extends(t,e);var n=(__define,t);n.prototype;return t.TRIGGER="TRIGGER",t}(egret.Event);e.TriggerEvent=t,egret.registerClass(t,"ls.TriggerEvent")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.EventSheetVo=t,egret.registerClass(t,"ls.EventSheetVo");var n=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.FamilyVo=n,egret.registerClass(n,"ls.FamilyVo");var i=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.VariableVo=i,egret.registerClass(i,"ls.VariableVo");var a=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.CollisionDataVo=a,egret.registerClass(a,"ls.CollisionDataVo");var s=function(){function e(){this.enemyNames=[]}var t=(__define,e);t.prototype;return e}();egret.registerClass(s,"CollisionSearchVo");var r=function(){function a(){}var r=(__define,a);r.prototype;return a.saveEventSheetData=function(n){var i=e.Config.sceneInfo.eventsheetData;this.eventsheetVo=new t,this.eventsheetVo.eventSheetName=n,this.eventsheetVo.nextEventSheetName=i.$next,this.eventsheetVo.prevEventSheetName=i.$previous,this.eventsheetVo.layoutName=i.$layout;var a=i.$version;this.eventsheetVo.version=a?a:"1.1.1",this.eventSheets[n]=this.eventsheetVo},a.start=function(t){e.assert(null==t||""==t,t+" can not null!"),this.saveEventSheetData(t);var n=e.Config.sceneInfo.eventsheetData;e.assert(null==n,"can not find "+t),this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[];e.World.getInstance().objectList;this.currentEventSheetName=t;var i=n.children;if(void 0!==i){for(var a=0,s=i.length;s>a;a++){var r=i[a],o=r.$type;switch(o){case"instance":e.LayoutDecoder.curSceneInstances[r.$UID]&&this.curSceneInstancesData.push(r);break;case"family":var l=this.decodeFamily(r);if(this.curFamilys[l.name]=l,l.insts&&l.behaviors)for(var c=0;c<l.insts.length;c++){var h=l.insts[c];if(h)for(var u=0;u<l.behaviors.length;u++){var v=l.behaviors[u],f=0==c?v:v.clone();h.addBehavior(f),f.onCreate(),f.isCreated=!0}}break;case"event":this.curSceneEventsData.push(r);break;case"variable":var g=this.decodeVaraible(r);if(void 0==e.AISystem.instance[g.name]){switch(g.variableType){case"number":e.AISystem.instance[g.name]=+g.initValue;break;case"string":e.AISystem.instance[g.name]=g.initValue+"";break;case"any":e.AISystem.instance[g.name]=g.initValue;break;case"boolean":e.AISystem.instance[g.name]=Boolean(e.eval_e(g.initValue))}void 0==e.AISystem.instance.globalVariables&&(e.AISystem.instance.globalVariables={}),e.AISystem.instance.globalVariables[g.name]=e.AISystem.instance[g.name]}}}this.decode()}},a.decode=function(){this.decodePropertys(),this.decodeEvents(),e.AISystem.instance.sendSceneInitComplete(),this.decodeExpressions(),e.GameUILayer.stage.addEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this),this.onInstancesCreate()},a.decodeExpressions=function(){},a.decodePropertys=function(){for(var t=0,n=this.curSceneInstancesData.length;n>t;t++){var i=this.curSceneInstancesData[t],a=(i.$type,+i.$UID),s=e.LayoutDecoder.curSceneInstances[a];if(null!=s){this.curSceneAiObjectsHash[s.name]=s,this.curSceneAiObjects.push(s);var r=i.children;if(r)for(var o=r.length,l=0;o>l;l++){var c=r[l];this.decodeInstancePropertie(c,s)}}else e.assert(!0,"EventSheetDecoder UID:"+a+" instance is null!")}},a.decodeFamily=function(t){var i=t.$UID,a=""==i?[]:i.split(","),s=new n;if(s.name=t.$target,s.UIDs=[],s.insts=[],a&&a.length)for(var r=0;r<a.length;r++)s.UIDs[r]=parseFloat(a[r]),s.insts[r]=e.LayoutDecoder.curSceneInstances[s.UIDs[r]];s.behaviors=[],s.variables=[];for(var o=t.children,r=0;r<o.length;r++){var l=o[r];switch(l.$name){case"behaviors":for(var c=l.children,h=0;h<c.length;h++){var u=this.decodeBehavior(c[h]);s.behaviors[h]=u}break;case"variables":for(var v=l.children,f=0;f<v.length;f++){var g=this.decodeVaraible(v[f]);s.variables[f]=g}}}if(s.insts&&s.variables)for(var r=0;r<s.insts.length;r++)for(var d=s.insts[r],p=0;p<s.variables.length;p++){var y=s.variables[p];switch(y.variableType){case"number":d[y.name]=+y.initValue;break;case"string":d[y.name]=y.initValue+"";break;case"any":d[y.name]=y.initValue;break;case"boolean":d[y.name]=Boolean(e.eval_e(y.initValue))}}return s},a.decodeVaraible=function(e){var t=new i;return t.initValue=decodeURIComponent(e.$initValue),t.variableType=e.$variableType,t.name=e.$variableName,t},a.decodeEvents=function(){for(var e=0;e<this.curSceneEventsData.length;e++){var t=this.curSceneEventsData[e],n=this.decodeEvent(t,e);n&&this.curSceneEvents.push(n)}},a.decodeEvent=function(t,n){var i=new e.AIEvent;i.index=n;var a=t.$conditionRelationShip;a&&(i.conditionRelationShip=e.eval_e(a));var s=t.$triggerOnceWhileTrue;s&&(i.triggerOnceWhileTrue=e.eval_e(s));var r=t.children;if(null!=r){for(var o,l=r.length,c=0,h=!1,u=0;l>u;u++)if("conditionBlock"===r[u].$type){h=!0;break}if(h)for(var v=0,f=0;l>f;f++){var g,d=r[f],p=d.$type;switch(p){case"conditionBlock":g=this.decodeConditionBlock(d.children,c,i),g.event=i,null==i.conditionBlocks&&(i.conditionBlocks=[]),i.conditionBlocks.push(g),0===c?o=g:(g.prevConditionBlock=o,o=g,g.prevConditionBlock.nextConditionBlock=g),c++;break;case"event":null==i.children&&(i.children=[]);var y=this.decodeEvent(d,v);y.parent=i,i.children.push(y),v++}}else{v=0;for(var _=[],f=0;l>f;f++){var d=r[f],p=d.$type;switch(p){case"condition":case"action":_.push(d);break;case"event":null==i.children&&(i.children=[]);var y=this.decodeEvent(d,v);y.parent=i,i.children.push(y),v++}}g=this.decodeConditionBlock(_,0,i),g.event=i,null==i.conditionBlocks&&(i.conditionBlocks=[]),i.conditionBlocks.push(g),0===c?o=g:(g.prevConditionBlock=o,o=g,g.prevConditionBlock.nextConditionBlock=g),c++}return i}},a.decodeInstancePropertie=function(t,n){var i=t.$type;switch(i){case"behavior":if(n.global)break;var a=this.decodeBehavior(t);n instanceof e.AIDisplayObject?n.addBehavior(a):e.assert(!0,n+"must instance of AIDisplayObject for have Behaviors"),a.onCreate(),a.isCreated=!0;break;case"variable":var s=t.$variableName,r=t.$variableType,o=decodeURIComponent(t.$initValue);switch(r){case"number":n.addVariable(s,+o);break;case"string":n.addVariable(s,o+"");break;case"any":n.addVariable(s,o);break;case"boolean":n.addVariable(s,Boolean(e.eval_e(o)))}}},a.decodeBehavior=function(t){var n=t.$behaviorType,i=e.getInstanceByPluginClassName(n);i.name=t.$name;var a=t.children;if(a)for(var s=a.length,r=0;s>r;r++){var o=a[r],l=o.$name,c=decodeURIComponent(o.$value),h=o.$valueDataType;switch(h){case"number":i[l]=+c;break;case"string":i[l]=c+"";break;case"any":i[l]=c;break;case"boolean":i[l]=Boolean(e.eval_e(c))}}return i},a.decodeConditionBlock=function(t,n,i){var a=t;if(a){var s=new e.ConditionBlock;s.index=n,s.conditions=[],s.actions=[];for(var r,o,l,c,h=a.length,u=0,v=0,f=0;h>f;f++){var g=a[f],d=g.$type;switch(d){case"condition":var p=this.decodeCondition(g,u,i);p.conditionBlock=s,p.event=i,void 0==p.callCondition&&(p.isFamily?e.assert(!0,"目标组没有"+p.callConditionName+"方法！！！"):e.assert(!0,"目标："+p.callTarget+"没有"+p.callConditionName+"方法！！！")),s.conditions.push(p),0===u?o=r=p:(p.prevCondition=o,o=p,p.prevCondition.nextCondition=p),u++;
break;case"action":var y=this.decodeAction(g,v,i);y.conditionBlock=s,y.event=i,s.actions.push(y),0===v?c=l=y:(y.prevAction=c,c=y,y.prevAction.nextAction=y),v++}}return s}return null},a.decodeConditionProperties=function(t,n,i){var a=t+"_"+n;if(void 0==this.instancesConditions[a]){var s=i.data,r=s.children;if(r)for(var o=r.length,l=0;o>l;l++){var c=r[l],h=c.$valueDataType,u=c.$name,v=c.$value,f=c.$variable?"true"===c.$variable:!1,g=c.$isFamily?"true"===c.$isFamily:!1;switch(i.isFamily=g,h){case"number":i[u]=+v;break;case"string":var d=decodeURIComponent(v+"");d=f?d:e.getTransformationStr(d),f?i[u]=d:i[u]=e.eval_e(d);break;case"any":i[u]=f?decodeURIComponent(c.$value):e.getTransformationStr(decodeURIComponent(c.$value));break;case"boolean":i[u]=Boolean(e.eval_e(v))}}this.instancesConditions[a]=i}return i=this.instancesConditions[a]},a.decodeConditionFamilyProperties=function(e,t){var n=[],i=t.children;if(i)for(var a=i.length,s=0;a>s;s++){var r=i[s],o=r.$isFamily?"true"===r.$isFamily:!1;if(o)for(var l=r.$value,c=this.curFamilys[l],h=c.insts,u=0;u<h.length;u++)-1==n.indexOf(h[u].name)&&n.push(h[u].name)}return n},a.decodeCondition=function(t,n,i){var a=t.$target,r=t.$behaviorName,o=e.getInstanceByPluginClassName(t.$paramsClass),l=t.$callName,c=!1;t.$invert&&(c="true"===t.$invert);var h=!1;t.$loop&&(h="true"===t.$loop);var u=new e.Condition;if(u.index=n,u.firstCondition=0==n?u:null,u.targetName=a,u.paramClassName=t.$paramsClass,u.isInvert=c,u.paramsInstance=o,u.callConditionName=l,u.isFamily="true"==t.$family,u.event=i,1===e.Version.compareVersion(this.eventsheetVo.version,"1.1.1")){var v=0;t.$operatorType&&(v=+t.$operatorType),u.operatorType=v}else u.operatorType=+!i.conditionRelationShip;if(o&&(o.data=t,u.isTrigger=Boolean(e.eval_e(t.$isTrigger)),u.isTrigger&&this.triggerConditions.push(u)),"onCollisionWithOtherObject"==l){var f=t.children;if(f){var g=f[0].$value,d=e.eval_e(e.getTransformationStr(g));if(u.isFamily){var p=this.curFamilys[a];if(p.insts&&p.insts.length>0)for(var y=0;y<p.insts.length;y++){var _=p.insts[y];if(null==this.collisionSearchs[_.name]){var m=new s;m.owerName=_.name,d instanceof e.AIDisplayObject&&m.enemyNames.push(g),this.collisionSearchs[_.name]=m}else m=this.collisionSearchs[_.name],d instanceof e.AIDisplayObject&&m.enemyNames.push(g)}}else{var x=this.decodeConditionFamilyProperties(u.paramsInstance,t);if(null==this.collisionSearchs[a]){var m=new s;m.owerName=a,this.collisionSearchs[a]=m}else m=this.collisionSearchs[a];if(x.length>0)for(var b=0;b<x.length;b++)m.enemyNames.push(x[b]);else d instanceof e.AIDisplayObject&&m.enemyNames.push(g)}}}if(e.isSingleInst(a))u.callTarget=e.getInstanceByInstanceName(a),u.callCondition=u.callTarget[l];else{if(u.isFamily){var C=null,p=this.curFamilys[a],E=p.insts;void 0==E&&alert("当前场景中没有"+a+"的组！！！");for(var I=0;I<E.length;I++){var S=E[I],T=e.World.getInstance().objectHash[S.name][0];if(null!=r&&""!=r){if(T){for(var O,D=p.behaviors,w=0,A=D.length;A>w;w++){var M=D[w];if(M.name==r){O=M;break}}C=null==O?T:O}}else C=[],C.push(T)}u.callTarget=C,void 0==C[0]?u.callCondition=C[l]:u.callCondition=C[0][l]}else{var C=null;void 0==e.World.getInstance().objectHash[a]&&alert("当前场景中没有"+a+"实例对象！！！");var T=e.World.getInstance().objectHash[a][0];if(null!=r&&""!=r){if(T){for(var D=T.behaviors,w=0,A=D.length;A>w;w++){var M=D[w];if(M.name==r){C=M;break}}C=null==C?T:C}}else C=T;u.callTarget=C,u.callCondition=u.callTarget[l]}void 0===u.callCondition&&e.assert(!0,"条件目标:"+u.targetName+",没有调用的方法名："+l)}return u},a.decodeAction=function(t,n,i){var a,s=t.$target,r=t.$behaviorName,o=t.$callName,l="true"==t.$family;if(e.isSingleInst(s))a=e.getInstanceByInstanceName(s);else if(this.curSceneAiObjects)for(var c=0,h=this.curSceneAiObjects.length;h>c;c++)if(this.curSceneAiObjects[c].name==s){a=this.curSceneAiObjects[c];var u;if(null!=r&&""!=r&&a){var v=a.behaviors;if(v){for(var f=0,g=v.length;g>f;f++){var d=v[f];if(d.name==r){u=d;break}}a=u}}break}void 0==a&&(a=e.eval_e(s));var p=new e.Action;return p.index=n,p.targetName=s,p.isFamily=l,p.callTarget=a,p.paramData=t.children,p.callHanlderName=o,p},a.decodeActionParams=function(t){var n={},i=[],a=t.paramData,s=[],r=!1;if(a&&a.length)for(var o=0,l=a.length;l>o;o++){var c=a[o],h=c.$valueDataType,u=(c.$name,decodeURIComponent(c.$value)),v=c.$variable?"true"===c.$variable:!1,f=c.$isFamily?"true"===c.$isFamily:!1;f&&(r=!0);var g;switch(h){case"number":g=+u;break;case"string":u=v?u:e.getTransformationStr(u),g=v?u:e.eval_e(u+"");break;case"any":g=v?u:e.getTransformationStr(u);break;case"boolean":g=Boolean(e.eval_e(u))}s[o]=f,i.push(g)}return n.params=i,n.isFamilys=s,n.hasFamily=r,n},a.tick=function(){return this._tick},a.eventsheetRender=function(t){var n=e.AISystem.instance,i=egret.getTimer();0!==this.lastTickTime&&(this._tick=i-this.lastTickTime,this._tick<0&&(this._tick=0),n.dt1=this._tick/1e3,n.dt1>.5?n.dt1=0:n.dt1>1/n.minimumFramerate&&(n.dt1=1/n.minimumFramerate),e.World.getInstance().sceneCamera.render(),e.World.getInstance().sceneCamera.renderContainer(),this.renderCamera(),this.renderEvents(),this.renderBehaviors(),this.onRenderUpdate(),null!=this.onEventSheetTick&&this.onEventSheetTick(),this.checkCollistions()),this.lastTickTime=i,n.dt=n.dt1*n.timeScale},a.onRenderUpdate=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var i=t[n];i instanceof e.AIDisplayObject&&i.renderUpdate()}},a.renderCamera=function(){e.World.getInstance().render()},a.onInstancesCreate=function(){for(var t in e.LayoutDecoder.curSceneInstances)e.LayoutDecoder.curSceneInstances[t]instanceof e.AIDisplayObject&&e.LayoutDecoder.curSceneInstances[t].onCreate()},a.renderBehaviors=function(){for(var t=e.World.getInstance().objectList,n=0;n<t.length;n++){var i=t[n];i.onTick();var a=i.behaviors;if(a)for(var s=0;s<a.length;s++){var r=a[s];r.enabled&&r.inst&&!(0===r.inst.dt||r.inst.dt>1e6)&&r.tick()}}},a.renderEvents=function(){for(var t=e.AISystem.instance.disableDataEvents,n=0;n<this.curSceneEvents.length;n++)if(void 0==t[n+1]){var i=this.curSceneEvents[n];this.execEvent(i)}},a.execEvent=function(e,t){if(void 0===t&&(t=null),e.enabled){var n=!1;if(e.parent?e.parent.conditionBlocks[0].status&&(n=!0):n=!0,n){var i=e.conditionBlocks;this.execConditionBlock(i[0],t)}}},a.execConditionBlock=function(e,t){if(e){e.cs={},e.loopDatas=[],e.loopLayers=0,this.execNextCondition(e.conditions[0],e,t,function(){for(var t,n=[],i=0;i<e.conditions.length;i++){var s=e.conditions[i];t=0==i?s.currentStatus:1==s.operatorType?t||s.currentStatus:t&&s.currentStatus}if(e.status=t,t){e.event.triggerOnceWhileTrue&&(e.event.enabled=!1);for(var r in e.cs.instanceStatus){var o,l=e.cs.instanceStatus[r],c=l.instance,h=l.ccs,u=0;for(var v in h){var f=h[v],g=f.c;o=0==u?f.status:1==g.operatorType?o||f.status:o&&f.status,u++}o&&n.push(c)}if(n.length>0){e.execActions(n);var d=e.event;if(d.children)for(var p=0;p<d.children.length;p++){var y=d.children[p];y&&(y.lastFilterTargets=n,a.execEvent(y))}}}});var n=e.nextConditionBlock;n&&this.execConditionBlock(n,t)}},a.execNextCondition=function(t,n,i,a){if(void 0===a&&(a=null),t){var s,r=t,o=r.targetName,l=r.isFamily,c=r.callTarget,h=r.callCondition,u=(r.callConditionName,r.isInvert),v=(r.paramClassName,r.paramsInstance),f=r.isTrigger;if(r.currentStatus=!1,n.cs.instanceStatus||(n.cs.instanceStatus={}),s=l?this.curFamilys[o].insts:e.isSingleInst(o)?[e.getInstanceByInstanceName(o)]:e.World.getInstance().objectHash[o],f){for(var g=0;g<s.length;g++){var d=s[g];n.cs.instanceStatus[d.u_id]||(n.cs.instanceStatus[d.u_id]={instance:d,ccs:{}}),n.cs.instanceStatus[d.u_id].ccs[r.index]={c:r,status:!1}}if(i&&r==i.compareCondition){r.currentStatus=!0;var p=i.triggerTargets;if(p)for(var y=0;y<p.length;y++){var _=p[y];n.cs.instanceStatus[_.u_id]||(n.cs.instanceStatus[_.u_id]={instance:_,ccs:{}}),n.cs.instanceStatus[_.u_id].ccs[r.index]={c:r,status:!0}}}else r.currentStatus=!1}else for(var y=0;y<s.length;y++){var m,d=s[y];if(c instanceof e.BaseBehavior){var x;l?i&&i.familyVo&&(x=i.familyVo.behaviors):x=d.behaviors;for(var b=0;b<x.length;b++){var C=x[b];if(C.name==c.name){m=C;break}}}this.decodeConditionProperties(t.event.sid,t.index,v);var E=h.apply(m?m:d,[v]);E.status=u?!E.status:E.status,E.data&&(E.data instanceof e.ForEvent||E.data instanceof e.ForEachOrderEvent||E.data instanceof e.OnForEachArrayElementEvent)&&(n.loopDatas[n.loopLayers++]=E.data),n.cs.instanceStatus[d.u_id]||(n.cs.instanceStatus[d.u_id]={instance:d,ccs:{}}),n.cs.instanceStatus[d.u_id].ccs[r.index]={c:r,status:E.status},E.status&&(r.currentStatus=E.status)}var I=t.nextCondition;I?this.execNextCondition(I,n,i,a):a&&a()}},a.checkCollistions=function(){var t=e.World.getInstance(),n=t.objectList,i={};for(var a in this.collisionSearchs){var s=this.collisionSearchs[a],r=t.objectHash[s.owerName];for(var o in r){var l=r[o];if(l.container.stage&&!l.isDead&&l.collision)for(var c=0;c<s.enemyNames.length;c++){var h=s.enemyNames[c],u=t.objectHash[h];for(var v in u){var f=u[v];if(f.container.stage&&f.collision&&!f.isDead){var g=e.Collision.checkCollision(l,f);g&&(null==i[l.u_id]&&(i[l.u_id]=[l,f]),null==i[f.u_id]&&(i[f.u_id]=[f,l]))}}}}}for(var d={},p=0;p<n.length;p++)if(n[p]instanceof e.AIDisplayObject){var y=n[p],_=i[y.u_id];if(null!=_){var m=_[1],x=0;null==d[y.u_id]&&(x++,d[y.u_id]=y),null==d[m.u_id]&&(x++,d[m.u_id]=m),2!=x&&y.setIsColliding(!0,m)}else y.setIsColliding(!1,null)}},a.execScenePauseOrPlay=function(t){0==t?e.StartUp.stage.frameRate=.001:e.StartUp.stage.frameRate=60},a.destory=function(){this.curSceneInstancesData=[],this.curSceneEventsData=[],this.curSceneAiObjects=[],this.curSceneAiObjectsHash={},this.curSceneEvents=[],this.triggerConditions=[],this.curFamilys={},this.instancesConditions={},e.AISystem.instance.disableDataEvents={},e.GameUILayer.stage.removeEventListener(egret.Event.ENTER_FRAME,this.eventsheetRender,this)},a.curSceneInstancesData=[],a.curSceneEventsData=[],a.curSceneAiObjects=[],a.curSceneAiObjectsHash={},a.curSceneEvents=[],a.curFamilys={},a.eventSheets={},a.collisionSearchs={},a.lastTickTime=0,a._tick=60,a.testShape=new egret.Sprite,a.triggerConditions=[],a.instancesConditions={},a}();e.EventSheetDecoder=r,egret.registerClass(r,"ls.EventSheetDecoder")}(ls||(ls={}));var ls;!function(ls){function assert(e,t){if(e){var n;try{throw Error()}catch(i){n=i.stack}var t="【ERROR】:"+t+"\n\nStack trace: \n"+n;console.error&&console.error(t),isWeixinLogin()&&(document.write(t),alert(t))}}function registerObject(e,t){window[e]=t}function lakeshoreInst(){return window}function eval_e(exp){try{return eval(exp)}catch(exception){return exp}}function getloopIndex(e){return ls.loopIndex[e]}function fps(){return 1/dt()}function dt(){return ls.AISystem.instance.dt1}function objectcount(){return ls.World.getInstance().objectList.length}function timeScale(){return 1}function time(){return egret.getTimer()-ls.oldtime}function log(e){e+="",e=e.split(",");for(var t=0;t<e.length;t++){var n=eval_e(e[t]);ls.Log.log(n)}}function isPc(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=!0,i=0;i<t.length;i++)if(e.indexOf(t[i])>0){n=!1;break}return n}function injectProp(e,t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!t)return!1;var i=!0;for(var a in t){var s=t[a];n&&"function"==typeof s||(e[a]=s)}return i}function getMiniSeconds(e){var t=/-/g,n=new Date(Date.parse(e.replace(t,"/")));return n.getTime()}function getRemainTimeStr(e,t,n){void 0===t&&(t=":"),void 0===n&&(n=!0);var i=this.getMiniSeconds(e),a=(new Date).getTime(),s=i-a;if(s>=0){var r=Math.round(s/1e3),o=Math.floor(r/3600),l=Math.floor((r-3600*o)/60),c=r-3600*o-60*l,h=10>o?"0"+o:o.toString(),u=10>l?"0"+l:l.toString(),v=10>c?"0"+c:c.toString();return h+t+u+t+v}return n?"00"+t+"00"+t+"00":""}function isInternal(e){if(void 0==ls.cacheInternal[e]){var t=!1;if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var i=ls.internalData[n];if(i.name==e){t=!0;break}}ls.cacheInternal[e]=t}return ls.cacheInternal[e]}function getPlugin(e){if(void 0==ls.cachePlugins[e]){var t="";if(ls.internalData)for(var n=0;n<ls.internalData.length;n++){var i=ls.internalData[n];if(i.name==e){t=i.plugin;break}}ls.cachePlugins[e]=t}return ls.cachePlugins[e]}function isSingleInst(e){return isInternal(e)}function getInstanceByInstanceName(e){var t,n;if(isSingleInst(e)){if(null==ls.singles[e]){if(n=egret.getDefinitionByName("ls."+getPlugin(e)),null==n)return void alert("name:"+e);n.name=e,t=null==n.instance?new n:n.instance,ls.singles[e]=t,registerObject(e,t)}else t=ls.singles[e];isInternal(e)&&(window[e]=t)}return t}function getInstanceByPluginClassName(e,t){void 0===t&&(t=!1);var n,i;if("Object"==e)return null;if(isSingleInst(e))if(null==ls.singles[e]){if(i=egret.getDefinitionByName("ls."+getPlugin(e)),null==i)return void(t||alert("name:"+e));i.name=e,n="System"==e?i.instance:new i,n.name=e,ls.singles[e]=n,registerObject(e,n)}else n=ls.singles[e];else{if(i=egret.getDefinitionByName("ls."+e),null==i)return t||alert("name:"+e),void(n=null);n=new i}return isInternal(e)&&(window[e]=n),n}function getTexture(e){if(e){var t,n=e;if(n){var i=ls.LayoutDecoder.spriteSheetDatas[n];if(i&&(t=i.texture),(void 0==t||null==t)&&(t=RES.getRes(n)),void 0!=t&&null!=t)return[t,i?i.offsetX:0,i?i.offsetY:0]}}return null}function getName(e){return e?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}function getTransformationStr(e){return e}function xmlToJson(e){var t={};if(1==e.nodeType)for(var n in e.attributes)t[n]=e.attributes[n];else 3==e.nodeType&&(t=e.name);if(e.children)for(var i=0;i<e.children.length;i++){var a=e.children[i],s=a.localName;if(void 0==t[s])t[s]=this.xmlToJson(a);else{if(void 0==t[s].length){var r=t[s];t[s]=[],t[s].push(r)}t[s].push(this.xmlToJson(a))}}return t}function round6dp(e){return Math.round(1e6*e)/1e6}function is_undefined(e){return"undefined"==typeof e}function is_number(e){return"number"==typeof e}function is_string(e){return"string"==typeof e}function abs(e){return e=eval_e(e),Math.abs(e)}function acos(e){return e=eval_e(e),Math.acos(e)}function angle(e,t,n,i){return e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i),180*Math.atan2(i-t,n-e)/Math.PI}function asin(e){return e=eval_e(e),Math.asin(e)}function atan(e){return e=eval_e(e),Math.atan(e)}function atan2(e,t){return e=eval_e(e),t=eval_e(t),Math.atan2(e,t)}function ceil(e){return e=eval_e(e),Math.ceil(e)}function floor(e){return e=eval_e(e),Math.floor(e)}function sin(e){return e=eval_e(e),Math.sin(e)}function cos(e){return e=eval_e(e),Math.cos(e)}function sqrt(e){return e=eval_e(e),Math.sqrt(e)}function tan(e){return e=eval_e(e),Math.tan(e)}function cosp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),(e+t+(e-t)*Math.cos(n*Math.PI))/2}function distance(e,t,n,i){e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i);var a=e-n,s=t-i;return Math.sqrt(a*a+s*s)}function exp(e){return e=eval_e(e),Math.exp(e)}function pow(e,t){return e=eval_e(e),t=eval_e(t),Math.pow(e,t)}function getbit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e&1<<t?1:0}function lerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e+(t-e)*n}function unlerp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e==t?0:(n-e)/(t-e)}function log10(e){return e=eval_e(e),Math.log(e)/Math.LN10}function max(e,t){return e=eval_e(e),t=eval_e(t),Math.max(e,t)}function min(e,t){return e=eval_e(e),t=eval_e(t),Math.min(e,t)}function pi(){return Math.PI}function qarp(e,t,n,i){return e=eval_e(e),t=eval_e(t),n=eval_e(n),i=eval_e(i),lerp(lerp(e,t,i),lerp(t,n,i),i)}function round(e){return e=eval_e(e),Math.round(e)}function random(){return Math.random()}function togglebit(e,t){return e=eval_e(e),t=eval_e(t),e=0|e,t=0|t,e^1<<t}function float(e){return e=eval_e(e),+e}function int(e){return e=eval_e(e),parseInt(e)}function rgb(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),Math.max(Math.min(e,255),0)|Math.max(Math.min(t,255),0)<<8|Math.max(Math.min(n,255),0)<<16}function getRed(e){return e=eval_e(e),255&e}function getGreen(e){return e=eval_e(e),(65280&e)>>8}function getBlue(e){return e=eval_e(e),(16711680&e)>>16}function regexp_escape(e){return e=eval_e(e),e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function find(e,t){return e=eval_e(e),t=eval_e(t),e.search(new RegExp(regexp_escape(t),"i"))}function replace(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.replace(new RegExp(regexp_escape(t),"gi"),n)}function left(e,t){return e=eval_e(e),t=eval_e(t),e.substr(e,t)}function right(e,t){return e=eval_e(e),e.substr(e.length-t)}function len(e){return void 0==e||null==e?0:(e=eval_e(e),e+="",e.length)}function toFixed(e,t){return e=eval_e(e),t=eval_e(t),parseFloat(parseFloat(e).toFixed(t))}function lowercase(e){return e=eval_e(e),e.toLowerCase()}function upppercase(e){return e=eval_e(e),e.toUpperCase()}function trim(e){return e=eval_e(e),e.trim()}function mid(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),e.substr(t,n)}function newline(){return"\n"}function zeropad(e,t){e=eval_e(e),t=eval_e(t);var n=0>e?"-":"";0>e&&(e=-e);for(var i=t-e.toString().length,a=0;i>a;a++)n+="0";return n+e.toString()}function choose(){var e=Math.floor(Math.random()*(arguments.length-1));return arguments[e+1]}function getTime(){return(new Date).getTime()}function week(){return(new Date).getDay()}function year(){return(new Date).getFullYear()}function month(){return(new Date).getMonth()}function day(){return(new Date).getDate()}function hours(){return(new Date).getHours()}function minutes(){return(new Date).getMinutes()}function seconds(){return(new Date).getSeconds()}function minuteSeconds(){return(new Date).getMilliseconds()}function clamp(e,t,n){return e=eval_e(e),t=eval_e(t),n=eval_e(n),t>e?t:e>n?n:e}function isWeixinLogin(){var e=window.navigator.userAgent.toLowerCase(),t=e.match(/MicroMessenger/i);return t&&t.length>0&&"micromessenger"==t[0]}function compare(e,t,n){var i=eval_e(e),a=eval_e(n);switch(t){case OperationType.EQUAL_TO:return i==a;case OperationType.GREATER_OR_EQUAL:return i>=a;case OperationType.GREATER_THAN:return i>a;case OperationType.LESS_OR_EQUAL:return a>=i;case OperationType.LESS_THAN:return a>i;case OperationType.NOT_EQUAL_TO:return i!=a}return!1}ls.loopIndex={},ls.assert=assert,ls.registerObject=registerObject,ls.lakeshoreInst=lakeshoreInst,ls.eval_e=eval_e,ls.getloopIndex=getloopIndex,ls.fps=fps,ls.dt=dt,ls.objectcount=objectcount,ls.timeScale=timeScale,ls.oldtime=egret.getTimer(),ls.time=time,ls.log=log,ls.isPc=isPc,ls.injectProp=injectProp,ls.getMiniSeconds=getMiniSeconds,ls.getRemainTimeStr=getRemainTimeStr,ls.internalData=[],ls.cacheInternal={},ls.cachePlugins={},ls.isInternal=isInternal,ls.getPlugin=getPlugin,ls.isSingleInst=isSingleInst,ls.singles={},ls.getInstanceByInstanceName=getInstanceByInstanceName,ls.getInstanceByPluginClassName=getInstanceByPluginClassName,ls.getTexture=getTexture,ls.getName=getName,ls.getTransformationStr=getTransformationStr,ls.xmlToJson=xmlToJson,ls.round6dp=round6dp,ls.is_undefined=is_undefined,ls.is_number=is_number,ls.is_string=is_string,ls.abs=abs,ls.acos=acos,ls.angle=angle,ls.asin=asin,ls.atan=atan,ls.atan2=atan2,ls.ceil=ceil,ls.floor=floor,ls.sin=sin,ls.cos=cos,ls.sqrt=sqrt,ls.tan=tan,ls.cosp=cosp,ls.distance=distance,ls.exp=exp,ls.pow=pow,ls.getbit=getbit,ls.lerp=lerp,ls.unlerp=unlerp,ls.log10=log10,ls.max=max,ls.min=min,ls.pi=pi,ls.qarp=qarp,ls.round=round,ls.random=random,ls.togglebit=togglebit,ls["float"]=float,ls["int"]=int,ls.rgb=rgb,ls.getRed=getRed,ls.getGreen=getGreen,ls.getBlue=getBlue,ls.regexp_escape=regexp_escape,ls.find=find,ls.replace=replace,ls.left=left,ls.right=right,ls.len=len,ls.toFixed=toFixed,ls.lowercase=lowercase,ls.upppercase=upppercase,ls.trim=trim,ls.mid=mid,ls.newline=newline,ls.zeropad=zeropad,ls.choose=choose,ls.getTime=getTime,ls.week=week,ls.year=year,ls.month=month,ls.day=day,ls.hours=hours,ls.minutes=minutes,ls.seconds=seconds,ls.minuteSeconds=minuteSeconds,ls.clamp=clamp,ls.isWeixinLogin=isWeixinLogin;var OperationType=function(){function e(){}var t=(__define,e);t.prototype;return e.EQUAL_TO="equalTo",e.NOT_EQUAL_TO="notEqualTo",e.LESS_THAN="lessThan",e.LESS_OR_EQUAL="lessOrEqual",e.GREATER_THAN="greaterThan",e.GREATER_OR_EQUAL="greaterOrEqual",e}();ls.OperationType=OperationType,egret.registerClass(OperationType,"ls.OperationType");var InstanceVariablesType=function(){function e(){}var t=(__define,e);t.prototype;return e.TEXT="text",e.INT="int",e.NUMBER="Number",e.BOOLEAN="boolean",e}();ls.InstanceVariablesType=InstanceVariablesType,egret.registerClass(InstanceVariablesType,"ls.InstanceVariablesType"),ls.compare=compare}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.getLayerByIndex=function(t,n){var i=this.layers[n];if(null==i){i=new egret.Sprite,i.layerIndex=n,this.layers.push(i),this.layers.sort(function(e,t){return e.layerIndex>t.layerIndex?1:e.layerIndex<t.layerIndex?-1:0});var a=e.LayoutDecoder.layers[n];i.scaleX=a.layerScaleX/100,i.scaleY=a.layerScaleY/100,i.alpha=a.layerAlpha,i.visible=a.layerVisible;for(var s=0,r=this.layers.length;r>s;s++)i=this.layers[s],e.GameUILayer.renderContainer.addChild(i)}return i},t.getIndexByLayer=function(e){return e?this.layers.indexOf(e):-1},t.getLayer=function(e){for(var t=0;t<this.layers.length;t++){var n=this.layers[t];if(n.layerIndex==e)return n}return null},t.layers=[],t}();e.LayerManager=t,egret.registerClass(t,"ls.LayerManager")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.LayerVo=t,egret.registerClass(t,"ls.LayerVo")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._x=e,this._y=t}var t=__define,n=e,i=n.prototype;return t(i,"x",function(){return this._x},function(e){this._x=e}),t(i,"y",function(){return this._y},function(e){this._y=e}),t(i,"length",function(){return Math.sqrt(this._x*this._x+this._y*this._y)},function(e){var t=this.angle;this._x=Math.cos(t)*e,this._y=Math.sin(t)*e}),t(i,"lengthSQ",function(){return this._x*this._x+this._y*this._y}),t(i,"angle",function(){return Math.atan2(this._y,this._x)},function(e){var t=this.length;this._x=Math.cos(e)*t,this._y=Math.sin(e)*t}),t(i,"rotation",void 0,function(e){var t=e/180*Math.PI;this.angle=t}),i.normalize=function(){var e=this.length;return e?(this.x/=e,this.y/=e,this):this},i.truncate=function(e){return this.length=Math.min(e,this.length),this},i.reverse=function(){return this._x=-this._x,this._y=-this._y,this},i.isNormalized=function(){return 1==this.length},i.dotProd=function(e){return this._x*e._x+this._y*e._y},i.crossProd=function(e){return 0===this.getCross(e)},i.getCross=function(e){return this._x*e._y-this._y*e._x},e.angleBetween=function(e,t){return e.isNormalized()||(e=e.clone().normalize()),t.normalize()||(t=t.clone().normalize()),Math.acos(e.dotProd(t))},t(i,"perp",function(){return new e(-this._y,this._x)}),i.sign=function(e){return this.perp.dotProd(e)<0?-1:1},i.distance=function(e){return Math.sqrt(this.distanceSQ(e))},i.distanceSQ=function(e){var t=e._x-this._x,n=e._y-this._y;return t*t+n*n},i.equals=function(e){return this._x===e._x&&this._y===e._y},i.isZero=function(){return 0===this._x&&0===this._y},i.scale=function(e){return this._x*=e,this._y*=e,this},i.add=function(e,t){return this._x+=e,this._y+=t,this},i.substruct=function(e,t){return this._x-=e,this._y-=t,this},i.multiply=function(e,t){return this._x*=e,this._y*=t,this},i.divide=function(e,t){return this._x/=e,this._y/=t,this},i.clone=function(){var t=new e;return t._x=this._x,t._y=this._y,t},i.toString=function(){return"(x="+this.x+", y="+this.y+")"},e}();e.Vector2D=t,egret.registerClass(t,"ls.Vector2D")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e}();e.Layout=t,egret.registerClass(t,"ls.Layout");var n=function(){function n(){}var i=(__define,n);i.prototype;return n.getTexture=function(e){for(var t in this.spriteSheets){var n=this.spriteSheets[t],i=n.getTexture(e);if(void 0!=i)return i}return null},n.saveLayout=function(n){var i=e.Config.sceneInfo.layoutData,a=new t;a.layoutName=n,a.nextLayoutName=i.$next,a.prevLayoutName=i.$previous,a.eventSheetName=i.$eventSheet;var s=i.$version;a.version=s?s:"1.1.1",this.layouts[n]=a},n.start=function(t){e.assert(null==t||""==t,"layout canot null!");var i=e.Config.sceneInfo.layoutData;e.assert(null==i,"can not find"+t);var a=i.$sceneSize.split(",");this.sceneWidth=+a[0],this.sceneHeight=+a[1],this.currentLayoutName=t,this.saveLayout(t);var s=i.children;if(s){for(var r=[],o=0,l=s.length;l>o;o++){var c=s[o];if("layer"!=c.localName){var h=this.decodeInstance(c);h&&void 0!==h.index&&(h.index=c.$index?+c.$index:o,r.push(h))}else if(null==this.layers[+c.$index]){var u=this.decodeLayers(c);this.layers[u.index]=u}}r=r.concat(n.globalInstances),r.sort(function(e,t){return e.index>t.index?1:e.index<t.index?-1:0});for(var o=0;o<r.length;o++){var h=r[o];e.World.getInstance().addChild(h)}}if(e.internalData)for(var o=0;o<e.internalData.length;o++){var v=e.internalData[o].name;e.getInstanceByPluginClassName(v,!0)}for(var f in this.curSceneInstances)e.registerObject(this.curSceneInstances[f].name,this.curSceneInstances[f])},n.decodeInstances=function(e){var t=[];if(e){var n=e.children;if(n)for(var i=0;i<n.length;i++){var a=n[i];if("layer"==a.localName){if(null==this.layers[+a.$index]){var s=this.decodeLayers(a);this.layers[s.index]=s}}else{var r=this.decodeInstance(a);r&&void 0!==r.index&&(r.index=+a.$index),r&&t.push(r)}}}return t},n.decodeLayers=function(t){var n=new e.LayerVo;return n.index=+t.$index,n.parallaxX=+t.$parallaxX,n.parallaxY=+t.$parallaxY,n.layerAlpha=+t.$layerAlpha,n.layerVisible="false"!=t.$index,n.layerScaleX=+t.$layerScaleX,n.layerScaleY=+t.$layerScaleY,n},n.decodeInstance=function(t){if("spritesheets"!=t.localName){var n=+t.$UID,i=t.$plugin,a=t.$name;"true"==t.$isVisual;if(e.isInternal(a))return null;var s=this.curSceneInstances[n];if(void 0!=s)return s;if(s=e.getInstanceByPluginClassName(i),s.isModel=!0,s.name=a,s.id=n,s.parallaxX=+t.$parallaxX,s.parallaxY=+t.$parallaxY,null!=t.children){null==this.instanceNames[a]&&(this.instanceNames[a]=a);for(var r,o=!1,l={},c=0,h=t.children.length;h>c;c++){var u=t.children[c],v=u.$name,f=u.$value,g=u.$valueDataType;switch(v){case"layer":o=!0,s[v]=+f;break;case"actions":s.setData(u.children);break;case"behaviors":r=u;break;default:switch(g){case"number":l[v]=+f;break;case"string":l[v]=decodeURIComponent(f),"collisionData"==v&&(s.collisionVectorData=this.decodeCollision(s,l[v]),s.collisionSourceData=decodeURIComponent(u.$sourceValue),s.collisionSourceVectorData=this.decodeCollision(s,s.collisionSourceData));break;case"boolean":l[v]="true"==f;break;case"any":l[v]=e.eval_e(decodeURIComponent(f))}}}l.hasOwnProperty("width")&&(s.width=l.width),l.hasOwnProperty("height")&&(s.height=l.height);for(var d in l)s[d]=l[d];return o||(s.layer=0),s&&s.initialize(),null==this.curSceneInstances[n]&&(this.curSceneInstances[n]=s),s}}},n.decodeCollision=function(t,n){var i;if(t&&n)if(""==n)t.collisionType-1;else{var a=n.split("/n");if(2==a.length)switch(t.collisionType=+a[0],t.collisionType){case 0:i=[];var s=a[1].indexOf("_");if(-1!=s)for(var r=a[1].split("_"),o=0;o<r.length;o++){for(var l=r[o],c=l.split(","),h=[],u=0;u<c.length;u++){var v=c[u].split("|"),f=new e.Vector2D(+v[0],+v[1]);h[u]=f}i[o]=h}else{for(var c=a[1].split(","),h=[],o=0;o<c.length;o++){var v=c[o].split("|"),f=new e.Vector2D(+v[0],+v[1]);h[o]=f}i[0]=h}break;case 1:var g=a[1].split("|"),d=new e.Circle;d.center=new e.Vector2D(+g[0],+g[1]),d.radius=+g[2],i=d;break;case 2:var p=a[1].split("|");i=new e.Vector2D(+p[0],+p[1])}}return i},n.decodeBehaviors=function(t,n){if(t&&n){var i=n.children;if(i)for(var a=0;a<i.length;a++){var s=i[a],r=s.$behaviorType,o=e.getInstanceByPluginClassName(r);o.name=s.$name;var l=s.children;if(l)for(var c=l.length,h=0;c>h;h++){var u=l[h],v=u.$name,f=decodeURIComponent(u.$value),g=u.$valueDataType;switch(g){case"number":o[v]=+f;break;case"string":o[v]=f+"";break;case"any":o[v]=f;break;case"boolean":o[v]=Boolean(e.eval_e(f))}}t instanceof e.AIDisplayObject?t.addBehavior(o):e.assert(!0,t+"must instance of AIDisplayObject for have Behaviors"),o.onCreate(),o.isCreated=!0}}},n.destory=function(){for(var t in this.curSceneInstances){var n=this.curSceneInstances[t];n.global||(n instanceof e.AIDisplayObject&&n.removeAllBehaviors(),delete this.curSceneInstances[t])}this.instanceNames={},this.layers={}},n.curSceneInstances={},n.instanceNames={},n.layouts={},n.spriteSheets={},n.spriteSheetDatas={},n.globalInstances=[],n.layers={},n}();e.LayoutDecoder=n,egret.registerClass(n,"ls.LayoutDecoder")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.log=function(t){if(e.Config.openLog){if(null==this.logText){var n=e.GameUILayer.testContainer;n.graphics.clear(),n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,250,250),n.graphics.endFill(),this.logText=new egret.TextField,this.logText.width=250,this.logText.height=250,this.logText.size=14,this.logText.lineSpacing=6,this.logText.fontFamily="宋体",this.logText.textColor=49664,this.logText.x=5,this.logText.y=5,n.addChild(this.logText)}this.logCache.length>12&&this.logCache.shift(),t=void 0==t?"":t,this.logCache.push(t);for(var i="",a=0;a<this.logCache.length;a++)i+=this.logCache[a]+"\n";this.logText.text=i,this.logText.scrollV=this.logText.maxScrollV-12<0?0:this.logText.maxScrollV-12}},t.logCache=[],t}();e.Log=t,egret.registerClass(t,"ls.Log")}(ls||(ls={}));var ls;!function(e){var t=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t.init=function(e){e&&(this.stage=e,null==this.renderContainer&&(this.renderContainer=new egret.Sprite,this.renderContainer.name="renderContainer",e.addChild(this.renderContainer)),null==this.debugContainer&&(this.debugContainer=new egret.Sprite,this.debugContainer.name="debugContainer",e.addChild(this.debugContainer)),null==this.testContainer&&(this.testContainer=new egret.Sprite,this.testContainer.name="testContainer",e.addChild(this.testContainer)),null==this.preContainer&&(this.preContainer=new egret.Sprite,this.preContainer.name="preContainer",e.addChild(this.preContainer)),null==this.loadingContainer&&(this.loadingContainer=new egret.Sprite,this.loadingContainer.name="loadingContainer",e.addChild(this.loadingContainer)),null==this.drawContainer&&(this.drawContainer=new egret.Sprite,this.drawContainer.name="drawContainer",e.addChild(this.drawContainer)),this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onStageTouchEvent,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onStageTouchEvent,this))},t.onStageTouchEvent=function(e){this.touchX=e.stageX,this.touchY=e.stageY},t.touchX=0,t.touchY=0,t}(egret.DisplayObjectContainer);e.GameUILayer=t,egret.registerClass(t,"ls.GameUILayer")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(e){this.oldSceneX=0,this.oldSceneY=0,this.newSceneX=0,this.newSceneY=0,this.updateCamera=!1,this.scene=e}var n=(__define,t),i=n.prototype;return i.resetCamera=function(){e.GameUILayer.renderContainer.x=e.GameUILayer.renderContainer.y=0,this.oldSceneX=this.oldSceneY=0,this.newSceneX=this.newSceneY=0},i.lookAtPoint=function(e){this.pos!=e&&(this.pos=e,this._scrollX=this.pos.x,this._scrollY=this.pos.y,this.updateCamera=!0)},i.lookAtX=function(e){this._scrollX!=e&&(this.updateCamera=!0,this._scrollX=e)},i.lookAtY=function(e){this._scrollY!=e&&(this.updateCamera=!0,this._scrollY=e)},i.lookAtChar=function(e){this.lookAtTarget=e,(this._scrollX!=this.lookAtTarget.x||this._scrollY!=this.lookAtTarget.y)&&(this.updateCamera=!0,this._scrollX=this.lookAtTarget.x,this._scrollY=this.lookAtTarget.y)},i.render=function(){if(this.updateCamera){this.updateCamera=!1;var t=e.LayoutDecoder.sceneWidth,n=e.LayoutDecoder.sceneHeight,i=e.GameUILayer.stage.stageWidth,a=e.GameUILayer.stage.stageHeight,s=e.World.getInstance().objectList;
this._scrollX>i/2&&this._scrollX<t-i/2?this.newSceneX=i/2-this._scrollX:this._scrollX<=e.GameUILayer.stage.stageWidth/2?this.newSceneX=0:this._scrollX>t-i/2&&(this.newSceneX=i-t),this._scrollY>a/2&&this._scrollY<n-a/2?this.newSceneY=a/2-this._scrollY:this._scrollY<=a/2?this.newSceneY=0:this._scrollY>n-a/2&&(this.newSceneY=a-n);for(var r=0;r<s.length;r++){var o=s[r];o.isHasCamera||isNaN(this.oldSceneX)||isNaN(this.oldSceneY)||(o.x+=-((this.newSceneX-this.oldSceneX)*(100-o.parallaxX)/100),o.y+=-((this.newSceneY-this.oldSceneY)*(100-o.parallaxY)/100))}this._oldSceneX_=this.oldSceneX,this._oldSceneY_=this.oldSceneY,this.oldSceneX=this.newSceneX,this.oldSceneY=this.newSceneY}},i.renderContainer=function(){var t=e.GameUILayer.renderContainer;isNaN(this._oldSceneX_)||isNaN(this._oldSceneY_)||(t.x+=this.newSceneX-this._oldSceneX_,t.y+=this.newSceneY-this._oldSceneY_)},t}();e.SceneCamera=t,egret.registerClass(t,"ls.SceneCamera")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){if(this._objectList=[],this._objectHash={},this._updateCamera=!0,this._childCaches={},t._instance)throw new Error(this.constructor+"为单例！");t._instance=this,this._sceneCamera=new e.SceneCamera(this)}var n=__define,i=t,a=i.prototype;return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},n(a,"sceneCamera",function(){return this._sceneCamera}),n(a,"objectList",function(){return this._objectList}),n(a,"objectHash",function(){return this._objectHash}),a.scrollToTarget=function(e){this._sceneCamera.lookAtChar(e)},a.scrollToXY=function(e,t){this._sceneCamera.lookAtPoint(new egret.Point(e,t))},a.scrollToX=function(e){this._sceneCamera.lookAtX(e)},a.scrollToY=function(e){this._sceneCamera.lookAtY(e)},a.render=function(){var t=(e.GameUILayer.stage.stageWidth,e.GameUILayer.stage.stageHeight,[]);for(var n in this._childCaches){var i=this._childCaches[n];t.push(i)}t.sort(function(e,t){return e.layer>t.layer?1:e.layer<t.layer?-1:0});for(var a=0;a<t.length;a++)for(var i=t[a],s=i.instances,r=i.parent,o=0;o<s.length;o++){var l=s[o],c=new egret.Point(e.GameUILayer.renderContainer.x+r.x+l.x,e.GameUILayer.renderContainer.y+r.y+l.y),h=e.CollisionUtils.isCollsionWithRect(c.x-l.anchorOffsetX,c.y-l.anchorOffsetY,l.width,l.height,0,0,e.GameUILayer.stage.stageWidth,e.GameUILayer.stage.stageHeight),u=l.container;h?r.addChild(u):u.parent&&u.parent.removeChild(u)}},a.getChildByUID=function(e){void 0===e&&(e=0);for(var t=0,n=this._objectList.length;n>t;t++){var i=this._objectList[t];if(i.id==e)return i}return null},a.getChildByName=function(e){var t=[];if(null==e||""==e)return t;for(var n=0,i=this._objectList.length;i>n;n++){var a=this._objectList[n];a.name==e&&t.push(a)}return t},a.addChild=function(t,n){if(void 0===n&&(n=null),t){this._objectList.push(t);var i=t.container,a=t.layer,s=e.LayerManager.getLayerByIndex(t,a);i&&null==i.parent&&(null==this._childCaches[a]&&(this._childCaches[a]={instances:[],parent:s,layer:a}),this._childCaches[a].instances.push(t)),s.parallaxX=t.parallaxX,s.parallaxX=t.parallaxY,t.helpParent=s;var r=t.name;this._objectHash.hasOwnProperty(r)||(this._objectHash[r]=[]);for(var o=-1,l=0;l<this._objectHash[r].length;l++){var c=this._objectHash[r][l];if(c.u_id==t.u_id){o=l;break}}-1==o?this._objectHash[r].push(t):this._objectHash[r][o]=t,e.Trigger.register(t)}},a.removeChild=function(t){if(t){var n=this.objectList.indexOf(t);-1!=n&&this._objectList.splice(n,1);var i=t.container;if(i&&null!=i.parent&&i.parent.removeChild(i),this._objectHash.hasOwnProperty(name)){for(var a=this._objectHash[name],s=-1,r=0;r<a.length;r++){var o=a[r];if(o.u_id==t.u_id){s=r;break}}-1!=s&&a.splice(s,1)}var l=t;if(l&&this._childCaches[l.layer]){var c=this._childCaches[l.layer].instances;if(c){var h=c.indexOf(l);-1!=h&&c.splice(h,1),0==c.length&&delete this._childCaches[l.layer]}}e.Trigger.removeTrigger(t)}},a.removeAllChildrens=function(){e.Trigger.removeAllTriggers();for(var t in this._objectHash){var n=this._objectHash[t];if(n)for(var i=0;i<n.length;i++){var a=n[i];a.global||(a.destoryOnChangeScene(),delete this._objectHash[t])}}},a.destory=function(){this._sceneCamera.lookAtPoint(new egret.Point(0,0)),null!=t.onWorldDestory&&t.onWorldDestory(),e.LayoutDecoder.destory(),e.EventSheetDecoder.destory(),this._sceneCamera.resetCamera(),this.removeAllChildrens()},t.renderFirst=!0,t}();e.World=t,egret.registerClass(t,"ls.World")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this.id=0,this.name="Object",this.isModel=!1,this.timeScale=1,this.parallaxX=100,this.parallaxY=100,this.isDead=!1,this.global=!1,this.variables={},this.index=0,this.paramInstances={},this.actionSaves={},this.currentStatus=!0,this.selfStatus=!0,this._uid=0,n._uniqueID++,n.U_ID++,this._uid=n.U_ID,this.name="Object",this.plugin=egret.getQualifiedClassName(this),e.Trigger.register(this)}__extends(n,t);var i=__define,a=n,s=a.prototype;return i(s,"u_id",function(){return this._uid}),i(s,"dt",function(){return this.timeScale*e.AISystem.instance.dt1}),s.getClass=function(){return this.constructor},s.initialize=function(){},s.onTick=function(){},s.addVariable=function(t,n){this[t]=e.eval_e(n),this.variables[t]=e.eval_e(n)},s.getFirstPicked=function(){var t=e.World.getInstance().objectHash[this.name];return t?t[0]:void 0},s.compareTwoValue=function(t){return{instances:[this],status:e.compare(t.value1,t.operationType,t.value2)}},s.isBetweenValues=function(t){var n=e.eval_e(t.value),i=e.eval_e(t.lowerValue),a=e.eval_e(t.highValue);return a>i?{instances:[this],status:n>i&&a>n}:{instances:[this],status:i>n&&n>a}},s.isNumberNaN=function(t){return{instances:[this],status:"number"==typeof e.eval_e(t.value)}},s.destoryOnChangeScene=function(){this.destory()},s.destory=function(){},s.saveToJSON=function(){return{plugin:egret.getQualifiedClassName(this),id:this.id,uid:this.u_id,name:this.name,isModel:this.isModel,isDead:this.isDead,paramInstances:this.paramInstances,timeScale:this.timeScale,global:this.global,variables:JSON.stringify(this.variables)}},s.loadFromJSON=function(e){if(e){this.plugin=e.plugin,this.id=e.id,this._uid=e.uid,this.name=e.name,this.isModel=e.isModel,this.isDead=e.isDead,this.paramInstances=e.paramInstances,this.timeScale=e.timeScale,this.global=e.global,this.variables=JSON.parse(e.variables);for(var t in this.variables)this.addVariable(t,this.variables[t])}},s.clone=function(){var e=this.getClass(),t=new e;t.name=this.name,t.isModel=!1,t.timeScale=this.timeScale,t.global=this.global;for(var n in this.variables)t.addVariable(n,this.variables[n]);return t},n._uniqueID=0,n.U_ID=0,n}(egret.EventDispatcher);e.AIObject=t,egret.registerClass(t,"ls.AIObject");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareTwoValuesEvent=n,egret.registerClass(n,"ls.CompareTwoValuesEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsBetweenValuesEvent=i,egret.registerClass(i,"ls.IsBetweenValuesEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsNumberNaNEvent=a,egret.registerClass(a,"ls.IsNumberNaNEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this._isAddToStage=!1,this._collision=!1,this._isCollisioning=!1,this._isupdatebounds=!0,this._mirrored=3,this._sourceWidth=0,this._sourceHeight=0,this._x=0,this._y=0,this._anchorX=0,this._anchorY=0,this._anchorOffsetX=0,this._anchorOffsetY=0,this._width=1,this._height=1,this._scaleX=1,this._scaleY=1,this._scale=1,this._angle=0,this._alpha=1,this._visible=!0,this.behaviors=[],this.layer=0,this.vx=0,this.vy=0,this.isInScreenOnce=!1,this.solidEnabeld=!1,this.platformEnabled=!1,this.jumpthruEnabled=!1,this.collisionType=-1,this.collisionIsRect=!0,this.scaleContainer=!0,this.update=!0,this.isOldCollision=!1,this._scaleXChanged=!1,this._scaleYChanged=!1,this._container=new egret.Sprite,this._container.owner=this,this._container.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStageHanlder,this),this._container.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStageHanlder,this),this._container.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchEvent,this),this._container.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onTouchEvent,this)}__extends(n,t);var i=__define,a=n,s=a.prototype;return s.onTouchEvent=function(t){switch(this._isTouchDown=t.touchDown,this._touchPointID=t.touchPointID,this._touchX=t.localX,this._touchY=t.localY,this._touchStageX=t.stageX,this._touchStageY=t.stageY,t.type){case egret.TouchEvent.TOUCH_TAP:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonTap));break;case egret.TouchEvent.TOUCH_BEGIN:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonBegin));break;case egret.TouchEvent.TOUCH_END:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonEnd));break;case egret.TouchEvent.TOUCH_MOVE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonMove));break;case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onButtonReleaseOutside))}},s.onCreate=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCreated))},i(s,"layerIndex",function(){return e.LayerManager.getIndexByLayer(this.container.parent)}),i(s,"enabled",function(){return this.container.touchEnabled},function(e){this.container.touchChildren=this.container.touchEnabled=e}),i(s,"collision",function(){return this._collision},function(e){this._collision=e}),i(s,"isCollsioning",function(){return this._isCollisioning},function(e){this._isCollisioning=e}),i(s,"isOnScreen",function(){var t=this.container.parent;if(t){var n=new egret.Point(t.x+this.x,t.y+this.y);return e.CollisionUtils.isCollsionWithRect(n.x-this.anchorOffsetX,n.y-this.anchorOffsetY,this.width,this.height,0,0,e.GameUILayer.stage.stageWidth,e.GameUILayer.stage.stageHeight)}return!1}),s.getBounds=function(){if(this._isupdatebounds||!this._cachebounds){var e=this.container.parent;e?this._cachebounds=new egret.Rectangle(e.x+this.x-this.anchorOffsetX,e.y+this.y-this.anchorOffsetY,this.width,this.height):this._cachebounds=new egret.Rectangle(this.x-this.anchorOffsetX,this.y-this.anchorOffsetY,this.width,this.height)}return this._cachebounds},s.getGlobalBounds=function(){return this.renderUpdate(),(this._isupdatebounds||!this._cacheglobalbounds)&&(this._cacheglobalbounds=this.container.getTransformedBounds(e.GameUILayer.stage)),this._cacheglobalbounds},s.getCacheCollisionPolygonData=function(){if(this._isupdatebounds||!this._cacheCollisionPolygonDatas){for(var t=[],n=0;n<this.collisionVectorData.length;n++){for(var i=[],a=0;a<this.collisionVectorData[n].length;a++){var s=this.collisionVectorData[n][a],r=new egret.Matrix;r.translate(s.x-this.anchorOffsetX,s.y-this.anchorOffsetY),r.scale(this.scaleX,this.scaleY),r.rotate(this.angle*Math.PI/180),i[a]=new e.Vector2D(r.tx,r.ty)}t[n]=i}this._cacheCollisionPolygonDatas=t}return this._cacheCollisionPolygonDatas},s.renderUpdate=function(){this._isupdatebounds=!1,this.container.x!=this.x&&(this.container.x=this.x,this._isupdatebounds=!0),this.container.y!=this.y&&(this.container.y=this.y,this._isupdatebounds=!0),this.container.width!=this.width&&(this.container.width=this.width,this._isupdatebounds=!0),this.container.height!=this.height&&(this.container.height=this.height,this._isupdatebounds=!0),this.scaleContainer&&(this.container.scaleX!=this.scaleX&&(this.container.scaleX=this.scaleX,this._isupdatebounds=!0),this.container.scaleY!=this.scaleY&&(this.container.scaleY=this.scaleY,this._isupdatebounds=!0)),this.container.rotation!=this.angle&&(this.container.rotation=this.angle,this._isupdatebounds=!0),this.container.anchorOffsetX!=this.width*this.anchorX&&(this.container.anchorOffsetX=this.width*this.anchorX,this._isupdatebounds=!0),this.container.anchorOffsetY!=this.height*this.anchorY&&(this.container.anchorOffsetY=this.height*this.anchorY,this._isupdatebounds=!0),this.container.alpha!=this.alpha&&(this.container.alpha=this.alpha),this.container.visible!=this.visible&&(this.container.visible=this.visible)},i(s,"box",function(){return this.getBounds()}),i(s,"quad",function(){null==this._quad&&(this._quad=new e.Quad);var t=this.getBounds();return this._quad.tlx=t.x,this._quad.tly=t.y,this._quad.trx=t.x+t.width,this._quad.try_=t.y,this._quad.blx=t.x,this._quad.bly=t.y+t.height,this._quad.brx=t.x+t.width,this._quad.bry=t.y+t.height,this._quad}),s.setIsColliding=function(t,n){this.collisionTarget=n,t&&(this.isCollsioning=t),this.isOldCollision!=t&&(this.isOldCollision=t,n&&t&&(this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,n)),n.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onCollisionWithOtherObject,this))))},i(s,"mirrored",function(){return this._mirrored},function(e){if(this._mirrored!=e)switch(this._mirrored=e,this._mirrored){case 0:this.scaleX=-1;break;case 1:this.scaleY=-1;break;case 2:this.scaleX=-1,this.scaleY=-1;break;case 3:this.scaleX=1,this.scaleY=1}}),s.getBehavior=function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t];if(n.constructor==e)return n}return null},s.addBehavior=function(e){return null!=e?("ScrollToBehavior"==e.constructor.name&&(this.isHasCamera=!0),e.inst=this,e.enabled=e.enabled,this.isInScreenOnce=!1,this.behaviors.push(e),!0):!1},s.removeBehavior=function(e){if(null!=e){var t=this.behaviors.indexOf(e);if(-1!=t)return e=null,this.behaviors.splice(t,1)}return null},s.removeAllBehaviors=function(){this.behaviors.length=0},i(s,"container",function(){return this._container}),i(s,"x",function(){return this._x},function(e){this._x!=e&&(this._x=e,this.update=!0)}),i(s,"y",function(){return this._y},function(e){this._y!=e&&(this._y=e,this.update=!0)}),i(s,"width",function(){return this._width},function(e){this._width!=e&&(this._width=e,this.update=!0)}),i(s,"height",function(){return this._height},function(e){this._height!=e&&(this._height=e,this.update=!0)}),i(s,"angle",function(){return this._angle},function(e){this._angle!=e&&(this._angle=e,this.update=!0)}),i(s,"alpha",function(){return this._alpha},function(e){this._alpha!=e&&(this._alpha=e,this.update=!0)}),i(s,"visible",function(){return this._visible},function(e){this._visible!=e&&(this._visible=e,this.update=!0)}),i(s,"scale",function(){return this._scale},function(e){this._scale=e,this._scaleX=this._scaleY=e,this.update=!0}),i(s,"scaleX",function(){return this._scaleX},function(e){this._scaleX!=e&&(this._scaleX=e,this.update=!0)}),i(s,"scaleY",function(){return this._scaleY},function(e){this._scaleY!=e&&(this._scaleY=e,this.update=!0)}),i(s,"anchorX",function(){return this._anchorX},function(e){this._anchorX!=e&&(this._anchorX=e,this._anchorOffsetX=this.width*e,this.update=!0)}),i(s,"anchorOffsetX",function(){return this._anchorOffsetX}),i(s,"anchorOffsetY",function(){return this._anchorOffsetY}),i(s,"anchorY",function(){return this._anchorY},function(e){this._anchorY!=e&&(this._anchorY=e,this._anchorOffsetY=this.height*e,this.update=!0)}),s.isTouchDown=function(e){return{instances:[this],status:this._isTouchDown}},s.onButtonTap=function(e){return{instances:[this],status:!0}},s.onButtonBegin=function(e){return{instances:[this],status:!0}},s.onButtonEnd=function(e){return{instances:[this],status:!0}},s.onButtonMove=function(e){return{instances:[this],status:!0}},s.onButtonReleaseOutside=function(e){return{instances:[this],status:!0}},s.isEnabled=function(e){return{instances:[this],status:this.enabled}},s.isBetweenAngles=function(t){var n=e.eval_e(t.angle),i=e.eval_e(t.angle1),a=e.eval_e(t.angle2),s=this._isClosewideform(i,a);return s?{instances:[this],status:this._isClosewideform(n,i)&&this._isClosewideform(n,a)}:{instances:[this],status:this._isClosewideform(n,i)&&!this._isClosewideform(n,a)}},s.isclockwiseform=function(t){var n=e.eval_e(t.angle1),i=e.eval_e(t.angle2);return{instances:[this],status:this._isClosewideform(n,i)}},s._isClosewideform=function(t,n){var i=e.MathUtils.toRadian(t),a=e.MathUtils.toRadian(n),s=Math.sin(i),r=Math.cos(i),o=Math.sin(a),l=Math.cos(a);return 0>=r*o-s*l},s.isObjectMoving=function(e){var t=this.x,n=this.y;return this._oldX!=t||this._oldY!=n?(this._oldX=t,this._oldY=n,{instances:[this],status:!0}):{instances:[this],status:!1}},s.onCreated=function(e){return{instances:[this],status:!0}},s.compareInstanceVariable=function(t){return{instances:[this],status:e.compare(this[t.instanceVariable],t.operationType,t.value)}},s.compareX=function(t){return{instances:[this],status:e.compare(this.x,t.operationType,t.x)}},s.compareY=function(t){return{instances:[this],status:e.compare(this.y,t.operationType,t.y)}},s.compareWidth=function(t){return{instances:[this],status:e.compare(this.width,t.operationType,t.width)}},s.compareHeight=function(t){return{instances:[this],status:e.compare(this.height,t.operationType,t.height)}},s.compareAlpha=function(t){return{instances:[this],status:e.compare(this.alpha,t.operationType,t.alpha)}},s.compareMirored=function(t){return{instances:[this],status:e.eval_e(t.mirrored)==this._mirrored}},s.compareObjectMoveAngle=function(t){var n=this.x,i=this.y,a=!1;if(isNaN(this._oldMoveX)||isNaN(this._oldMoveY))this._oldMoveX=n,this._oldMoveY=i;else if(this._oldMoveX!=n||this._oldMoveY!=i){var s=Math.atan2(i-this._oldMoveY,n-this._oldMoveX),r=e.MathUtils.toAngle(s);a=e.compare(r,t.operationType,t.angle),this._oldMoveX=n,this._oldMoveY=i}return{instances:[this],status:a}},s.compareObjectAngle=function(t){return{instances:[this],status:e.compare(this.angle,t.operationType,t.angle)}},s.compareTargetDistance=function(t){var n=e.eval_e(t.x),i=e.eval_e(t.y),a=n-this.x,s=i-this.y,r=Math.sqrt(a*a+s*s);return{instances:[this],status:e.compare(r,t.operationType,t.distance)}},s.onAddToStage=function(e){return{instances:[this],status:null!=this.container.stage||this._isAddToStage}},s.onRemoveToToStage=function(){return{instances:[this],status:!this.container.stage||!this._isAddToStage}},s.isOnScreenOrFalse=function(t){return{instances:[this],status:1===e.eval_e(t.isOnScreen)?this.isOnScreen:!this.isOnScreen}},s.isVisible=function(t){return{instances:[this],status:0!==e.eval_e(t.isVisible)}},s.onCollisionWithOtherObject=function(e){return{instances:[this,e.object],status:!0}},s.onEnabledDisabledCollision=function(e){return{instances:[this],status:1==e.status}},s.isOverlappingOtherObject=function(e){return{instances:[this.collisionTarget,e.object],status:this.collisionTarget.name==e.object.name}},s.onTweenComplete=function(e){return{instances:[this],status:!0}},s.pickByUniqueID=function(t){for(var n,i=e.World.getInstance().objectHash[this.name],a=0;a<i.length;a++){var s=i[a];if(s.id==e.eval_e(t.uniqueID)){n=s;break}}return{instances:[s],status:Boolean(n)}},s.onDestory=function(e){return{instances:[this],status:!0}},s.addTo=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject addTo parameter type incorrect!!"),this[t]+=i,this.variables[t]=this[t]},s.setBoolean=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==i,this.variables[t]=this[t]},s.setValue=function(t,n){var i=e.eval_e(n);this[t]=i,this.variables[t]=this[t]},s.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i,this.variables[t]=this[t]},s.toogleBoolean=function(e){this[e]=!this[e],this.variables[e]=this[e]},s.spawn=function(t,n,i,a,s){var r=e.eval_e(n),o=e.eval_e(i),l=e.eval_e(a),s=e.eval_e(s);e.assert("number"!=typeof r||"number"!=typeof o||"number"!=typeof l,"AIDisplayObject spawn parameter type incorrect!!");var c=t.clone();c.layer=r,1==s?(c.angle=this.angle,c.relyOnTarget=this):c.relyOnTarget=null;var h=e.MathUtils.angleTo(this.x,this.y,this.x+o,this.y+l),u=Math.sqrt(o*o+l*l),v=e.MathUtils.toRadian(c.angle)+e.MathUtils.toRadian(h);return c.x=this.x+Math.cos(v)*u,c.y=this.y+Math.sin(v)*u,e.lakeshoreInst()[c.name]=c,e.World.getInstance().addChild(c),[c]},s.moveAtAngle=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i,"AIDisplayObject moveAtAngle parameter type incorrect!!"),e.assert("number"!=typeof a,"AIDisplayObject moveAtAngle parameter type incorrect!!");var s=e.MathUtils.toRadian(i);this.x+=Math.cos(s)*a*e.timeScale(),this.y+=Math.sin(s)*a*e.timeScale()},s.moveForward=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject moveForward parameter type incorrect!!");var i=e.MathUtils.toRadian(this.angle);this.x+=Math.cos(i)*n*e.timeScale(),this.y+=Math.sin(i)*n*e.timeScale()},s.moveToTargetPoint=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof i,"AIDisplayObject moveToTargetPoint parameter type incorrect!!");var a=t-this.x,s=n-this.y,r=Math.sqrt(a*a+s*s);if(i>r)this.x=t,this.y=n;else{var o=Math.atan2(s,a);this.x+=Math.cos(o)*i*e.timeScale(),this.y+=Math.sin(o)*i*e.timeScale()}},s.rotateClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateClockWise parameter type incorrect!!"),this.angle+=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},s.rotateCounterClockWise=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject rotateCounterClockWise parameter type incorrect!!"),this.angle-=n*e.timeScale(),this.angle=e.MathUtils.clampAngle(this.angle)},s.rotateTowardAngle=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject rotateTowardAngle parameter type incorrect!!");var s=e.MathUtils.toAngle(e.MathUtils.angleRadius(e.MathUtils.toRadian(this.angle),e.MathUtils.toRadian(i),e.MathUtils.toRadian(a*e.timeScale())));isNaN(s)||this.angle!=s&&(this.angle=s)},s.rotateTowardPosition=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),a=e.eval_e(i);e.assert("number"!=typeof t||"number"!=typeof n||"number"!=typeof a,"AIDisplayObject rotateTowardPosition parameter type incorrect!!");var s=e.MathUtils.angleTo(this.x,this.y,t,n),r=e.MathUtils.angleRotate(this.angle,s,a*e.timeScale());isNaN(r)||this.angle!=r&&(this.angle=r)},s.setAngle=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAngle parameter type incorrect!!"),this.angle=n},s.setAngleTowardPosition=function(t,n){var t=e.eval_e(t),n=e.eval_e(n);e.assert("number"!=typeof t||"number"!=typeof n,"AIDisplayObject setAngleTowardPosition parameter type incorrect!!");var i=e.MathUtils.angleTo(this.x,this.y,t,n);this.angle=i},s.setHeight=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setHeight parameter type incorrect!!"),this.height=n},s.setMirrored=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setMirrored parameter type incorrect!!"),this.mirrored=n},s.setPosition=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject setPosition parameter type incorrect!!"),this.x=i,this.y=a},s.setPositionToAnotherObject=function(t,n,i){var a=e.eval_e(n),s=e.eval_e(i),r=t instanceof e.AIObject?t:e.eval_e(t);e.assert("number"!=typeof a||"number"!=typeof a,"AIDisplayObject setPositionToAnotherObject parameter type incorrect!!"),this.x=r.x+a,this.y=r.y+s},s.setScale=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScale parameter type incorrect!!"),this.scale=n},s.setScaleX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleX parameter type incorrect!!"),this.scaleX=n},s.setScaleY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setScaleY parameter type incorrect!!"),this.scaleY=n},s.setSize=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.assert("number"!=typeof i||"number"!=typeof a,"AIDisplayObject setSize parameter type incorrect!!"),this.width=i,this.height=a},s.setVisible=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setVisible parameter type incorrect!!"),this.visible=1==n},s.setAlpha=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setAlpha parameter type incorrect!!"),1e-4>n&&(n=0),n>1&&(n=1),this.alpha=n},s.setWidth=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setWidth parameter type incorrect!!"),this.width=n},s.setX=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setX parameter type incorrect!!"),this.x=n},s.setY=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setY parameter type incorrect!!"),this.y=n},s.setEnabled=function(t){var n=e.eval_e(t);e.assert("number"!=typeof n,"AIDisplayObject setEnabled parameter type incorrect!!"),this.enabled=n>=1},s.setMask=function(e){e&&e instanceof n&&(this.container.mask=e.container)},s.setMaskByLayer=function(t){t=e.eval_e(t);var n=e.LayerManager.getLayer(t);n&&(this.container.mask=n)},s.setMaskIsNull=function(){this.container.mask=null},s.addColorMatrixFilter=function(e){if(e){var t=e.split(",");if(t&&20==t.length){for(var n=[],i=0;i<t.length;i++)n[i]=+t[i];var a=new egret.ColorMatrixFilter(n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(a)}}},s.addBlurFilter=function(t,n){t=e.eval_e(t),n=e.eval_e(n);var i=new egret.BlurFilter(t,n);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(i)},s.addDropShadowFilter=function(t,n,i,a,s,r,o,l,c,h,u){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),s=e.eval_e(s),r=e.eval_e(r),o=e.eval_e(o),l=e.eval_e(l),c=e.eval_e(c),h=e.eval_e(h),u=e.eval_e(u);var v=new egret.DropShadowFilter(t,n,i,a,s,r,o,l,c,h,u);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(v)},s.addGlowFilter=function(t,n,i,a,s,r,o,l){t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.eval_e(a),s=e.eval_e(s),r=e.eval_e(r),o=e.eval_e(o),l=e.eval_e(l);var c=new egret.GlowFilter(t,n,i,a,s,r,o,l);null==this.container.filters&&(this.container.filters=[]),this.container.filters.push(c)},s.removeFilterByType=function(t){if(t=e.eval_e(t),this.container.filters)for(var n=0,i=0;i<this.container.filters.length;i++){var a=this.container.filters[i];switch(t){case 0:a instanceof egret.ColorMatrixFilter&&(this.container.filters.splice(i-n,1),n++);break;case 1:a instanceof egret.BlurFilter&&(this.container.filters.splice(i-n,1),n++);break;case 2:a instanceof egret.DropShadowFilter&&(this.container.filters.splice(i-n,1),n++);break;case 3:a instanceof egret.GlowFilter&&(this.container.filters.splice(i-n,1),n++)}}},s.removeAllFilters=function(){this.container.filters=null},s.execTween=function(t,n,i,a,s,r,o,l,c,h,u,v,f,g,d){var p=t?e.eval_e(t):"lsTweenStartKey",y=e.eval_e(h),_=e.eval_e(u),m=e.eval_e(v),x=egret.Ease[_],b={};n&&(b.x=e.eval_e(n)),i&&(b.y=e.eval_e(i)),a&&(b.anchorX=e.eval_e(a)),s&&(b.anchorY=e.eval_e(s)),r&&(b.width=e.eval_e(r)),o&&(b.height=e.eval_e(o)),l&&(b.angle=e.eval_e(l)),c&&(b.alpha=e.eval_e(c)),g&&(b.scaleX=e.eval_e(g)),d&&(b.scaleY=e.eval_e(d)),egret.setTimeout(function(){egret.Tween.get(this,{loop:1==f,onChange:null,onChangeObj:this}).to(b,y,x).wait(0).call(function(t){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onTweenComplete,t))},this,[p])},this,m)},s.enabledDisabledCollision=function(t){var n=e.eval_e(t);this.collision=1==n},s.onAddToStageHanlder=function(e){this._isAddToStage=!0},s.onRemoveToStageHanlder=function(e){this._isAddToStage=!1},s.destoryTest=function(){this.destory()},s.destoryOnChangeScene=function(){this.removeAllBehaviors(),this.destory()},s.destory=function(){if(!this.isModel){var t=this.name,n=e.World.getInstance().objectHash[t];if(n){var i=n.indexOf(this);-1!=i&&n.splice(i,1)}}if(this.behaviors)for(var a=0;a<this.behaviors.length;a++){var s=this.behaviors[a];s.destory()}this.container&&this.container.graphics.clear(),this.container.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStageHanlder,this),this.container.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveToStageHanlder,this),e.World.getInstance().removeChild(this),this.container=null,this.global||(this.isDead=!0),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDestory))},s.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.collision=this.collision,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.relyOnTarget=this.relyOnTarget,e.variables=JSON.stringify(this.variables),e.behaviors=[];for(var n=0;n<this.behaviors.length;n++){var i=this.behaviors[n];e.behaviors[n]=i.saveToJSON(),e.behaviors[n].plugin=egret.getQualifiedClassName(i)}return e},s.loadFromJSON=function(n){if(n){this.x=n.x,this.y=n.y,this.width=n.width,this.height=n.height,this.scale=n.scale,this.scaleX=n.scaleX,this.scaleY=n.scaleY,this.angle=n.angle,this.alpha=n.alpha,this.visible=n.visible,this.mirrored=n.mirrored,this.collision=n.collision,this.anchorX=n.anchorX,this.anchorY=n.anchorY,this.layer=n.layer,this.parallaxX=n.parallaxX,this.parallaxY=n.parallaxY,this.collisionData=n.collisionData,this.collisionType=n.collisionType,this.collisionSourceData=n.collisionSourceData,this.collisionVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionData),this.collisionSourceVectorData=e.LayoutDecoder.decodeCollision(this,this.collisionSourceData),this.collisionIsRect=n.collisionIsRect,this.scaleContainer=n.scaleContainer,this.enabled=n.enabled,this.relyOnTarget=n.relyOnTarget,this.variables=JSON.parse(n.variables);for(var i in this.variables)this[i]=this.variables[i];this.removeAllBehaviors();for(var a=0;a<n.behaviors.length;a++){var s=n.behaviors[a],r=s.plugin.slice(3),o=e.getInstanceByPluginClassName(r);o.loadFromJSON(s),this.addBehavior(o),o.onCreate()}t.prototype.loadFromJSON.call(this,n)}},s.clone=function(){var e=t.prototype.clone.call(this);e.name=this.name,e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.scale=this.scale,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.angle=this.angle,e.alpha=this.alpha,e.visible=this.visible,e.mirrored=this.mirrored,e.anchorX=this.anchorX,e.anchorY=this.anchorY,e.layer=this.layer,e.parallaxX=this.parallaxX,e.parallaxY=this.parallaxY,e.global=this.global,e.collisionData=this.collisionData,e.collisionType=this.collisionType,e.collisionSourceData=this.collisionSourceData,e.collisionVectorData=this.collisionVectorData,e.collisionSourceVectorData=this.collisionSourceVectorData,e.collisionIsRect=this.collisionIsRect,e.scaleContainer=this.scaleContainer,e.enabled=this.enabled,e.collision=this.collision,e.relyOnTarget=this.relyOnTarget;for(var n=0;n<this.behaviors.length;n++){var i=this.behaviors[n],a=i.clone();e.addBehavior(a),a.onCreate()}return e},n}(e.AIObject);e.AIDisplayObject=t,egret.registerClass(t,"ls.AIDisplayObject");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsButtonDownEvent=n,egret.registerClass(n,"ls.IsButtonDownEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);
e.OnButtonTapEvent=i,egret.registerClass(i,"ls.OnButtonTapEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonBeginEvent=a,egret.registerClass(a,"ls.OnButtonBeginEvent");var s=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonEndEvent=s,egret.registerClass(s,"ls.OnButtonEndEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonMoveEvent=r,egret.registerClass(r,"ls.OnButtonMoveEvent");var o=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnButtonReleaseOutsideEvent=o,egret.registerClass(o,"ls.OnButtonReleaseOutsideEvent");var l=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsButtonEnabledEvent=l,egret.registerClass(l,"ls.IsButtonEnabledEvent");var c=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsBetweenAnglesEvent=c,egret.registerClass(c,"ls.IsBetweenAnglesEvent");var h=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsClockwiseFromEvent=h,egret.registerClass(h,"ls.IsClockwiseFromEvent");var u=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsObjectMovingEvent=u,egret.registerClass(u,"ls.IsObjectMovingEvent");var v=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnCreatedEvent=v,egret.registerClass(v,"ls.OnCreatedEvent");var f=function(e){function t(){e.apply(this,arguments),this.value=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareInstanceVariableEvent=f,egret.registerClass(f,"ls.CompareInstanceVariableEvent");var g=function(e){function t(){e.apply(this,arguments),this.x=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareXPosEvent=g,egret.registerClass(g,"ls.CompareXPosEvent");var d=function(e){function t(){e.apply(this,arguments),this.y=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareYPosEvent=d,egret.registerClass(d,"ls.CompareYPosEvent");var p=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareWidthEvent=p,egret.registerClass(p,"ls.CompareWidthEvent");var y=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareHeightEvent=y,egret.registerClass(y,"ls.CompareHeightEvent");var _=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareOpacityEvent=_,egret.registerClass(_,"ls.CompareOpacityEvent");var m=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareMirroredStatusEvent=m,egret.registerClass(m,"ls.CompareMirroredStatusEvent");var x=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareObjectMoveAngleEvent=x,egret.registerClass(x,"ls.CompareObjectMoveAngleEvent");var b=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareObjectAngleEvent=b,egret.registerClass(b,"ls.CompareObjectAngleEvent");var C=function(e){function t(){e.apply(this,arguments),this.x=0,this.y=0,this.distance=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareTargetDistanceEvent=C,egret.registerClass(C,"ls.CompareTargetDistanceEvent");var E=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnStartOfLayoutEvent=E,egret.registerClass(E,"ls.OnStartOfLayoutEvent");var I=function(e){function t(){e.apply(this,arguments),this.isOnScreen=1}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsOnScreenEvent=I,egret.registerClass(I,"ls.IsOnScreenEvent");var S=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsVisibleEvent=S,egret.registerClass(S,"ls.IsVisibleEvent");var T=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnCollisionWithOtherObjectEvent=T,egret.registerClass(T,"ls.OnCollisionWithOtherObjectEvent");var O=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnEnabledDisabledCollisionEvent=O,egret.registerClass(O,"ls.OnEnabledDisabledCollisionEvent");var D=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsOverlappingOtherObjectEvent=D,egret.registerClass(D,"ls.IsOverlappingOtherObjectEvent");var w=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickByUniqueIDEvent=w,egret.registerClass(w,"ls.PickByUniqueIDEvent");var A=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDestoryEvent=A,egret.registerClass(A,"ls.OnDestoryEvent");var M=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnTweenCompleteEvent=M,egret.registerClass(M,"ls.OnTweenCompleteEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){t.call(this),this._sourceWidth=0,this._sourceHeight=0,this._isResourceLoaded=!1,this.name="Sprite",this._bitmap=new egret.Bitmap}__extends(n,t);var i=__define,a=n,s=a.prototype;return i(s,"bitmapURL",function(){return this._bitmapURL}),s.initialize=function(){this.createBitmap(this.url)},s.createBitmap=function(t){if(t&&""!=t){this._bitmapURL=t;var n=this,i=e.getTexture(t);if(null!=i)var a=i[0];if(null!=a)this._bitmap.texture=a,this._sourceWidth=a.textureWidth,this._sourceHeight=a.textureHeight,this._bitmap.width=this.width,this._bitmap.height=this.height,i&&(this._bitmap.x=i[1],this._bitmap.y=i[2]),this.container.addChild(this._bitmap),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),this.dispatchEvent(new egret.Event(egret.Event.COMPLETE));else{var s=function(t){t&&(n._bitmap.texture=t,n._sourceWidth=t.textureWidth,n._sourceHeight=t.textureHeight,n._bitmap.width=n.width,n._bitmap.height=n.height,n.container.addChild(n._bitmap),n.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,n.onResourceLoaded)),n.dispatchEvent(new egret.Event(egret.Event.COMPLETE)))};RES.getResByUrl(t,s,this,RES.ResourceItem.TYPE_IMAGE)}}},s.addChild=function(t){e.World.getInstance().addChild(t,this)},s.removeChild=function(t){e.World.getInstance().removeChild(t)},s.loadImage=function(t){var n=e.eval_e(t);this.createBitmap(n)},i(s,"width",function(){return this._width},function(e){this._width!=e&&(this._width=e,this.update=!0),this._bitmap&&this._bitmap.width!=e&&(this._bitmap.width=e)}),i(s,"height",function(){return this._height},function(e){this._height!=e&&(this._height=e,this.update=!0),this._bitmap&&this._bitmap.height!=e&&(this._bitmap.height=e)}),s.onResourceLoaded=function(e){return{instances:[this],status:!0}},s.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i},s.saveToJSON=function(){var e=t.prototype.saveToJSON.call(this);return e.url=this.url,e},s.loadFromJSON=function(e){e&&(this.url=e.url,t.prototype.loadFromJSON.call(this,e))},s.clone=function(){var e=t.prototype.clone.call(this);return e.url=this.url,e.initialize(),e},n}(e.AIDisplayObject);e.AISprite=t,egret.registerClass(t,"ls.AISprite");var n=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnResourceLoadedEvent=n,egret.registerClass(n,"ls.OnResourceLoadedEvent")}(ls||(ls={}));var ls;!function(e){var t=function(t){function n(){if(t.call(this),this._heading=0,this._lastUpdate=0,this._lastTime=0,this.SHAKE_THRESHOLD=1e3,this.isShakeble=!0,this.dt1=.016,this.dt=.016,this.minimumFramerate=30,this.disableDataEvents={},this.lastRegex="",this.lastFlags="",null!=n._instance)throw new Error("AISystem 为单例！！！");this.name="System",n._instance=this,this.onDevice(),this.onGetGeolocation(),this.onDeviceMotion(),this.onDeviceVibrate()}__extends(n,t);var i=__define,a=n,s=a.prototype;return s.onDevice=function(){this._orientation=new egret.DeviceOrientation,this._orientation.addEventListener(egret.OrientationEvent.CHANGE,this.onOrientation,this)},s.onOrientation=function(t){this._alpha=t.alpha,this._beta=t.beta,this._gamma=t.gamma,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDeviceOrientationChanged))},s.onGetGeolocation=function(){this._gps=new egret.Geolocation,this._gps.addEventListener(egret.GeolocationEvent.CHANGE,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.PERMISSION_DENIED,this.onGeolocation,this),this._gps.addEventListener(egret.GeolocationEvent.UNAVAILABLE,this.onGeolocation,this)},s.onGeolocation=function(t){switch(t.type){case egret.GeolocationEvent.CHANGE:this._latitude=t.latitude,this._longitude=t.longitude,this._altitude=t.altitude,this._speed=t.speed,this._heading=t.heading,this._accuracy=t.accuracy,this._altitudeAccuracy=t.altitudeAccuracy,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onDevicePostionChanged));break;case egret.GeolocationEvent.PERMISSION_DENIED:this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationPermissionDenied));break;default:this._geolocationErrorMessage=t.errorMessage,this._geolocationErrorType=t.errorType,this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGeolocationFail))}},s.onDeviceMotion=function(){window.DeviceMotionEvent&&window.addEventListener("devicemotion",this.ondeviceMotionHandler,!1)},s.ondeviceMotionHandler=function(t){var i=n.instance;i._curTime=egret.getTimer();var a=i._curTime-i._lastUpdate;if(a>100){var s=t.accelerationIncludingGravity;i._lastUpdate=i._curTime,i._x=s.x,i._y=s.y,i._z=s.z;var r=Math.abs(i._x+i._y+i._z-i._lastX-i._lastY-i._lastZ)/a*1e4;r>i.SHAKE_THRESHOLD&&i._curTime-i._lastTime>1100&&i.isShakeble&&(i._lastTime=i._curTime,i.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,i.onDeviceShake))),i._lastX=i._x,i._lastY=i._y,i._lastZ=i._z}},s.onDeviceVibrate=function(){window.navigator.vibrate},i(n,"instance",function(){return null==this._instance&&(this._instance=new n),this._instance}),s.sendSceneInitComplete=function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneInitComplete))},s.runOs=function(t){var n=e.eval_e(t.os);return{instances:[this],status:n==egret.Capabilities.os}},s.isMobile=function(t){return{instances:[this],status:e.eval_e(t.mobile)==egret.Capabilities.isMobile}},s.onRunTimeType=function(t){return{instances:[this],status:e.eval_e(t.runtimeType)==egret.Capabilities.runtimeType}},s.runLanguageType=function(t){return{instances:[this],status:e.eval_e(t.language)==egret.Capabilities.language}},s.onGeolocationPermissionDenied=function(e){return{instances:[this],status:!0}},s.onGeolocationFail=function(e){return{instances:[this],status:!0}},s.onDeviceShake=function(e){return{instances:[this],status:!0}},s.onDevicePostionChanged=function(e){return{instances:[this],status:!0}},s.onDeviceOrientationChanged=function(e){return{instances:[this],status:!0}},s.onGameDataLoadComplete=function(e){return{instances:[this],status:!0}},s.onGameDataSaveComplete=function(e){return{instances:[this],status:!0}},s.everyTick=function(e){return{instances:[this],status:!0}},s.everyXSecondEvent=function(t){return t.curTime=egret.getTimer(),t.curTime-t.oldTime>=1e3*e.eval_e(t.interval)?(t.oldTime=t.curTime,{instances:[this],status:!0}):{instances:[this],status:!1}},s.onSceneInitComplete=function(e){return{instances:[this],status:!0}},s.onSceneEndComplete=function(e){return{instances:[this],status:!0}},s.isValueType=function(e){return{instances:[this],status:!0}},s.ObjectUIDExist=function(t){return{instances:[this],status:null!=e.LayoutDecoder.curSceneInstances[e.eval_e(t.UID)]}},s.testRegex=function(t){var n=e.eval_e(t.str);n+="";var i=t.regex,a=t.flags;return this.cacheRegex&&i==this.lastRegex&&a==this.lastFlags||(this.cacheRegex=new RegExp(i,a),this.lastRegex=i,this.lastFlags=a),this.cacheRegex.lastIndex=0,{instances:[this],status:this.cacheRegex.test(n)}},s.pickRandomInstance=function(t){var n=e.World.getInstance().objectHash[t.object.name],i=n[Math.floor(Math.random()*n.length)];return{instances:[i],status:n&&n.length>0,selectSingle:!0}},s.pickAll=function(t){var n=e.World.getInstance().objectHash[t.object.name];return{instances:n,status:!0}},s.pickInstanceByCondition=function(t){var n=[],i=e.World.getInstance().objectHash[t.object.name];if(i)for(var a=0;a<i.length;a++){var s=i[a];window[s.name]=s;var r=e.compare(t.expression,t.operationType,t.value);r&&n.push(s)}return n.length>0?{instances:n,status:!0}:{instances:[this],status:!1}},s.pickInstanceByIndex=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){var i=e.eval_e(t.index);if(i<n.length-1&&i>=0)return{instances:[n[i]],status:!0}}return{instances:[this],status:!1}},s.pickInstanceOverlapping=function(t){var n=e.World.getInstance().objectHash[t.object.name];if(n){for(var i=[],a=e.eval_e(t.x),s=e.eval_e(t.y),r=0;r<n.length;r++){var o=n[r],l=o.getGlobalBounds();l.contains(a,s)&&i.push(o)}if(i.length>0)return{instances:i,status:!0}}return{instances:[this],status:!1}},s.execFor=function(e){return{instances:[this],status:!0,data:e}},s.execForEachSort=function(e){return{instances:[this],status:!0,data:e}},s.compareVariable=function(t){return{instances:[this],status:e.compare(n.instance[t.variable],t.operationType,t.value)}},s.onLayerIsExist=function(t){return{instances:[this],status:null!=e.LayerManager.getLayer(e.eval_e(t.layer))}},s.onLayerIsVisible=function(t){var n=e.LayerManager.getLayer(e.eval_e(t.layer));return n?{instances:[this],status:n.visible==e.eval_e(1==t.isVisible)}:{instances:[this],status:!1}},s.createObject=function(t,n,i,a){var s=e.eval_e(n),r=e.eval_e(i),o=e.eval_e(a);e.assert("number"!=typeof s||"number"!=typeof r||"number"!=typeof o,"AISystem createObject parameter type incorrect!!");var l=t.clone();return l.layer=s,l.x=Math.round(r),l.y=Math.round(o),e.lakeshoreInst()[l.name]=l,e.World.getInstance().addChild(l),[l]},s.gotoScene=function(t){egret.callLater(function(){this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onSceneEndComplete)),e.World.getInstance().destory(),t=t,e.StartUp.onConfigLoad(t)},this)},s.disableEvents=function(t,n){var i,a=e.eval_e(t),s=n+"";if(0!=s.length){i=1==s.length?[s]:s.split(",");for(var r=0;r<i.length;r++){var o=+i[r];1==a?delete this.disableDataEvents[o]:this.disableDataEvents[o]=o}}},s.showLoadingLogo=function(t){var t=e.eval_e(t);e.GameUILayer.stage.addChild(e.GameUILayer.preContainer),e.GameUILayer.preContainer.alpha=1;var n=egret.Tween.get(e.GameUILayer.preContainer);n.wait(1e3*t-250),n.to({alpha:0},250),setTimeout(function(){e.GameUILayer.stage.removeChild(e.GameUILayer.preContainer)},1e3*t)},s.onScenePauseOrPlay=function(t){var t=e.eval_e(t);e.EventSheetDecoder.execScenePauseOrPlay(t)},s.log=function(t){e.log(t)},s.addTo=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject addTo parameter type incorrect!!"),this[t]+=i,this.globalVariables[t]=this[t]},s.setBoolean=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject setBoolean parameter type incorrect!!"),this[t]=1==i,this.globalVariables[t]=this[t]},s.setValue=function(t,n){var i=e.eval_e(n);this[t]=i,this.globalVariables[t]=this[t]},s.subtractFrom=function(t,n){var i=e.eval_e(n);e.assert("number"!=typeof i,"AIObject subtractFrom parameter type incorrect!!"),this[t]-=i,this.globalVariables[t]=this[t]},s.toogleBoolean=function(e){this[e]=!this[e],this.globalVariables[e]=this[e]},s.stopLoop=function(){},s.load=function(e){},s.restartScene=function(){e.assert(null==e.LayoutDecoder.currentLayoutName,"current layout name is null!"),this.gotoScene(e.LayoutDecoder.currentLayoutName)},s.resetGlobalVariables=function(){},s.scrollToObject=function(t){var n=t.getFirstPicked();n&&e.World.getInstance().sceneCamera.lookAtChar(n)},s.scrollToPos=function(t,n){var i=e.eval_e(t),a=e.eval_e(n);e.World.getInstance().sceneCamera.lookAtPoint(new egret.Point(i,a))},s.scrollToXPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtX(n)},s.scrollToYPos=function(t){var n=e.eval_e(t);e.World.getInstance().sceneCamera.lookAtY(n)},s.setLayerAngle=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.rotation=n)},s.setLayerBgColor=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);if(i){var a=i.numChildren;if(a>0)for(var s=Number.MAX_VALUE,r=Number.MAX_VALUE,o=0;a>o;o++){var l=i.getChildAt(o);l.x-l.anchorOffsetX<s&&(s=l.x-l.anchorOffsetX),l.y-l.anchorOffsetY<r&&(r=l.y-l.anchorOffsetY)}i.graphics.clear(),i.graphics.beginFill(n),i.graphics.drawRect(s,r,i.width,i.height),i.graphics.endFill()}},s.setLayerAlpha=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.alpha=n)},s.setLayerParallax=function(t,n,i){for(var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.World.getInstance().objectList,s=0;s<a.length;s++){var r=a[s];r.index==t&&(r.parallaxX=n,r.parallaxY=i)}},s.setLayerScale=function(t,n,i){var t=e.eval_e(t),n=e.eval_e(n),i=e.eval_e(i),a=e.LayerManager.getLayer(t);a&&(a.scaleX=n/100,a.scaleY=i/100)},s.setLayerVisible=function(t,n){var t=e.eval_e(t),n=e.eval_e(n),i=e.LayerManager.getLayer(t);i&&(i.visible=1==n)},s.setObjectTimeScale=function(t,n){if(t){n=e.eval_e(n),0>n&&(n=0);for(var i=e.World.getInstance().objectHash[t.name],a=0;a<i.length;a++)i[a].timeScale=n}},s.setTimeScale=function(t){this._timeScale=e.eval_e(t),this._timeScale<0&&(this._timeScale=0)},s.startDeviceOrientation=function(t){var n=e.eval_e(t);this._orientation&&(0==n?this._orientation.stop():this._orientation.start())},s.startDeviceGeolocation=function(t){var n=e.eval_e(t);this._gps&&(0==n?this._gps.stop():this._gps.start())},s.onLoadComplete=function(){},s.loadStorageFromJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t),n=localStorage.getItem(t);if(void 0!=n&&null!=n){var i=JSON.parse(n),a=e.World.getInstance().objectList;for(var s in i){for(var r=i[s],o=null,l=0;l<a.length;l++){var c=a[l];if(c.u_id==parseFloat(s)){o=c;break}}if(o)o.loadFromJSON(r);else if(r.plugin){var h=r.plugin.slice(3),u=e.getInstanceByPluginClassName(h);u.loadFromJSON(r),u.initialize(),e.World.getInstance().addChild(u),e.registerObject(u.name,u);for(var l=0;l<e.EventSheetDecoder.curSceneEvents.length;l++)for(var v=e.EventSheetDecoder.curSceneEvents[l],f=0;f<v.conditionBlocks.length;f++)for(var g=v.conditionBlocks[f],d=0;d<g.conditions.length;d++){var p=g.conditions[d];p.callTarget instanceof e.AIObject&&p.callTarget.u_id==u.u_id&&(p.callTarget=u,g.cs&&g.cs.instanceStatus&&g.cs.instanceStatus[u.u_id]&&(g.cs.instanceStatus[u.u_id].instance=u))}}}for(var y=[],l=0;l<a.length;l++){var c=a[l];void 0==i[c.u_id]&&y.push(c)}for(var l=0;l<y.length;l++)e.World.getInstance().removeChild(y[l]),y[l].destory();y=[];var _=i.globalVariables;for(var m in _)this[m]=_[m];e.EventSheetDecoder.instancesConditions={},console.log("加载存档完毕！！"),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataLoadComplete,t))}},s.saveStorageToJSON=function(t){if("undefined"==typeof localStorage)return void e.assert(!0,"当前浏览器不支持本地存储");var t=e.eval_e(t),n={},i=e.World.getInstance().objectList;if(i)for(var a=0;a<i.length;a++){var s=i[a];n[s.u_id]=s.saveToJSON()}n.globalVariables=this.globalVariables;var r=JSON.stringify(n);localStorage.setItem(t,r),console.log("保存存档完毕！！"),console.log(r),this.dispatchEvent(new e.TriggerEvent(e.TriggerEvent.TRIGGER,this.onGameDataSaveComplete,t))},s.destory=function(){},i(s,"alpha",function(){return this._alpha}),i(s,"beta",function(){return this._beta}),i(s,"gamma",function(){return this._gamma}),i(s,"latitude",function(){return this._latitude}),i(s,"longitude",function(){return this._longitude}),i(s,"altitude",function(){return this._altitude}),i(s,"speed",function(){return this._speed}),i(s,"heading",function(){return this._heading}),i(s,"accuracy",function(){return this._accuracy}),i(s,"altitudeAccuracy",function(){return this._altitudeAccuracy}),i(s,"geolocationErrorMessage",function(){return this._geolocationErrorMessage}),i(s,"geolocationErrorType",function(){return this._geolocationErrorType}),n}(e.AIObject);e.AISystem=t,egret.registerClass(t,"ls.AISystem");var n=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RunOsEvent=n,egret.registerClass(n,"ls.RunOsEvent");var i=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsMobileEvent=i,egret.registerClass(i,"ls.IsMobileEvent");var a=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RuntimeTypeEvent=a,egret.registerClass(a,"ls.RuntimeTypeEvent");var s=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.RunLanguageEvent=s,egret.registerClass(s,"ls.RunLanguageEvent");var r=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGeolocationPermissionDeniedEvent=r,egret.registerClass(r,"ls.OnGeolocationPermissionDeniedEvent");var o=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGeolocationFailEvent=o,egret.registerClass(o,"ls.OnGeolocationFailEvent");var l=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDeviceShakeEvent=l,egret.registerClass(l,"ls.OnDeviceShakeEvent");var c=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnDevicePositionChangedEvent=c,egret.registerClass(c,"ls.OnDevicePositionChangedEvent");var h=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.onDeviceOrientationChangedEvent=h,egret.registerClass(h,"ls.onDeviceOrientationChangedEvent");var u=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.EveryTickEvent=u,egret.registerClass(u,"ls.EveryTickEvent");var v=function(e){function t(){e.call(this),this.interval=0,this.oldTime=0,this.curTime=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.EveryXSecondsEvent=v,egret.registerClass(v,"ls.EveryXSecondsEvent");var f=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.TestRegexEvent=f,egret.registerClass(f,"ls.TestRegexEvent");var g=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnSceneInitCompleteEvent=g,egret.registerClass(g,"ls.OnSceneInitCompleteEvent");var d=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnSceneEndCompleteEvent=d,egret.registerClass(d,"ls.OnSceneEndCompleteEvent");var p=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.IsValueTypeEvent=p,egret.registerClass(p,"ls.IsValueTypeEvent");var y=function(e){function t(){e.call(this),this.UID=0}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ObjectUIDExistEvent=y,egret.registerClass(y,"ls.ObjectUIDExistEvent");var _=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickRandomInstanceEvent=_,egret.registerClass(_,"ls.PickRandomInstanceEvent");var m=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickAllEvent=m,egret.registerClass(m,"ls.PickAllEvent");var x=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickByComparisionEvent=x,egret.registerClass(x,"ls.PickByComparisionEvent");var b=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanceByIndexEvent=b,egret.registerClass(b,"ls.PickInstanceByIndexEvent");var C=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.PickInstanecOverlappingEvent=C,egret.registerClass(C,"ls.PickInstanecOverlappingEvent");var E=function(e){function t(){e.call(this)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.CompareVariableEvent=E,egret.registerClass(E,"ls.CompareVariableEvent");var I=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ForEachOrderEvent=I,egret.registerClass(I,"ls.ForEachOrderEvent");var S=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.ForEvent=S,egret.registerClass(S,"ls.ForEvent");var T=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGameDataLoadCompleteEvent=T,egret.registerClass(T,"ls.OnGameDataLoadCompleteEvent");var O=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnGameDataSaveCompleteEvent=O,egret.registerClass(O,"ls.OnGameDataSaveCompleteEvent");var D=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnLayerIsExistEvent=D,egret.registerClass(D,"ls.OnLayerIsExistEvent");var w=function(e){function t(){e.apply(this,arguments)}__extends(t,e);var n=(__define,t);n.prototype;return t}(e.BaseEvent);e.OnLayerIsVisibleEvent=w,egret.registerClass(w,"ls.OnLayerIsVisibleEvent")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.register=function(t){t.addEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeTrigger=function(t){t.removeEventListener(e.TriggerEvent.TRIGGER,this.onTrigger,this)},t.removeAllTriggers=function(){for(var t=0,n=e.World.getInstance().objectList.length;n>t;t++)this.removeTrigger(e.World.getInstance().objectList[t])},t.onTrigger=function(t){for(var n=e.AISystem.instance.disableDataEvents,i=e.EventSheetDecoder.triggerConditions,a=t.target,s=a instanceof e.BaseBehavior,r=0;r<i.length;r++){var o=i[r];if(void 0==n[o.event.index+1]&&o.callCondition==t.triggerCondition)if(o.isFamily)if(s){var l=null,c=e.EventSheetDecoder.curFamilys[o.targetName].insts;if(c)for(var h=0;h<c.length;h++){var u=c[h];if(u.name==a.inst.name){l=u;break}}else e.assert(!0,"组触发条件目标查找失败,组名："+o.targetName);if(l){var v=e.EventSheetDecoder.curFamilys[o.targetName];if(t.triggerData){var f=o.paramsInstance,g=f.data,d=g.children,p=!1;if(d&&d.length>0)for(var y=0;y<d.length;y++){var _=d[y];if(t.triggerData==_.$value){p=!0;break}}if(p){var m={triggerTargets:[l],behaviorTarget:a,compareCondition:o,familyVo:v};e.EventSheetDecoder.execEvent(o.event,m)}}else{var m={triggerTargets:[l],behaviorTarget:a,compareCondition:o,familyVo:v};e.EventSheetDecoder.execEvent(o.event,m)}}}else{var l=null,c=e.EventSheetDecoder.curFamilys[o.targetName].insts;if(c)for(var h=0;h<c.length;h++){var u=c[h];if(u.name==a.name){l=u;break}}else e.assert(!0,"组触发条件目标查找失败,组名："+o.targetName);if(l)if(t.triggerData){var f=o.paramsInstance,g=f.data,d=g.children,p=!1;if(d&&d.length>0)for(var y=0;y<d.length;y++){var _=d[y];if("onCollisionWithOtherObject"==o.callConditionName){if(t.triggerData.name==_.$value){p=!0;var m={triggerTargets:[l,t.triggerData],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m);break}}else if(t.triggerData==_.$value){p=!0;var m={triggerTargets:[l],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m);break}}}else{var m={triggerTargets:[l],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m)}}else if(s){if(o.callTarget.name==a.name&&o.targetName==a.inst.name)if(t.triggerData){var f=o.paramsInstance,g=f.data,d=g.children,p=!1;if(d&&d.length>0)for(var y=0;y<d.length;y++){var _=d[y];if(t.triggerData==_.$value){p=!0;break}}if(p){var m={triggerTargets:[a.inst],compareCondition:o,behaviorTarget:a};e.EventSheetDecoder.execEvent(o.event,m)}}else{var m={triggerTargets:[a.inst],compareCondition:o,behaviorTarget:a};e.EventSheetDecoder.execEvent(o.event,m)}}else{var l=null;if(o.targetName==a.name&&(l=a),l)if(t.triggerData){var f=o.paramsInstance,g=f.data,d=g.children,p=!1;if(d&&d.length>0)for(var y=0;y<d.length;y++){var _=d[y];if("onCollisionWithOtherObject"==o.callConditionName){if(f.isFamily){var v=e.EventSheetDecoder.curFamilys[_.$value];if(v.insts)for(var x=0;x<v.insts.length;x++)if(t.triggerData.name==v.insts[x].name){p=!0;var m={triggerTargets:[l,t.triggerData],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m);break}}else if(t.triggerData.name==_.$value){p=!0;var m={triggerTargets:[l,t.triggerData],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m);break}}else if(t.triggerData==_.$value){p=!0;var m={triggerTargets:[l],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m);break}}}else{var m={triggerTargets:[l],compareCondition:o};e.EventSheetDecoder.execEvent(o.event,m)}}}},t}();e.Trigger=t,egret.registerClass(t,"ls.Trigger")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=__define,i=t;i.prototype;return n(t,"nativeBase64",function(){return"function"==typeof window.atob}),t.decode=function(e){if(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),this.nativeBase64)return window.atob(e);for(var t,n,i,a,s,r,o,l=[],c=0;c<e.length;)a=this._keyStr.indexOf(e.charAt(c++)),s=this._keyStr.indexOf(e.charAt(c++)),r=this._keyStr.indexOf(e.charAt(c++)),o=this._keyStr.indexOf(e.charAt(c++)),t=a<<2|s>>4,n=(15&s)<<4|r>>2,i=(3&r)<<6|o,l.push(String.fromCharCode(t)),64!==r&&l.push(String.fromCharCode(n)),64!==o&&l.push(String.fromCharCode(i));return l=l.join("")},t.encode=function(e){if(e=e.replace(/\r\n/g,"\n"),!this.nativeBase64){for(var t,n,i,a,s,r,o,l=[],c=0;c<e.length;)t=e.charCodeAt(c++),n=e.charCodeAt(c++),i=e.charCodeAt(c++),a=t>>2,s=(3&t)<<4|n>>4,r=(15&n)<<2|i>>6,o=63&i,isNaN(n)?r=o=64:isNaN(i)&&(o=64),l.push(this._keyStr.charAt(a)),l.push(this._keyStr.charAt(s)),l.push(this._keyStr.charAt(r)),l.push(this._keyStr.charAt(o));return l=l.join("")}window.btoa(e)},t.decodeBase64AsArray=function(e,n){n=n||1;var i,a,s,r=t.decode(e),o=new Uint32Array(r.length/n);for(i=0,s=r.length/n;s>i;i++)for(o[i]=0,a=n-1;a>=0;--a)o[i]+=r.charCodeAt(i*n+a)<<(a<<3);return o},t.decompress=function(t,n,i){e.assert(!0,"GZIP/ZLIB compressed TMX Tile Map not supported!")},t.decodeCSV=function(e){for(var t=e.replace("\n","").trim().split(","),n=[],i=0;i<t.length;i++)n.push(+t[i]);return n},t._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t}();e.Base64=t,egret.registerClass(t,"ls.Base64")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.isCollision=function(e,t,n,i,a,s){return e>=n&&n+a>=e&&t>=i&&i+s>=t},t.isCollsionWithRect=function(e,t,n,i,a,s,r,o){return e>=a&&e>=a+r?!1:a>=e&&a>=e+n?!1:t>=s&&t>=s+o?!1:s>=t&&s>=t+i?!1:!0},t.isCollisionPointWithCircle=function(e,t,n,i,a){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-i,2))<=a
},t.isCollisionCircleWithCircle=function(e,t,n,i,a,s){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-i,2))<=a+s},t.isCollisionRectWithCircle=function(e,t,n,i,a,s,r){var o=.5*n,l=.5*i,c=a-(e+o),h=s-(t+l),u=Math.min(c,o),v=Math.max(u,-o),f=Math.min(h,l),g=Math.max(f,-l);return r*r>=(v-c)*(v-c)+(g-h)*(g-h)},t.checkPointCollideShape=function(e,t,n){var i=n.length;if(3>i)return!1;var a=0,s=[];for(a=0;a<n.length;a++){var r=new egret.Point(n[a].x,n[a].y);s.push(r)}for(a=0;a<s.length;a++)s[a].x+=t.x,s[a].y+=t.y;if(this.vectorCrossPoint(s[0],e,s[1])>0)return!1;if(this.vectorCrossPoint(s[0],e,s[i-1])<0)return!1;a=2;for(var o=i-1,l=-1;o>=a;){var c=a+o>>1;this.vectorCrossPoint(s[0],e,s[c])>0?(l=c,o=c-1):a=c+1}return 0>l?!1:this.vectorCrossPoint(s[l-1],e,s[l])<0},t.vectorCrossPoint=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},t.hitTest=function(e,t){for(var n=0;n<e.length;n++)for(var i=0;i<t.length;i++){var a=e[n],s=t[i];if(this.simpleLineTest(a,s))return!0}return!1},t.simpleLineTest=function(e,t){var n=e.p1x,i=e.p1y,a=e.p2x,s=e.p2y,r=t.p1x,o=t.p1y,l=t.p2x,c=t.p2y,h=(a-n)*(o-i)-(r-n)*(s-i),u=(a-n)*(c-i)-(l-n)*(s-i),v=(l-r)*(i-o)-(n-r)*(c-o),f=(l-r)*(s-o)-(a-r)*(c-o);return 0>=h*u&&0>=v*f},t.intersects_rect=function(e,t){return!(t.right<e.left||t.bottom<e.top||t.left>e.right||t.top>e.bottom)},t.intersects_poly=function(e,t,n,i){return!1},t.testOverlap=function(t,n){return t&&n&&t!==n&&(t.solidEnabeld||t.collision)&&(n.solidEnabeld||n.collision)?e.Collision.checkCollision(t,n):!1},t.getLines=function(t){var n=e.MathUtils.toRadian(t.angle),i=new egret.Matrix;i.translate(-t.width/2,-t.height/2),i.rotate(n);var a=new egret.Matrix;a.translate(t.width/2,-t.height/2),a.rotate(n);var s=new egret.Matrix;s.translate(t.width/2,t.height/2),s.rotate(n);var r=new egret.Matrix;r.translate(-t.width/2,t.height/2),r.rotate(n);var o=[],l={p1x:i.tx+t.x,p1y:i.ty+t.y,p2x:a.tx+t.x,p2y:a.tx+t.y},c={p1x:a.tx+t.x,p1y:a.ty+t.y,p2x:s.tx+t.x,p2y:s.ty+t.y},h={p1x:s.tx+t.x,p1y:s.ty+t.y,p2x:r.tx+t.x,p2y:r.ty+t.y},u={p1x:r.tx+t.x,p1y:r.ty+t.y,p2x:i.tx+t.x,p2y:i.ty+t.y};return o.push(l,c,h,u),o},t.getSolidCollisionCandidates=function(e,t,n){},t.testOverlapSolid=function(t){for(var n=e.World.getInstance().objectList,i=0;i<n.length;i++){var a=n[i];if(a!=t&&a.solidEnabeld&&this.testOverlap(t,a))return a}return null},t.testOverlapJumpThru=function(t,n){void 0===n&&(n=!1);var i=e.World.getInstance().objectList,a=null;n&&(a=[]);for(var s=0,r=i.length;r>s;s++){var o=i[s];if(o.jumpthruEnabled&&this.testOverlap(t,o)){if(!n)return[o];a.push(o)}}return a},t.pushInFractional=function(e,t,n,i,a){for(var s,r=2,o=!1,l=!1,c=e.x,h=e.y;a>=r;)s=1/r,r*=2,e.x+=t*s*(o?1:-1),e.y+=n*s*(o?1:-1),this.testOverlap(e,i)?(o=!0,l=!0):(o=!1,l=!1,c=e.x,h=e.y);l&&(e.x=c,e.y=h)},t.pushOutSolid=function(e,t,n,i,a,s){void 0===i&&(i=0),void 0===a&&(a=!1),void 0===s&&(s=null);for(var r=i||50,o=e.x,l=e.y,c=null,h=null,u=0;r>u;u++){e.x=o+t*u,e.y=l+n*u;var v=this.testOverlap(e,c);if(!v)if(c=this.testOverlapSolid(e))h=c;else if(a&&(c=s?this.testOverlap(e,s)?s:null:this.testOverlapJumpThru(e),c&&(h=c)),!c)return h&&this.pushInFractional(e,t,n,h,16),!0}return e.x=o,e.y=l,!1},t.pushOutSolidNearest=function(t,n){var i=e.is_undefined(i)?100:i,a=0,s=t.x,r=t.y,o=0,l=0,c=0,h=this.testOverlapSolid(t);if(!h)return!0;for(;i>=a;){switch(o){case 0:l=0,c=-1,a++;break;case 1:l=1,c=-1;break;case 2:l=1,c=0;break;case 3:l=1,c=1;break;case 4:l=0,c=1;break;case 5:l=-1,c=1;break;case 6:l=-1,c=0;break;case 7:l=-1,c=-1}if(o=(o+1)%8,t.x=Math.floor(s+l*a),t.y=Math.floor(r+c*a),!this.testOverlap(t,h)&&(h=this.testOverlapSolid(t),!h))return!0}return t.x=s,t.y=r,!1},t.registerCollision=function(e,t){e.collision&&t.collision&&this.registered_collisions.push([e,t])},t.checkRegisteredCollision=function(e,t){for(var n=0;n<this.registered_collisions.length;n++){var i=this.registered_collisions[n];if(i[0]==e&&i[1]==t||i[0]==t&&i[1]==e)return!0}return!1},t.calculateSolidBounceAngle=function(t,n,i,a){void 0===a&&(a=null);var s=t.x,r=t.y,o=Math.max(10,e.distance(n,i,s,r)),l=e.MathUtils.radianTo(n,i,s,r),c=a||this.testOverlapSolid(t);if(!c)return e.MathUtils.clampRadian(l+Math.PI);var h,u,v,f,g=c,d=e.MathUtils.toRadian(5);for(h=1;36>h;h++)if(u=l-h*d,t.x=n+Math.cos(u)*o,t.y=i+Math.sin(u)*o,!this.testOverlap(t,g)&&(g=a?null:this.testOverlapSolid(t),!g)){v=u;break}36===h&&(v=e.MathUtils.clampRadian(l+Math.PI));var g=c;for(h=1;36>h;h++)if(u=l+h*d,t.x=n+Math.cos(u)*o,t.y=i+Math.sin(u)*o,!this.testOverlap(t,g)&&(g=a?null:this.testOverlapSolid(t),!g)){f=u;break}if(36===h&&(f=e.MathUtils.clampRadian(l+Math.PI)),t.x=s,t.y=r,f===v)return f;var p,y=e.MathUtils.angleDiff(f,v)/2;p=e.MathUtils.angleClockWise(f,v)?e.MathUtils.clampRadian(v+y+Math.PI):e.MathUtils.clampRadian(f+y);var _=Math.cos(l),m=Math.sin(l),x=Math.cos(p),b=Math.sin(p),C=_*x+m*b,E=_-2*C*x,I=m-2*C*b;return e.MathUtils.radianTo(0,0,E,I)},t.registered_collisions=[],t}();e.CollisionUtils=t,egret.registerClass(t,"ls.CollisionUtils")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.toRadian=function(e){return e*this.TO_RADIAN},e.toAngle=function(e){return e*this.TO_ANGLE},e.clampAngle=function(e){return e%=360,0>e&&(e+=360),e},e.clampRadian=function(e){return e%=2*Math.PI,0>e&&(e+=2*Math.PI),e},e.angleRotate=function(e,t,n){var i=this.toRadian(e),a=this.toRadian(t),s=Math.sin(i),r=Math.cos(i),o=Math.sin(a),l=Math.cos(a);return Math.acos(s*o+r*l)>this.toRadian(n)?r*o-s*l>0?this.clampAngle(e+n):this.clampAngle(e-n):this.clampAngle(t)},e.angleRadius=function(e,t,n){var i=Math.sin(e),a=Math.cos(e),s=Math.sin(t),r=Math.cos(t);return Math.acos(i*s+a*r)>n?a*s-i*r>0?this.clampRadian(e+n):this.clampRadian(e-n):this.clampRadian(t)},e.angleClockWise=function(e,t){var n=Math.sin(e),i=Math.cos(e),a=Math.sin(t),s=Math.cos(t);return 0>=i*a-n*s},e.angleTo=function(e,t,n,i){return this.toAngle(Math.atan2(i-t,n-e))},e.radianTo=function(e,t,n,i){return Math.atan2(i-t,n-e)},e.distance=function(e,t,n,i){var a=n-e,s=i-t;return Math.sqrt(a*a+s*s)},e.color16ToUnit=function(e){var t="0x"+e.slice(1);return parseInt(t,16)},e.angleDiff=function(e,t){if(e===t)return 0;var n=Math.sin(e),i=Math.cos(e),a=Math.sin(t),s=Math.cos(t),r=n*a+i*s;return r>=1?0:-1>=r?Math.PI:Math.acos(r)},e.TO_RADIAN=Math.PI/180,e.TO_ANGLE=180/Math.PI,e}();e.MathUtils=t,egret.registerClass(t,"ls.MathUtils")}(ls||(ls={}));var ls;!function(e){var t=function(){function e(){}var t=(__define,e);t.prototype;return e.compareVersion=function(e,t){var n=e.split("."),i=t.split("."),a=n[0]+"."+n[1];n[2]&&(a+=n[2]);var s=i[0]+"."+i[1];i[2]&&(s+=i[2]);var r=+a,o=+s;return r>o?1:r===o?0:-1},e.version="1.2",e}();e.Version=t,egret.registerClass(t,"ls.Version")}(ls||(ls={}));var ls;!function(e){var t=function(){function t(){}var n=(__define,t);n.prototype;return t.execute=function(e){this.stage=e.stage,this.onLayerInit(e),this.onPreResourceLoad(),this.stage.dirtyRegionPolicy="off"},t.onLayerInit=function(t){e.GameUILayer.init(t.stage),e.GameUILayer.document=t},t.onPreResourceLoad=function(){this.onProjectLoad("resource/assets/projects.xml")},t.onProjectLoad=function(n,i){void 0===i&&(i=null),RES.getResByUrl(n,function(n){var i=n.children;if(i)for(var a=0;a<i.length;a++){var s=i[a],r=s.localName;switch(r){case"sceneSize":e.Config.sceneWidth=+s.$width,e.Config.sceneHeight=+s.$height,e.Config.openLog=1==+s.$openLog;break;case"info":t.baseUrl=s.$baseUrl,e.Config.sceneInfo={layoutName:s.$layoutName,layoutUrl:s.$layoutUrl,eventsheetName:s.$eventsheetName,eventsheetUrl:s.$eventsheetUrl,baseUrl:t.baseUrl};var o=this;o.onGlobalConfigLoad(e.Config.sceneInfo.baseUrl+"global.xml",function(){RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},e.Config.sceneInfo)},[e.Config.sceneInfo.layoutName]);break;case"internal":var l=s.children[0].text,c=JSON.parse(decodeURIComponent(l));e.internalData=c.internalComponents;break;case"version":e.Config.version=+s.text}}},this,RES.ResourceItem.TYPE_XML)},t.onGlobalConfigLoad=function(t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),RES.getResByUrl(t,function(t){this.globalData=t,e.LayoutDecoder.globalInstances=e.LayoutDecoder.decodeInstances(this.globalData),null!=n&&n.apply(null,i)},this,RES.ResourceItem.TYPE_XML)},t.onConfigLoad=function(t){e.Config.sceneInfo.layoutName=t,e.Config.sceneInfo.layoutUrl=t+".xml",RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.layoutUrl,function(t){e.Config.sceneInfo.layoutData=t,e.Config.sceneInfo.eventsheetName=t.$eventSheet,e.Config.sceneInfo.eventsheetUrl=e.Config.sceneInfo.eventsheetName+".xml",RES.getResByUrl(e.Config.sceneInfo.baseUrl+e.Config.sceneInfo.eventsheetUrl,function(t){e.Config.sceneInfo.eventsheetData=t,e.LayoutDecoder.start(e.Config.sceneInfo.layoutName),e.EventSheetDecoder.start(e.Config.sceneInfo.eventsheetName)},this)},this)},t}();e.StartUp=t,egret.registerClass(t,"ls.StartUp")}(ls||(ls={}));